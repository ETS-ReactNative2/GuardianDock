{"version":3,"sources":["Text.js"],"names":["Text","React","forwardRef","props","forwardedRef","accessible","allowFontScaling","ellipsizeMode","onLongPress","onPress","onPressIn","onPressOut","onResponderGrant","onResponderMove","onResponderRelease","onResponderTerminate","onResponderTerminationRequest","onStartShouldSetResponder","pressRetentionOffset","suppressHighlighting","restProps","isHighlighted","setHighlighted","isPressable","disabled","initialized","useLazyInitialization","config","pressRectOffset","event","onResponderTerminationRequest_DEPRECATED","onStartShouldSetResponder_DEPRECATED","eventHandlers","eventHandlersForText","selectionColor","style","__DEV__","PressabilityDebug","isEnabled","StyleSheet","compose","color","numberOfLines","console","error","hasTextAncestor","TextAncestor","displayName","propTypes","DeprecatedTextPropTypes","newValue","oldValue","setValue","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow strict-local\n * @format\n */\n\nimport DeprecatedTextPropTypes from '../DeprecatedPropTypes/DeprecatedTextPropTypes';\nimport * as PressabilityDebug from '../Pressability/PressabilityDebug';\nimport usePressability from '../Pressability/usePressability';\nimport StyleSheet from '../StyleSheet/StyleSheet';\nimport processColor from '../StyleSheet/processColor';\nimport TextAncestor from './TextAncestor';\nimport {NativeText, NativeVirtualText} from './TextNativeComponent';\nimport {type TextProps} from './TextProps';\nimport * as React from 'react';\nimport {useContext, useMemo, useState} from 'react';\nimport invariant from 'invariant';\n\n/**\n * Text is the fundamental component for displaying text.\n *\n * @see https://reactnative.dev/docs/text.html\n */\nconst Text: React.AbstractComponent<\n  TextProps,\n  React.ElementRef<typeof NativeText | typeof NativeVirtualText>,\n> = React.forwardRef((props: TextProps, forwardedRef) => {\n  const {\n    accessible,\n    allowFontScaling,\n    ellipsizeMode,\n    onLongPress,\n    onPress,\n    onPressIn,\n    onPressOut,\n    onResponderGrant,\n    onResponderMove,\n    onResponderRelease,\n    onResponderTerminate,\n    onResponderTerminationRequest,\n    onStartShouldSetResponder,\n    pressRetentionOffset,\n    suppressHighlighting,\n    ...restProps\n  } = props;\n\n  const [isHighlighted, setHighlighted] = useState(false);\n\n  const isPressable =\n    (onPress != null ||\n      onLongPress != null ||\n      onStartShouldSetResponder != null) &&\n    restProps.disabled !== true;\n\n  const initialized = useLazyInitialization(isPressable);\n  const config = useMemo(\n    () =>\n      initialized\n        ? {\n            disabled: !isPressable,\n            pressRectOffset: pressRetentionOffset,\n            onLongPress,\n            onPress,\n            onPressIn(event) {\n              setHighlighted(!suppressHighlighting);\n              onPressIn?.(event);\n            },\n            onPressOut(event) {\n              setHighlighted(false);\n              onPressOut?.(event);\n            },\n            onResponderTerminationRequest_DEPRECATED: onResponderTerminationRequest,\n            onStartShouldSetResponder_DEPRECATED: onStartShouldSetResponder,\n          }\n        : null,\n    [\n      initialized,\n      isPressable,\n      pressRetentionOffset,\n      onLongPress,\n      onPress,\n      onPressIn,\n      onPressOut,\n      onResponderTerminationRequest,\n      onStartShouldSetResponder,\n      suppressHighlighting,\n    ],\n  );\n\n  const eventHandlers = usePressability(config);\n  const eventHandlersForText = useMemo(\n    () =>\n      eventHandlers == null\n        ? null\n        : {\n            onResponderGrant(event) {\n              eventHandlers.onResponderGrant(event);\n              if (onResponderGrant != null) {\n                onResponderGrant(event);\n              }\n            },\n            onResponderMove(event) {\n              eventHandlers.onResponderMove(event);\n              if (onResponderMove != null) {\n                onResponderMove(event);\n              }\n            },\n            onResponderRelease(event) {\n              eventHandlers.onResponderRelease(event);\n              if (onResponderRelease != null) {\n                onResponderRelease(event);\n              }\n            },\n            onResponderTerminate(event) {\n              eventHandlers.onResponderTerminate(event);\n              if (onResponderTerminate != null) {\n                onResponderTerminate(event);\n              }\n            },\n            onResponderTerminationRequest:\n              eventHandlers.onResponderTerminationRequest,\n            onStartShouldSetResponder: eventHandlers.onStartShouldSetResponder,\n          },\n    [\n      eventHandlers,\n      onResponderGrant,\n      onResponderMove,\n      onResponderRelease,\n      onResponderTerminate,\n    ],\n  );\n\n  // TODO: Move this processing to the view configuration.\n  const selectionColor =\n    restProps.selectionColor == null\n      ? null\n      : processColor(restProps.selectionColor);\n\n  let style = restProps.style;\n  if (__DEV__) {\n    if (PressabilityDebug.isEnabled() && onPress != null) {\n      style = StyleSheet.compose(restProps.style, {\n        color: 'magenta',\n      });\n    }\n  }\n\n  let numberOfLines = restProps.numberOfLines;\n  if (numberOfLines != null && !(numberOfLines >= 0)) {\n    console.error(\n      `'numberOfLines' in <Text> must be a non-negative number, received: ${numberOfLines}. The value will be set to 0.`,\n    );\n    numberOfLines = 0;\n  }\n\n  const hasTextAncestor = useContext(TextAncestor);\n\n  return hasTextAncestor ? (\n    <NativeVirtualText\n      {...restProps}\n      {...eventHandlersForText}\n      isHighlighted={isHighlighted}\n      numberOfLines={numberOfLines}\n      selectionColor={selectionColor}\n      style={style}\n      ref={forwardedRef}\n    />\n  ) : (\n    <TextAncestor.Provider value={true}>\n      <NativeText\n        {...restProps}\n        {...eventHandlersForText}\n        accessible={accessible !== false}\n        allowFontScaling={allowFontScaling !== false}\n        ellipsizeMode={ellipsizeMode ?? 'tail'}\n        isHighlighted={isHighlighted}\n        numberOfLines={numberOfLines}\n        selectionColor={selectionColor}\n        style={style}\n        ref={forwardedRef}\n      />\n    </TextAncestor.Provider>\n  );\n});\n\nText.displayName = 'Text';\n\n// TODO: Delete this.\nText.propTypes = DeprecatedTextPropTypes;\n\n/**\n * Returns false until the first time `newValue` is true, after which this will\n * always return true. This is necessary to lazily initialize `Pressability` so\n * we do not eagerly create one for every pressable `Text` component.\n */\nfunction useLazyInitialization(newValue: boolean): boolean {\n  const [oldValue, setValue] = useState(newValue);\n  if (!oldValue && newValue) {\n    setValue(newValue);\n  }\n  return oldValue;\n}\n\n// $FlowFixMe[incompatible-cast] - No good way to type a React.AbstractComponent with statics.\nmodule.exports = (Text: typeof Text &\n  $ReadOnly<{\n    propTypes: typeof DeprecatedTextPropTypes,\n  }>);\n"]}