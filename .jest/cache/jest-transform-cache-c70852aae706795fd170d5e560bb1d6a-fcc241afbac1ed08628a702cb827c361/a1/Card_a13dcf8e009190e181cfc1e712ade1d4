69547309d3dda29a251ddcea73171b8b
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _objectWithoutProperties2 = _interopRequireDefault2(require("@babel/runtime/helpers/objectWithoutProperties"));

var _excluded = ["elevation", "onLongPress", "onPress", "mode", "children", "style", "theme", "testID", "accessible"];
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _color = _interopRequireDefault(require("color"));

var _colors = require("../../styles/colors");

var _CardContent = _interopRequireDefault(require("./CardContent"));

var _CardActions = _interopRequireDefault(require("./CardActions"));

var _CardCover2 = _interopRequireDefault(require("./CardCover"));

var _CardTitle2 = _interopRequireDefault(require("./CardTitle"));

var _Surface = _interopRequireDefault(require("../Surface"));

var _theming = require("../../core/theming");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

var Card = function Card(_ref) {
  var _ref$elevation = _ref.elevation,
      cardElevation = _ref$elevation === void 0 ? 1 : _ref$elevation,
      onLongPress = _ref.onLongPress,
      onPress = _ref.onPress,
      _ref$mode = _ref.mode,
      cardMode = _ref$mode === void 0 ? 'elevated' : _ref$mode,
      children = _ref.children,
      style = _ref.style,
      theme = _ref.theme,
      testID = _ref.testID,
      accessible = _ref.accessible,
      rest = (0, _objectWithoutProperties2.default)(_ref, _excluded);

  var _React$useRef = React.useRef(new _reactNative.Animated.Value(cardElevation)),
      elevation = _React$useRef.current;

  var animation = theme.animation,
      dark = theme.dark,
      mode = theme.mode,
      roundness = theme.roundness;

  var handlePressIn = function handlePressIn() {
    var dark = theme.dark,
        mode = theme.mode,
        scale = theme.animation.scale;

    _reactNative.Animated.timing(elevation, {
      toValue: 8,
      duration: 150 * scale,
      useNativeDriver: !dark || mode === 'exact'
    }).start();
  };

  var handlePressOut = function handlePressOut() {
    _reactNative.Animated.timing(elevation, {
      toValue: cardElevation,
      duration: 150 * animation.scale,
      useNativeDriver: !dark || mode === 'exact'
    }).start();
  };

  var total = React.Children.count(children);
  var siblings = React.Children.map(children, function (child) {
    return React.isValidElement(child) && child.type ? child.type.displayName : null;
  });
  var borderColor = (0, _color.default)(theme.dark ? _colors.white : _colors.black).alpha(0.12).rgb().string();
  return React.createElement(_Surface.default, _extends({
    style: [{
      borderRadius: roundness,
      elevation: elevation,
      borderColor: borderColor
    }, cardMode === 'outlined' ? styles.outlined : {}, style],
    theme: theme
  }, rest), React.createElement(_reactNative.TouchableWithoutFeedback, {
    delayPressIn: 0,
    disabled: !(onPress || onLongPress),
    onLongPress: onLongPress,
    onPress: onPress,
    onPressIn: onPress || onLongPress ? handlePressIn : undefined,
    onPressOut: onPress || onLongPress ? handlePressOut : undefined,
    testID: testID,
    accessible: accessible
  }, React.createElement(_reactNative.View, {
    style: styles.innerContainer
  }, React.Children.map(children, function (child, index) {
    return React.isValidElement(child) ? React.cloneElement(child, {
      index: index,
      total: total,
      siblings: siblings
    }) : child;
  }))));
};

Card.Content = _CardContent.default;
Card.Actions = _CardActions.default;
Card.Cover = _CardCover2.default;
Card.Title = _CardTitle2.default;

var styles = _reactNative.StyleSheet.create({
  innerContainer: {
    flexGrow: 1,
    flexShrink: 1
  },
  outlined: {
    elevation: 0,
    borderWidth: 1
  }
});

var _default = (0, _theming.withTheme)(Card);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SCxDQVZGLENBVEYsQ0FERjtBQWpERjs7QUFzRkFiLElBQUksQ0FBQ3lELE9BQUx6RCxHQUFlMEQsb0JBQWYxRDtBQUVBQSxJQUFJLENBQUMyRCxPQUFMM0QsR0FBZTRELG9CQUFmNUQ7QUFFQUEsSUFBSSxDQUFDNkQsS0FBTDdELEdBQWE4RCxtQkFBYjlEO0FBRUFBLElBQUksQ0FBQytELEtBQUwvRCxHQUFhZ0UsbUJBQWJoRTs7QUFFQSxJQUFNOEMsTUFBTSxHQUFHbUIsd0JBQVdDLE1BQVhELENBQWtCO0FBQy9CWCxnQkFBYyxFQUFFO0FBQ2RhLFlBQVEsRUFBRSxDQURJO0FBRWRDLGNBQVUsRUFBRTtBQUZFLEdBRGU7QUFLL0JyQixVQUFRLEVBQUU7QUFDUjlDLGFBQVMsRUFBRSxDQURIO0FBRVJvRSxlQUFXLEVBQUU7QUFGTDtBQUxxQixDQUFsQkosQ0FBZjs7ZUFXZSx3QkFBVWpFLElBQVYiLCJuYW1lcyI6WyJDYXJkIiwiZWxldmF0aW9uIiwiY2FyZEVsZXZhdGlvbiIsIm9uTG9uZ1ByZXNzIiwib25QcmVzcyIsIm1vZGUiLCJjYXJkTW9kZSIsImNoaWxkcmVuIiwic3R5bGUiLCJ0aGVtZSIsInRlc3RJRCIsImFjY2Vzc2libGUiLCJyZXN0IiwiUmVhY3QiLCJ1c2VSZWYiLCJBbmltYXRlZCIsIlZhbHVlIiwiY3VycmVudCIsImFuaW1hdGlvbiIsImRhcmsiLCJyb3VuZG5lc3MiLCJoYW5kbGVQcmVzc0luIiwic2NhbGUiLCJ0aW1pbmciLCJ0b1ZhbHVlIiwiZHVyYXRpb24iLCJ1c2VOYXRpdmVEcml2ZXIiLCJzdGFydCIsImhhbmRsZVByZXNzT3V0IiwidG90YWwiLCJDaGlsZHJlbiIsImNvdW50Iiwic2libGluZ3MiLCJtYXAiLCJjaGlsZCIsImlzVmFsaWRFbGVtZW50IiwidHlwZSIsImRpc3BsYXlOYW1lIiwiYm9yZGVyQ29sb3IiLCJ3aGl0ZSIsImJsYWNrIiwiYWxwaGEiLCJyZ2IiLCJzdHJpbmciLCJfU3VyZmFjZSIsImJvcmRlclJhZGl1cyIsInN0eWxlcyIsIm91dGxpbmVkIiwiX3JlYWN0TmF0aXZlIiwiZGVsYXlQcmVzc0luIiwiZGlzYWJsZWQiLCJvblByZXNzSW4iLCJ1bmRlZmluZWQiLCJvblByZXNzT3V0IiwiaW5uZXJDb250YWluZXIiLCJpbmRleCIsImNsb25lRWxlbWVudCIsIkNvbnRlbnQiLCJDYXJkQ29udGVudCIsIkFjdGlvbnMiLCJDYXJkQWN0aW9ucyIsIkNvdmVyIiwiQ2FyZENvdmVyIiwiVGl0bGUiLCJDYXJkVGl0bGUiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwiZmxleEdyb3ciLCJmbGV4U2hyaW5rIiwiYm9yZGVyV2lkdGgiXSwic291cmNlcyI6WyJDYXJkLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBTdHlsZVByb3AsXG4gIFN0eWxlU2hlZXQsXG4gIEFuaW1hdGVkLFxuICBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2ssXG4gIFZpZXcsXG4gIFZpZXdTdHlsZSxcbn0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBjb2xvciBmcm9tICdjb2xvcic7XG5pbXBvcnQgeyB3aGl0ZSwgYmxhY2sgfSBmcm9tICcuLi8uLi9zdHlsZXMvY29sb3JzJztcbmltcG9ydCBDYXJkQ29udGVudCBmcm9tICcuL0NhcmRDb250ZW50JztcbmltcG9ydCBDYXJkQWN0aW9ucyBmcm9tICcuL0NhcmRBY3Rpb25zJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbmltcG9ydCBDYXJkQ292ZXIsIHsgQ2FyZENvdmVyIGFzIF9DYXJkQ292ZXIgfSBmcm9tICcuL0NhcmRDb3Zlcic7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG5pbXBvcnQgQ2FyZFRpdGxlLCB7IENhcmRUaXRsZSBhcyBfQ2FyZFRpdGxlIH0gZnJvbSAnLi9DYXJkVGl0bGUnO1xuaW1wb3J0IFN1cmZhY2UgZnJvbSAnLi4vU3VyZmFjZSc7XG5pbXBvcnQgeyB3aXRoVGhlbWUgfSBmcm9tICcuLi8uLi9jb3JlL3RoZW1pbmcnO1xuXG50eXBlIE91dGxpbmVkQ2FyZFByb3BzID0ge1xuICBtb2RlOiAnb3V0bGluZWQnO1xuICBlbGV2YXRpb24/OiBuZXZlcjtcbn07XG5cbnR5cGUgRWxldmF0ZWRDYXJkUHJvcHMgPSB7XG4gIG1vZGU/OiAnZWxldmF0ZWQnO1xuICBlbGV2YXRpb24/OiBudW1iZXI7XG59O1xuXG50eXBlIFByb3BzID0gUmVhY3QuQ29tcG9uZW50UHJvcHM8dHlwZW9mIFN1cmZhY2U+ICYge1xuICAvKipcbiAgICogUmVzdGluZyBlbGV2YXRpb24gb2YgdGhlIGNhcmQgd2hpY2ggY29udHJvbHMgdGhlIGRyb3Agc2hhZG93LlxuICAgKi9cbiAgZWxldmF0aW9uPzogbmV2ZXIgfCBudW1iZXI7XG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0byBleGVjdXRlIG9uIGxvbmcgcHJlc3MuXG4gICAqL1xuICBvbkxvbmdQcmVzcz86ICgpID0+IHZvaWQ7XG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0byBleGVjdXRlIG9uIHByZXNzLlxuICAgKi9cbiAgb25QcmVzcz86ICgpID0+IHZvaWQ7XG4gIC8qKlxuICAgKiBNb2RlIG9mIHRoZSBDYXJkLlxuICAgKiAtIGBlbGV2YXRlZGAgLSBDYXJkIHdpdGggZWxldmF0aW9uLlxuICAgKiAtIGBvdXRsaW5lZGAgLSBDYXJkIHdpdGggYW4gb3V0bGluZS5cbiAgICovXG4gIG1vZGU/OiAnZWxldmF0ZWQnIHwgJ291dGxpbmVkJztcbiAgLyoqXG4gICAqIENvbnRlbnQgb2YgdGhlIGBDYXJkYC5cbiAgICovXG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG4gIHN0eWxlPzogU3R5bGVQcm9wPFZpZXdTdHlsZT47XG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICovXG4gIHRoZW1lOiBSZWFjdE5hdGl2ZVBhcGVyLlRoZW1lO1xuICAvKipcbiAgICogUGFzcyBkb3duIHRlc3RJRCBmcm9tIGNhcmQgcHJvcHMgdG8gdG91Y2hhYmxlXG4gICAqL1xuICB0ZXN0SUQ/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBQYXNzIGRvd24gYWNjZXNzaWJsZSBmcm9tIGNhcmQgcHJvcHMgdG8gdG91Y2hhYmxlXG4gICAqL1xuICBhY2Nlc3NpYmxlPzogYm9vbGVhbjtcbn07XG5cbi8qKlxuICogQSBjYXJkIGlzIGEgc2hlZXQgb2YgbWF0ZXJpYWwgdGhhdCBzZXJ2ZXMgYXMgYW4gZW50cnkgcG9pbnQgdG8gbW9yZSBkZXRhaWxlZCBpbmZvcm1hdGlvbi5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwic2NyZWVuc2hvdHNcIj5cbiAqICAgPGltZyBjbGFzcz1cIm1lZGl1bVwiIHNyYz1cInNjcmVlbnNob3RzL2NhcmQtMS5wbmdcIiAvPlxuICogICA8aW1nIGNsYXNzPVwibWVkaXVtXCIgc3JjPVwic2NyZWVuc2hvdHMvY2FyZC0yLnBuZ1wiIC8+XG4gKiA8L2Rpdj5cbiAqXG4gKiAjIyBVc2FnZVxuICogYGBganNcbiAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAqIGltcG9ydCB7IEF2YXRhciwgQnV0dG9uLCBDYXJkLCBUaXRsZSwgUGFyYWdyYXBoIH0gZnJvbSAncmVhY3QtbmF0aXZlLXBhcGVyJztcbiAqXG4gKiBjb25zdCBMZWZ0Q29udGVudCA9IHByb3BzID0+IDxBdmF0YXIuSWNvbiB7Li4ucHJvcHN9IGljb249XCJmb2xkZXJcIiAvPlxuICpcbiAqIGNvbnN0IE15Q29tcG9uZW50ID0gKCkgPT4gKFxuICogICA8Q2FyZD5cbiAqICAgICA8Q2FyZC5UaXRsZSB0aXRsZT1cIkNhcmQgVGl0bGVcIiBzdWJ0aXRsZT1cIkNhcmQgU3VidGl0bGVcIiBsZWZ0PXtMZWZ0Q29udGVudH0gLz5cbiAqICAgICA8Q2FyZC5Db250ZW50PlxuICogICAgICAgPFRpdGxlPkNhcmQgdGl0bGU8L1RpdGxlPlxuICogICAgICAgPFBhcmFncmFwaD5DYXJkIGNvbnRlbnQ8L1BhcmFncmFwaD5cbiAqICAgICA8L0NhcmQuQ29udGVudD5cbiAqICAgICA8Q2FyZC5Db3ZlciBzb3VyY2U9e3sgdXJpOiAnaHR0cHM6Ly9waWNzdW0ucGhvdG9zLzcwMCcgfX0gLz5cbiAqICAgICA8Q2FyZC5BY3Rpb25zPlxuICogICAgICAgPEJ1dHRvbj5DYW5jZWw8L0J1dHRvbj5cbiAqICAgICAgIDxCdXR0b24+T2s8L0J1dHRvbj5cbiAqICAgICA8L0NhcmQuQWN0aW9ucz5cbiAqICAgPC9DYXJkPlxuICogKTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBNeUNvbXBvbmVudDtcbiAqIGBgYFxuICovXG5jb25zdCBDYXJkID0gKHtcbiAgZWxldmF0aW9uOiBjYXJkRWxldmF0aW9uID0gMSxcbiAgb25Mb25nUHJlc3MsXG4gIG9uUHJlc3MsXG4gIG1vZGU6IGNhcmRNb2RlID0gJ2VsZXZhdGVkJyxcbiAgY2hpbGRyZW4sXG4gIHN0eWxlLFxuICB0aGVtZSxcbiAgdGVzdElELFxuICBhY2Nlc3NpYmxlLFxuICAuLi5yZXN0XG59OiAoT3V0bGluZWRDYXJkUHJvcHMgfCBFbGV2YXRlZENhcmRQcm9wcykgJiBQcm9wcykgPT4ge1xuICBjb25zdCB7IGN1cnJlbnQ6IGVsZXZhdGlvbiB9ID0gUmVhY3QudXNlUmVmPEFuaW1hdGVkLlZhbHVlPihcbiAgICBuZXcgQW5pbWF0ZWQuVmFsdWUoY2FyZEVsZXZhdGlvbilcbiAgKTtcbiAgY29uc3QgeyBhbmltYXRpb24sIGRhcmssIG1vZGUsIHJvdW5kbmVzcyB9ID0gdGhlbWU7XG5cbiAgY29uc3QgaGFuZGxlUHJlc3NJbiA9ICgpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBkYXJrLFxuICAgICAgbW9kZSxcbiAgICAgIGFuaW1hdGlvbjogeyBzY2FsZSB9LFxuICAgIH0gPSB0aGVtZTtcbiAgICBBbmltYXRlZC50aW1pbmcoZWxldmF0aW9uLCB7XG4gICAgICB0b1ZhbHVlOiA4LFxuICAgICAgZHVyYXRpb246IDE1MCAqIHNjYWxlLFxuICAgICAgdXNlTmF0aXZlRHJpdmVyOiAhZGFyayB8fCBtb2RlID09PSAnZXhhY3QnLFxuICAgIH0pLnN0YXJ0KCk7XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlUHJlc3NPdXQgPSAoKSA9PiB7XG4gICAgQW5pbWF0ZWQudGltaW5nKGVsZXZhdGlvbiwge1xuICAgICAgdG9WYWx1ZTogY2FyZEVsZXZhdGlvbixcbiAgICAgIGR1cmF0aW9uOiAxNTAgKiBhbmltYXRpb24uc2NhbGUsXG4gICAgICB1c2VOYXRpdmVEcml2ZXI6ICFkYXJrIHx8IG1vZGUgPT09ICdleGFjdCcsXG4gICAgfSkuc3RhcnQoKTtcbiAgfTtcblxuICBjb25zdCB0b3RhbCA9IFJlYWN0LkNoaWxkcmVuLmNvdW50KGNoaWxkcmVuKTtcbiAgY29uc3Qgc2libGluZ3MgPSBSZWFjdC5DaGlsZHJlbi5tYXAoY2hpbGRyZW4sIChjaGlsZCkgPT5cbiAgICBSZWFjdC5pc1ZhbGlkRWxlbWVudChjaGlsZCkgJiYgY2hpbGQudHlwZVxuICAgICAgPyAoY2hpbGQudHlwZSBhcyBhbnkpLmRpc3BsYXlOYW1lXG4gICAgICA6IG51bGxcbiAgKTtcbiAgY29uc3QgYm9yZGVyQ29sb3IgPSBjb2xvcih0aGVtZS5kYXJrID8gd2hpdGUgOiBibGFjaylcbiAgICAuYWxwaGEoMC4xMilcbiAgICAucmdiKClcbiAgICAuc3RyaW5nKCk7XG5cbiAgcmV0dXJuIChcbiAgICA8U3VyZmFjZVxuICAgICAgc3R5bGU9e1tcbiAgICAgICAgeyBib3JkZXJSYWRpdXM6IHJvdW5kbmVzcywgZWxldmF0aW9uLCBib3JkZXJDb2xvciB9LFxuICAgICAgICBjYXJkTW9kZSA9PT0gJ291dGxpbmVkJyA/IHN0eWxlcy5vdXRsaW5lZCA6IHt9LFxuICAgICAgICBzdHlsZSxcbiAgICAgIF19XG4gICAgICB0aGVtZT17dGhlbWV9XG4gICAgICB7Li4ucmVzdH1cbiAgICA+XG4gICAgICA8VG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrXG4gICAgICAgIGRlbGF5UHJlc3NJbj17MH1cbiAgICAgICAgZGlzYWJsZWQ9eyEob25QcmVzcyB8fCBvbkxvbmdQcmVzcyl9XG4gICAgICAgIG9uTG9uZ1ByZXNzPXtvbkxvbmdQcmVzc31cbiAgICAgICAgb25QcmVzcz17b25QcmVzc31cbiAgICAgICAgb25QcmVzc0luPXtvblByZXNzIHx8IG9uTG9uZ1ByZXNzID8gaGFuZGxlUHJlc3NJbiA6IHVuZGVmaW5lZH1cbiAgICAgICAgb25QcmVzc091dD17b25QcmVzcyB8fCBvbkxvbmdQcmVzcyA/IGhhbmRsZVByZXNzT3V0IDogdW5kZWZpbmVkfVxuICAgICAgICB0ZXN0SUQ9e3Rlc3RJRH1cbiAgICAgICAgYWNjZXNzaWJsZT17YWNjZXNzaWJsZX1cbiAgICAgID5cbiAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5pbm5lckNvbnRhaW5lcn0+XG4gICAgICAgICAge1JlYWN0LkNoaWxkcmVuLm1hcChjaGlsZHJlbiwgKGNoaWxkLCBpbmRleCkgPT5cbiAgICAgICAgICAgIFJlYWN0LmlzVmFsaWRFbGVtZW50KGNoaWxkKVxuICAgICAgICAgICAgICA/IFJlYWN0LmNsb25lRWxlbWVudChjaGlsZCwge1xuICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICB0b3RhbCxcbiAgICAgICAgICAgICAgICAgIHNpYmxpbmdzLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIDogY2hpbGRcbiAgICAgICAgICApfVxuICAgICAgICA8L1ZpZXc+XG4gICAgICA8L1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaz5cbiAgICA8L1N1cmZhY2U+XG4gICk7XG59O1xuXG4vLyBAY29tcG9uZW50IC4vQ2FyZENvbnRlbnQudHN4XG5DYXJkLkNvbnRlbnQgPSBDYXJkQ29udGVudDtcbi8vIEBjb21wb25lbnQgLi9DYXJkQWN0aW9ucy50c3hcbkNhcmQuQWN0aW9ucyA9IENhcmRBY3Rpb25zO1xuLy8gQGNvbXBvbmVudCAuL0NhcmRDb3Zlci50c3hcbkNhcmQuQ292ZXIgPSBDYXJkQ292ZXI7XG4vLyBAY29tcG9uZW50IC4vQ2FyZFRpdGxlLnRzeFxuQ2FyZC5UaXRsZSA9IENhcmRUaXRsZTtcblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBpbm5lckNvbnRhaW5lcjoge1xuICAgIGZsZXhHcm93OiAxLFxuICAgIGZsZXhTaHJpbms6IDEsXG4gIH0sXG4gIG91dGxpbmVkOiB7XG4gICAgZWxldmF0aW9uOiAwLFxuICAgIGJvcmRlcldpZHRoOiAxLFxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUaGVtZShDYXJkKTtcbiJdfQ==