f363e2cbfa43cc7934c6917144b35c25
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _EmitterSubscription = _interopRequireDefault(require("./_EmitterSubscription"));

var _EventSubscriptionVendor = _interopRequireDefault(require("./_EventSubscriptionVendor"));

var invariant = require('invariant');

var sparseFilterPredicate = function sparseFilterPredicate() {
  return true;
};

var EventEmitter = function () {
  function EventEmitter(subscriber) {
    (0, _classCallCheck2.default)(this, EventEmitter);
    this._subscriber = new _EventSubscriptionVendor.default();

    if (subscriber != null) {
      console.warn('EventEmitter(...): Constructor argument is deprecated.');
      this._subscriber = subscriber;
    }
  }

  (0, _createClass2.default)(EventEmitter, [{
    key: "addListener",
    value: function addListener(eventType, listener, context) {
      return this._subscriber.addSubscription(eventType, new _EmitterSubscription.default(this, this._subscriber, listener, context));
    }
  }, {
    key: "removeAllListeners",
    value: function removeAllListeners(eventType) {
      this._subscriber.removeAllSubscriptions(eventType);
    }
  }, {
    key: "removeSubscription",
    value: function removeSubscription(subscription) {
      console.warn('EventEmitter.removeSubscription(...): Method has been deprecated. ' + 'Please instead use `remove()` on the subscription itself.');

      this.__removeSubscription(subscription);
    }
  }, {
    key: "__removeSubscription",
    value: function __removeSubscription(subscription) {
      invariant(subscription.emitter === this, 'Subscription does not belong to this emitter.');

      this._subscriber.removeSubscription(subscription);
    }
  }, {
    key: "listenerCount",
    value: function listenerCount(eventType) {
      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      return subscriptions ? subscriptions.filter(sparseFilterPredicate).length : 0;
    }
  }, {
    key: "emit",
    value: function emit(eventType) {
      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      if (subscriptions) {
        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          args[_key - 1] = arguments[_key];
        }

        for (var i = 0, l = subscriptions.length; i < l; i++) {
          var subscription = subscriptions[i];

          if (subscription && subscription.listener) {
            subscription.listener.apply(subscription.context, args);
          }
        }
      }
    }
  }, {
    key: "removeListener",
    value: function removeListener(eventType, listener) {
      console.warn("EventEmitter.removeListener('" + eventType + "', ...): Method has been " + 'deprecated. Please instead use `remove()` on the subscription ' + 'returned by `EventEmitter.addListener`.');

      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      if (subscriptions) {
        for (var i = 0, l = subscriptions.length; i < l; i++) {
          var subscription = subscriptions[i];

          if (subscription && subscription.listener === listener) {
            subscription.remove();
          }
        }
      }
    }
  }]);
  return EventEmitter;
}();

module.exports = EventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9FdmVudEVtaXR0ZXIuanMiXSwibmFtZXMiOlsiaW52YXJpYW50IiwicmVxdWlyZSIsInNwYXJzZUZpbHRlclByZWRpY2F0ZSIsIkV2ZW50RW1pdHRlciIsInN1YnNjcmliZXIiLCJfc3Vic2NyaWJlciIsIkV2ZW50U3Vic2NyaXB0aW9uVmVuZG9yIiwiY29uc29sZSIsIndhcm4iLCJldmVudFR5cGUiLCJsaXN0ZW5lciIsImNvbnRleHQiLCJhZGRTdWJzY3JpcHRpb24iLCJFbWl0dGVyU3Vic2NyaXB0aW9uIiwicmVtb3ZlQWxsU3Vic2NyaXB0aW9ucyIsInN1YnNjcmlwdGlvbiIsIl9fcmVtb3ZlU3Vic2NyaXB0aW9uIiwiZW1pdHRlciIsInJlbW92ZVN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbnMiLCJnZXRTdWJzY3JpcHRpb25zRm9yVHlwZSIsImZpbHRlciIsImxlbmd0aCIsImFyZ3MiLCJpIiwibCIsImFwcGx5IiwicmVtb3ZlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBYUE7O0FBRUE7O0FBSkEsSUFBTUEsU0FBUyxHQUFHQyxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFNQSxJQUFNQyxxQkFBcUIsR0FBRyxTQUF4QkEscUJBQXdCO0FBQUEsU0FBTSxJQUFOO0FBQUEsQ0FBOUI7O0lBZU1DLFk7QUFNSix3QkFBWUMsVUFBWixFQUFvRTtBQUFBO0FBQUEsU0FMcEVDLFdBS29FLEdBTFgsSUFBSUMsZ0NBQUosRUFLVzs7QUFDbEUsUUFBSUYsVUFBVSxJQUFJLElBQWxCLEVBQXdCO0FBQ3RCRyxNQUFBQSxPQUFPLENBQUNDLElBQVIsQ0FBYSx3REFBYjtBQUNBLFdBQUtILFdBQUwsR0FBbUJELFVBQW5CO0FBQ0Q7QUFDRjs7OztXQWFELHFCQUNFSyxTQURGLEVBR0VDLFFBSEYsRUFJRUMsT0FKRixFQUtxQjtBQUNuQixhQUFRLEtBQUtOLFdBQUwsQ0FBaUJPLGVBQWpCLENBQ05ILFNBRE0sRUFFTixJQUFJSSw0QkFBSixDQUF3QixJQUF4QixFQUE4QixLQUFLUixXQUFuQyxFQUFnREssUUFBaEQsRUFBMERDLE9BQTFELENBRk0sQ0FBUjtBQUlEOzs7V0FTRCw0QkFBK0NGLFNBQS9DLEVBQW9FO0FBQ2xFLFdBQUtKLFdBQUwsQ0FBaUJTLHNCQUFqQixDQUF3Q0wsU0FBeEM7QUFDRDs7O1dBS0QsNEJBQ0VNLFlBREYsRUFFUTtBQUNOUixNQUFBQSxPQUFPLENBQUNDLElBQVIsQ0FDRSx1RUFDRSwyREFGSjs7QUFJQSxXQUFLUSxvQkFBTCxDQUEwQkQsWUFBMUI7QUFDRDs7O1dBS0QsOEJBQ0VBLFlBREYsRUFFUTtBQUNOZixNQUFBQSxTQUFTLENBQ1BlLFlBQVksQ0FBQ0UsT0FBYixLQUF5QixJQURsQixFQUVQLCtDQUZPLENBQVQ7O0FBSUEsV0FBS1osV0FBTCxDQUFpQmEsa0JBQWpCLENBQW9DSCxZQUFwQztBQUNEOzs7V0FTRCx1QkFBMENOLFNBQTFDLEVBQWdFO0FBQzlELFVBQU1VLGFBQWEsR0FBRyxLQUFLZCxXQUFMLENBQWlCZSx1QkFBakIsQ0FBeUNYLFNBQXpDLENBQXRCOztBQUNBLGFBQU9VLGFBQWEsR0FLaEJBLGFBQWEsQ0FBQ0UsTUFBZCxDQUFxQm5CLHFCQUFyQixFQUE0Q29CLE1BTDVCLEdBTWhCLENBTko7QUFPRDs7O1dBZ0JELGNBQ0ViLFNBREYsRUFHUTtBQUNOLFVBQU1VLGFBQWEsR0FBRyxLQUFLZCxXQUFMLENBQWlCZSx1QkFBakIsQ0FBeUNYLFNBQXpDLENBQXRCOztBQUNBLFVBQUlVLGFBQUosRUFBbUI7QUFBQSwwQ0FIaEJJLElBR2dCO0FBSGhCQSxVQUFBQSxJQUdnQjtBQUFBOztBQUNqQixhQUFLLElBQUlDLENBQUMsR0FBRyxDQUFSLEVBQVdDLENBQUMsR0FBR04sYUFBYSxDQUFDRyxNQUFsQyxFQUEwQ0UsQ0FBQyxHQUFHQyxDQUE5QyxFQUFpREQsQ0FBQyxFQUFsRCxFQUFzRDtBQUNwRCxjQUFNVCxZQUFZLEdBQUdJLGFBQWEsQ0FBQ0ssQ0FBRCxDQUFsQzs7QUFHQSxjQUFJVCxZQUFZLElBQUlBLFlBQVksQ0FBQ0wsUUFBakMsRUFBMkM7QUFDekNLLFlBQUFBLFlBQVksQ0FBQ0wsUUFBYixDQUFzQmdCLEtBQXRCLENBQTRCWCxZQUFZLENBQUNKLE9BQXpDLEVBQWtEWSxJQUFsRDtBQUNEO0FBQ0Y7QUFDRjtBQUNGOzs7V0FLRCx3QkFDRWQsU0FERixFQUdFQyxRQUhGLEVBSVE7QUFDTkgsTUFBQUEsT0FBTyxDQUFDQyxJQUFSLENBQ0Usa0NBQWdDQyxTQUFoQyxpQ0FDRSxnRUFERixHQUVFLHlDQUhKOztBQUtBLFVBQU1VLGFBQWEsR0FBRyxLQUFLZCxXQUFMLENBQWlCZSx1QkFBakIsQ0FBeUNYLFNBQXpDLENBQXRCOztBQUNBLFVBQUlVLGFBQUosRUFBbUI7QUFDakIsYUFBSyxJQUFJSyxDQUFDLEdBQUcsQ0FBUixFQUFXQyxDQUFDLEdBQUdOLGFBQWEsQ0FBQ0csTUFBbEMsRUFBMENFLENBQUMsR0FBR0MsQ0FBOUMsRUFBaURELENBQUMsRUFBbEQsRUFBc0Q7QUFDcEQsY0FBTVQsWUFBWSxHQUFHSSxhQUFhLENBQUNLLENBQUQsQ0FBbEM7O0FBSUEsY0FBSVQsWUFBWSxJQUFJQSxZQUFZLENBQUNMLFFBQWIsS0FBMEJBLFFBQTlDLEVBQXdEO0FBQ3RESyxZQUFBQSxZQUFZLENBQUNZLE1BQWI7QUFDRDtBQUNGO0FBQ0Y7QUFDRjs7Ozs7QUFHSEMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCMUIsWUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93IHN0cmljdFxuICogQHR5cGVjaGVja1xuICovXG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xuXG5pbXBvcnQgRW1pdHRlclN1YnNjcmlwdGlvbiBmcm9tICcuL19FbWl0dGVyU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7dHlwZSBFdmVudFN1YnNjcmlwdGlvbn0gZnJvbSAnLi9FdmVudFN1YnNjcmlwdGlvbic7XG5pbXBvcnQgRXZlbnRTdWJzY3JpcHRpb25WZW5kb3IgZnJvbSAnLi9fRXZlbnRTdWJzY3JpcHRpb25WZW5kb3InO1xuXG5jb25zdCBzcGFyc2VGaWx0ZXJQcmVkaWNhdGUgPSAoKSA9PiB0cnVlO1xuXG4vKipcbiAqIEBjbGFzcyBFdmVudEVtaXR0ZXJcbiAqIEBkZXNjcmlwdGlvblxuICogQW4gRXZlbnRFbWl0dGVyIGlzIHJlc3BvbnNpYmxlIGZvciBtYW5hZ2luZyBhIHNldCBvZiBsaXN0ZW5lcnMgYW5kIHB1Ymxpc2hpbmdcbiAqIGV2ZW50cyB0byB0aGVtIHdoZW4gaXQgaXMgdG9sZCB0aGF0IHN1Y2ggZXZlbnRzIGhhcHBlbmVkLiBJbiBhZGRpdGlvbiB0byB0aGVcbiAqIGRhdGEgZm9yIHRoZSBnaXZlbiBldmVudCBpdCBhbHNvIHNlbmRzIGEgZXZlbnQgY29udHJvbCBvYmplY3Qgd2hpY2ggYWxsb3dzXG4gKiB0aGUgbGlzdGVuZXJzL2hhbmRsZXJzIHRvIHByZXZlbnQgdGhlIGRlZmF1bHQgYmVoYXZpb3Igb2YgdGhlIGdpdmVuIGV2ZW50LlxuICpcbiAqIFRoZSBlbWl0dGVyIGlzIGRlc2lnbmVkIHRvIGJlIGdlbmVyaWMgZW5vdWdoIHRvIHN1cHBvcnQgYWxsIHRoZSBkaWZmZXJlbnRcbiAqIGNvbnRleHRzIGluIHdoaWNoIG9uZSBtaWdodCB3YW50IHRvIGVtaXQgZXZlbnRzLiBJdCBpcyBhIHNpbXBsZSBtdWx0aWNhc3RcbiAqIG1lY2hhbmlzbSBvbiB0b3Agb2Ygd2hpY2ggZXh0cmEgZnVuY3Rpb25hbGl0eSBjYW4gYmUgY29tcG9zZWQuIEZvciBleGFtcGxlLCBhXG4gKiBtb3JlIGFkdmFuY2VkIGVtaXR0ZXIgbWF5IHVzZSBhbiBFdmVudEhvbGRlciBhbmQgRXZlbnRGYWN0b3J5LlxuICovXG5jbGFzcyBFdmVudEVtaXR0ZXI8RXZlbnREZWZpbml0aW9uczogey4uLn0+IHtcbiAgX3N1YnNjcmliZXI6IEV2ZW50U3Vic2NyaXB0aW9uVmVuZG9yPEV2ZW50RGVmaW5pdGlvbnM+ID0gbmV3IEV2ZW50U3Vic2NyaXB0aW9uVmVuZG9yPEV2ZW50RGVmaW5pdGlvbnM+KCk7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgY29uc3RydWN0b3Ioc3Vic2NyaWJlcjogP0V2ZW50U3Vic2NyaXB0aW9uVmVuZG9yPEV2ZW50RGVmaW5pdGlvbnM+KSB7XG4gICAgaWYgKHN1YnNjcmliZXIgIT0gbnVsbCkge1xuICAgICAgY29uc29sZS53YXJuKCdFdmVudEVtaXR0ZXIoLi4uKTogQ29uc3RydWN0b3IgYXJndW1lbnQgaXMgZGVwcmVjYXRlZC4nKTtcbiAgICAgIHRoaXMuX3N1YnNjcmliZXIgPSBzdWJzY3JpYmVyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgbGlzdGVuZXIgdG8gYmUgaW52b2tlZCB3aGVuIGV2ZW50cyBvZiB0aGUgc3BlY2lmaWVkIHR5cGUgYXJlXG4gICAqIGVtaXR0ZWQuIEFuIG9wdGlvbmFsIGNhbGxpbmcgY29udGV4dCBtYXkgYmUgcHJvdmlkZWQuIFRoZSBkYXRhIGFyZ3VtZW50c1xuICAgKiBlbWl0dGVkIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBsaXN0ZW5lciBmdW5jdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZSAtIE5hbWUgb2YgdGhlIGV2ZW50IHRvIGxpc3RlbiB0b1xuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBsaXN0ZW5lciAtIEZ1bmN0aW9uIHRvIGludm9rZSB3aGVuIHRoZSBzcGVjaWZpZWQgZXZlbnQgaXNcbiAgICogICBlbWl0dGVkXG4gICAqIEBwYXJhbSB7Kn0gY29udGV4dCAtIE9wdGlvbmFsIGNvbnRleHQgb2JqZWN0IHRvIHVzZSB3aGVuIGludm9raW5nIHRoZVxuICAgKiAgIGxpc3RlbmVyXG4gICAqL1xuICBhZGRMaXN0ZW5lcjxLOiAkS2V5czxFdmVudERlZmluaXRpb25zPj4oXG4gICAgZXZlbnRUeXBlOiBLLFxuICAgIC8vIEZJWE1FOiBsaXN0ZW5lcnMgc2hvdWxkIHJldHVybiB2b2lkIGluc3RlYWQgb2YgbWl4ZWQgdG8gcHJldmVudCBpc3N1ZXNcbiAgICBsaXN0ZW5lcjogKC4uLiRFbGVtZW50VHlwZTxFdmVudERlZmluaXRpb25zLCBLPikgPT4gbWl4ZWQsXG4gICAgY29udGV4dDogJEZsb3dGaXhNZSxcbiAgKTogRXZlbnRTdWJzY3JpcHRpb24ge1xuICAgIHJldHVybiAodGhpcy5fc3Vic2NyaWJlci5hZGRTdWJzY3JpcHRpb24oXG4gICAgICBldmVudFR5cGUsXG4gICAgICBuZXcgRW1pdHRlclN1YnNjcmlwdGlvbih0aGlzLCB0aGlzLl9zdWJzY3JpYmVyLCBsaXN0ZW5lciwgY29udGV4dCksXG4gICAgKTogJEZsb3dGaXhNZSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhbGwgb2YgdGhlIHJlZ2lzdGVyZWQgbGlzdGVuZXJzLCBpbmNsdWRpbmcgdGhvc2UgcmVnaXN0ZXJlZCBhc1xuICAgKiBsaXN0ZW5lciBtYXBzLlxuICAgKlxuICAgKiBAcGFyYW0gez9zdHJpbmd9IGV2ZW50VHlwZSAtIE9wdGlvbmFsIG5hbWUgb2YgdGhlIGV2ZW50IHdob3NlIHJlZ2lzdGVyZWRcbiAgICogICBsaXN0ZW5lcnMgdG8gcmVtb3ZlXG4gICAqL1xuICByZW1vdmVBbGxMaXN0ZW5lcnM8SzogJEtleXM8RXZlbnREZWZpbml0aW9ucz4+KGV2ZW50VHlwZTogP0spOiB2b2lkIHtcbiAgICB0aGlzLl9zdWJzY3JpYmVyLnJlbW92ZUFsbFN1YnNjcmlwdGlvbnMoZXZlbnRUeXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBVc2UgYHJlbW92ZWAgb24gdGhlIEV2ZW50U3Vic2NyaXB0aW9uIGZyb20gYGFkZExpc3RlbmVyYC5cbiAgICovXG4gIHJlbW92ZVN1YnNjcmlwdGlvbjxLOiAkS2V5czxFdmVudERlZmluaXRpb25zPj4oXG4gICAgc3Vic2NyaXB0aW9uOiBFbWl0dGVyU3Vic2NyaXB0aW9uPEV2ZW50RGVmaW5pdGlvbnMsIEs+LFxuICApOiB2b2lkIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnRXZlbnRFbWl0dGVyLnJlbW92ZVN1YnNjcmlwdGlvbiguLi4pOiBNZXRob2QgaGFzIGJlZW4gZGVwcmVjYXRlZC4gJyArXG4gICAgICAgICdQbGVhc2UgaW5zdGVhZCB1c2UgYHJlbW92ZSgpYCBvbiB0aGUgc3Vic2NyaXB0aW9uIGl0c2VsZi4nLFxuICAgICk7XG4gICAgdGhpcy5fX3JlbW92ZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCBieSBgRW1pdHRlclN1YnNjcmlwdGlvbmAgdG8gYnlwYXNzIHRoZSBhYm92ZSBkZXByZWNhdGlvbiB3YXJuaW5nLlxuICAgKi9cbiAgX19yZW1vdmVTdWJzY3JpcHRpb248SzogJEtleXM8RXZlbnREZWZpbml0aW9ucz4+KFxuICAgIHN1YnNjcmlwdGlvbjogRW1pdHRlclN1YnNjcmlwdGlvbjxFdmVudERlZmluaXRpb25zLCBLPixcbiAgKTogdm9pZCB7XG4gICAgaW52YXJpYW50KFxuICAgICAgc3Vic2NyaXB0aW9uLmVtaXR0ZXIgPT09IHRoaXMsXG4gICAgICAnU3Vic2NyaXB0aW9uIGRvZXMgbm90IGJlbG9uZyB0byB0aGlzIGVtaXR0ZXIuJyxcbiAgICApO1xuICAgIHRoaXMuX3N1YnNjcmliZXIucmVtb3ZlU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGxpc3RlbmVycyB0aGF0IGFyZSBjdXJyZW50bHkgcmVnaXN0ZXJlZCBmb3IgdGhlIGdpdmVuXG4gICAqIGV2ZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlIC0gTmFtZSBvZiB0aGUgZXZlbnQgdG8gcXVlcnlcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG4gIGxpc3RlbmVyQ291bnQ8SzogJEtleXM8RXZlbnREZWZpbml0aW9ucz4+KGV2ZW50VHlwZTogSyk6IG51bWJlciB7XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHRoaXMuX3N1YnNjcmliZXIuZ2V0U3Vic2NyaXB0aW9uc0ZvclR5cGUoZXZlbnRUeXBlKTtcbiAgICByZXR1cm4gc3Vic2NyaXB0aW9uc1xuICAgICAgPyAvLyBXZSBmaWx0ZXIgb3V0IG1pc3NpbmcgZW50cmllcyBiZWNhdXNlIHRoZSBhcnJheSBpcyBzcGFyc2UuXG4gICAgICAgIC8vIFwiY2FsbGJhY2tmbiBpcyBjYWxsZWQgb25seSBmb3IgZWxlbWVudHMgb2YgdGhlIGFycmF5IHdoaWNoIGFjdHVhbGx5XG4gICAgICAgIC8vIGV4aXN0OyBpdCBpcyBub3QgY2FsbGVkIGZvciBtaXNzaW5nIGVsZW1lbnRzIG9mIHRoZSBhcnJheS5cIlxuICAgICAgICAvLyBodHRwczovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzkuMC9pbmRleC5odG1sI3NlYy1hcnJheS5wcm90b3R5cGUuZmlsdGVyXG4gICAgICAgIHN1YnNjcmlwdGlvbnMuZmlsdGVyKHNwYXJzZUZpbHRlclByZWRpY2F0ZSkubGVuZ3RoXG4gICAgICA6IDA7XG4gIH1cblxuICAvKipcbiAgICogRW1pdHMgYW4gZXZlbnQgb2YgdGhlIGdpdmVuIHR5cGUgd2l0aCB0aGUgZ2l2ZW4gZGF0YS4gQWxsIGhhbmRsZXJzIG9mIHRoYXRcbiAgICogcGFydGljdWxhciB0eXBlIHdpbGwgYmUgbm90aWZpZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGUgLSBOYW1lIG9mIHRoZSBldmVudCB0byBlbWl0XG4gICAqIEBwYXJhbSB7Li4uKn0gQXJiaXRyYXJ5IGFyZ3VtZW50cyB0byBiZSBwYXNzZWQgdG8gZWFjaCByZWdpc3RlcmVkIGxpc3RlbmVyXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICAgZW1pdHRlci5hZGRMaXN0ZW5lcignc29tZUV2ZW50JywgZnVuY3Rpb24obWVzc2FnZSkge1xuICAgKiAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAqICAgfSk7XG4gICAqXG4gICAqICAgZW1pdHRlci5lbWl0KCdzb21lRXZlbnQnLCAnYWJjJyk7IC8vIGxvZ3MgJ2FiYydcbiAgICovXG4gIGVtaXQ8SzogJEtleXM8RXZlbnREZWZpbml0aW9ucz4+KFxuICAgIGV2ZW50VHlwZTogSyxcbiAgICAuLi5hcmdzOiAkRWxlbWVudFR5cGU8RXZlbnREZWZpbml0aW9ucywgSz5cbiAgKTogdm9pZCB7XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHRoaXMuX3N1YnNjcmliZXIuZ2V0U3Vic2NyaXB0aW9uc0ZvclR5cGUoZXZlbnRUeXBlKTtcbiAgICBpZiAoc3Vic2NyaXB0aW9ucykge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzdWJzY3JpcHRpb25zLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb25zW2ldO1xuXG4gICAgICAgIC8vIFRoZSBzdWJzY3JpcHRpb24gbWF5IGhhdmUgYmVlbiByZW1vdmVkIGR1cmluZyB0aGlzIGV2ZW50IGxvb3AuXG4gICAgICAgIGlmIChzdWJzY3JpcHRpb24gJiYgc3Vic2NyaXB0aW9uLmxpc3RlbmVyKSB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uLmxpc3RlbmVyLmFwcGx5KHN1YnNjcmlwdGlvbi5jb250ZXh0LCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBVc2UgYHJlbW92ZWAgb24gdGhlIEV2ZW50U3Vic2NyaXB0aW9uIGZyb20gYGFkZExpc3RlbmVyYC5cbiAgICovXG4gIHJlbW92ZUxpc3RlbmVyPEs6ICRLZXlzPEV2ZW50RGVmaW5pdGlvbnM+PihcbiAgICBldmVudFR5cGU6IEssXG4gICAgLy8gRklYTUU6IGxpc3RlbmVycyBzaG91bGQgcmV0dXJuIHZvaWQgaW5zdGVhZCBvZiBtaXhlZCB0byBwcmV2ZW50IGlzc3Vlc1xuICAgIGxpc3RlbmVyOiAoLi4uJEVsZW1lbnRUeXBlPEV2ZW50RGVmaW5pdGlvbnMsIEs+KSA9PiBtaXhlZCxcbiAgKTogdm9pZCB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgYEV2ZW50RW1pdHRlci5yZW1vdmVMaXN0ZW5lcignJHtldmVudFR5cGV9JywgLi4uKTogTWV0aG9kIGhhcyBiZWVuIGAgK1xuICAgICAgICAnZGVwcmVjYXRlZC4gUGxlYXNlIGluc3RlYWQgdXNlIGByZW1vdmUoKWAgb24gdGhlIHN1YnNjcmlwdGlvbiAnICtcbiAgICAgICAgJ3JldHVybmVkIGJ5IGBFdmVudEVtaXR0ZXIuYWRkTGlzdGVuZXJgLicsXG4gICAgKTtcbiAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gdGhpcy5fc3Vic2NyaWJlci5nZXRTdWJzY3JpcHRpb25zRm9yVHlwZShldmVudFR5cGUpO1xuICAgIGlmIChzdWJzY3JpcHRpb25zKSB7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHN1YnNjcmlwdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHN1YnNjcmlwdGlvbnNbaV07XG5cbiAgICAgICAgLy8gVGhlIHN1YnNjcmlwdGlvbiBtYXkgaGF2ZSBiZWVuIHJlbW92ZWQgZHVyaW5nIHRoaXMgZXZlbnQgbG9vcC5cbiAgICAgICAgLy8gaXRzIGxpc3RlbmVyIG1hdGNoZXMgdGhlIGxpc3RlbmVyIGluIG1ldGhvZCBwYXJhbWV0ZXJzXG4gICAgICAgIGlmIChzdWJzY3JpcHRpb24gJiYgc3Vic2NyaXB0aW9uLmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbi5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjtcbiJdfQ==