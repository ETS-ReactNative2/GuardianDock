8c16c67eadecb54ed9e4ce9bb787115b
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _extends4 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

var strictUriEncode = require('strict-uri-encode');

var decodeComponent = require('decode-uri-component');

var splitOnFirst = require('split-on-first');

var filterObject = require('filter-obj');

var isNullOrUndefined = function isNullOrUndefined(value) {
  return value === null || value === undefined;
};

var encodeFragmentIdentifier = Symbol('encodeFragmentIdentifier');

function encoderForArrayFormat(options) {
  switch (options.arrayFormat) {
    case 'index':
      return function (key) {
        return function (result, value) {
          var index = result.length;

          if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {
            return result;
          }

          if (value === null) {
            return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), '[', index, ']'].join('')]);
          }

          return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')]);
        };
      };

    case 'bracket':
      return function (key) {
        return function (result, value) {
          if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {
            return result;
          }

          if (value === null) {
            return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), '[]'].join('')]);
          }

          return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), '[]=', encode(value, options)].join('')]);
        };
      };

    case 'colon-list-separator':
      return function (key) {
        return function (result, value) {
          if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {
            return result;
          }

          if (value === null) {
            return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), ':list='].join('')]);
          }

          return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), ':list=', encode(value, options)].join('')]);
        };
      };

    case 'comma':
    case 'separator':
    case 'bracket-separator':
      {
        var keyValueSep = options.arrayFormat === 'bracket-separator' ? '[]=' : '=';
        return function (key) {
          return function (result, value) {
            if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {
              return result;
            }

            value = value === null ? '' : value;

            if (result.length === 0) {
              return [[encode(key, options), keyValueSep, encode(value, options)].join('')];
            }

            return [[result, encode(value, options)].join(options.arrayFormatSeparator)];
          };
        };
      }

    default:
      return function (key) {
        return function (result, value) {
          if (value === undefined || options.skipNull && value === null || options.skipEmptyString && value === '') {
            return result;
          }

          if (value === null) {
            return [].concat((0, _toConsumableArray2.default)(result), [encode(key, options)]);
          }

          return [].concat((0, _toConsumableArray2.default)(result), [[encode(key, options), '=', encode(value, options)].join('')]);
        };
      };
  }
}

function parserForArrayFormat(options) {
  var result;

  switch (options.arrayFormat) {
    case 'index':
      return function (key, value, accumulator) {
        result = /\[(\d*)\]$/.exec(key);
        key = key.replace(/\[\d*\]$/, '');

        if (!result) {
          accumulator[key] = value;
          return;
        }

        if (accumulator[key] === undefined) {
          accumulator[key] = {};
        }

        accumulator[key][result[1]] = value;
      };

    case 'bracket':
      return function (key, value, accumulator) {
        result = /(\[\])$/.exec(key);
        key = key.replace(/\[\]$/, '');

        if (!result) {
          accumulator[key] = value;
          return;
        }

        if (accumulator[key] === undefined) {
          accumulator[key] = [value];
          return;
        }

        accumulator[key] = [].concat(accumulator[key], value);
      };

    case 'colon-list-separator':
      return function (key, value, accumulator) {
        result = /(:list)$/.exec(key);
        key = key.replace(/:list$/, '');

        if (!result) {
          accumulator[key] = value;
          return;
        }

        if (accumulator[key] === undefined) {
          accumulator[key] = [value];
          return;
        }

        accumulator[key] = [].concat(accumulator[key], value);
      };

    case 'comma':
    case 'separator':
      return function (key, value, accumulator) {
        var isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);
        var isEncodedArray = typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator);
        value = isEncodedArray ? decode(value, options) : value;
        var newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(function (item) {
          return decode(item, options);
        }) : value === null ? value : decode(value, options);
        accumulator[key] = newValue;
      };

    case 'bracket-separator':
      return function (key, value, accumulator) {
        var isArray = /(\[\])$/.test(key);
        key = key.replace(/\[\]$/, '');

        if (!isArray) {
          accumulator[key] = value ? decode(value, options) : value;
          return;
        }

        var arrayValue = value === null ? [] : value.split(options.arrayFormatSeparator).map(function (item) {
          return decode(item, options);
        });

        if (accumulator[key] === undefined) {
          accumulator[key] = arrayValue;
          return;
        }

        accumulator[key] = [].concat(accumulator[key], arrayValue);
      };

    default:
      return function (key, value, accumulator) {
        if (accumulator[key] === undefined) {
          accumulator[key] = value;
          return;
        }

        accumulator[key] = [].concat(accumulator[key], value);
      };
  }
}

function validateArrayFormatSeparator(value) {
  if (typeof value !== 'string' || value.length !== 1) {
    throw new TypeError('arrayFormatSeparator must be single character string');
  }
}

function encode(value, options) {
  if (options.encode) {
    return options.strict ? strictUriEncode(value) : encodeURIComponent(value);
  }

  return value;
}

function decode(value, options) {
  if (options.decode) {
    return decodeComponent(value);
  }

  return value;
}

function keysSorter(input) {
  if (Array.isArray(input)) {
    return input.sort();
  }

  if (typeof input === 'object') {
    return keysSorter(Object.keys(input)).sort(function (a, b) {
      return Number(a) - Number(b);
    }).map(function (key) {
      return input[key];
    });
  }

  return input;
}

function removeHash(input) {
  var hashStart = input.indexOf('#');

  if (hashStart !== -1) {
    input = input.slice(0, hashStart);
  }

  return input;
}

function getHash(url) {
  var hash = '';
  var hashStart = url.indexOf('#');

  if (hashStart !== -1) {
    hash = url.slice(hashStart);
  }

  return hash;
}

function extract(input) {
  input = removeHash(input);
  var queryStart = input.indexOf('?');

  if (queryStart === -1) {
    return '';
  }

  return input.slice(queryStart + 1);
}

function parseValue(value, options) {
  if (options.parseNumbers && !Number.isNaN(Number(value)) && typeof value === 'string' && value.trim() !== '') {
    value = Number(value);
  } else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {
    value = value.toLowerCase() === 'true';
  }

  return value;
}

function parse(query, options) {
  options = (0, _extends4.default)({
    decode: true,
    sort: true,
    arrayFormat: 'none',
    arrayFormatSeparator: ',',
    parseNumbers: false,
    parseBooleans: false
  }, options);
  validateArrayFormatSeparator(options.arrayFormatSeparator);
  var formatter = parserForArrayFormat(options);
  var ret = Object.create(null);

  if (typeof query !== 'string') {
    return ret;
  }

  query = query.trim().replace(/^[?#&]/, '');

  if (!query) {
    return ret;
  }

  for (var _iterator = _createForOfIteratorHelperLoose(query.split('&')), _step; !(_step = _iterator()).done;) {
    var param = _step.value;

    if (param === '') {
      continue;
    }

    var _splitOnFirst = splitOnFirst(options.decode ? param.replace(/\+/g, ' ') : param, '='),
        _splitOnFirst2 = (0, _slicedToArray2.default)(_splitOnFirst, 2),
        key = _splitOnFirst2[0],
        value = _splitOnFirst2[1];

    value = value === undefined ? null : ['comma', 'separator', 'bracket-separator'].includes(options.arrayFormat) ? value : decode(value, options);
    formatter(decode(key, options), value, ret);
  }

  for (var _i = 0, _Object$keys = Object.keys(ret); _i < _Object$keys.length; _i++) {
    var _key = _Object$keys[_i];
    var _value = ret[_key];

    if (typeof _value === 'object' && _value !== null) {
      for (var _i2 = 0, _Object$keys2 = Object.keys(_value); _i2 < _Object$keys2.length; _i2++) {
        var k = _Object$keys2[_i2];
        _value[k] = parseValue(_value[k], options);
      }
    } else {
      ret[_key] = parseValue(_value, options);
    }
  }

  if (options.sort === false) {
    return ret;
  }

  return (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce(function (result, key) {
    var value = ret[key];

    if (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {
      result[key] = keysSorter(value);
    } else {
      result[key] = value;
    }

    return result;
  }, Object.create(null));
}

exports.extract = extract;
exports.parse = parse;

exports.stringify = function (object, options) {
  if (!object) {
    return '';
  }

  options = (0, _extends4.default)({
    encode: true,
    strict: true,
    arrayFormat: 'none',
    arrayFormatSeparator: ','
  }, options);
  validateArrayFormatSeparator(options.arrayFormatSeparator);

  var shouldFilter = function shouldFilter(key) {
    return options.skipNull && isNullOrUndefined(object[key]) || options.skipEmptyString && object[key] === '';
  };

  var formatter = encoderForArrayFormat(options);
  var objectCopy = {};

  for (var _i3 = 0, _Object$keys3 = Object.keys(object); _i3 < _Object$keys3.length; _i3++) {
    var key = _Object$keys3[_i3];

    if (!shouldFilter(key)) {
      objectCopy[key] = object[key];
    }
  }

  var keys = Object.keys(objectCopy);

  if (options.sort !== false) {
    keys.sort(options.sort);
  }

  return keys.map(function (key) {
    var value = object[key];

    if (value === undefined) {
      return '';
    }

    if (value === null) {
      return encode(key, options);
    }

    if (Array.isArray(value)) {
      if (value.length === 0 && options.arrayFormat === 'bracket-separator') {
        return encode(key, options) + '[]';
      }

      return value.reduce(formatter(key), []).join('&');
    }

    return encode(key, options) + '=' + encode(value, options);
  }).filter(function (x) {
    return x.length > 0;
  }).join('&');
};

exports.parseUrl = function (url, options) {
  options = (0, _extends4.default)({
    decode: true
  }, options);

  var _splitOnFirst3 = splitOnFirst(url, '#'),
      _splitOnFirst4 = (0, _slicedToArray2.default)(_splitOnFirst3, 2),
      url_ = _splitOnFirst4[0],
      hash = _splitOnFirst4[1];

  return (0, _extends4.default)({
    url: url_.split('?')[0] || '',
    query: parse(extract(url), options)
  }, options && options.parseFragmentIdentifier && hash ? {
    fragmentIdentifier: decode(hash, options)
  } : {});
};

exports.stringifyUrl = function (object, options) {
  options = (0, _extends4.default)((0, _defineProperty2.default)({
    encode: true,
    strict: true
  }, encodeFragmentIdentifier, true), options);
  var url = removeHash(object.url).split('?')[0] || '';
  var queryFromUrl = exports.extract(object.url);
  var parsedQueryFromUrl = exports.parse(queryFromUrl, {
    sort: false
  });
  var query = (0, _extends4.default)(parsedQueryFromUrl, object.query);
  var queryString = exports.stringify(query, options);

  if (queryString) {
    queryString = "?" + queryString;
  }

  var hash = getHash(object.url);

  if (object.fragmentIdentifier) {
    hash = "#" + (options[encodeFragmentIdentifier] ? encode(object.fragmentIdentifier, options) : object.fragmentIdentifier);
  }

  return "" + url + queryString + hash;
};

exports.pick = function (input, filter, options) {
  options = (0, _extends4.default)((0, _defineProperty2.default)({
    parseFragmentIdentifier: true
  }, encodeFragmentIdentifier, false), options);

  var _exports$parseUrl = exports.parseUrl(input, options),
      url = _exports$parseUrl.url,
      query = _exports$parseUrl.query,
      fragmentIdentifier = _exports$parseUrl.fragmentIdentifier;

  return exports.stringifyUrl({
    url: url,
    query: filterObject(query, filter),
    fragmentIdentifier: fragmentIdentifier
  }, options);
};

exports.exclude = function (input, filter, options) {
  var exclusionFilter = Array.isArray(filter) ? function (key) {
    return !filter.includes(key);
  } : function (key, value) {
    return !filter(key, value);
  };
  return exports.pick(input, exclusionFilter, options);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInN0cmljdFVyaUVuY29kZSIsInJlcXVpcmUiLCJkZWNvZGVDb21wb25lbnQiLCJzcGxpdE9uRmlyc3QiLCJmaWx0ZXJPYmplY3QiLCJpc051bGxPclVuZGVmaW5lZCIsInZhbHVlIiwidW5kZWZpbmVkIiwiZW5jb2RlRnJhZ21lbnRJZGVudGlmaWVyIiwiU3ltYm9sIiwiZW5jb2RlckZvckFycmF5Rm9ybWF0Iiwib3B0aW9ucyIsImFycmF5Rm9ybWF0Iiwia2V5IiwicmVzdWx0IiwiaW5kZXgiLCJsZW5ndGgiLCJza2lwTnVsbCIsInNraXBFbXB0eVN0cmluZyIsImVuY29kZSIsImpvaW4iLCJrZXlWYWx1ZVNlcCIsImFycmF5Rm9ybWF0U2VwYXJhdG9yIiwicGFyc2VyRm9yQXJyYXlGb3JtYXQiLCJhY2N1bXVsYXRvciIsImV4ZWMiLCJyZXBsYWNlIiwiY29uY2F0IiwiaXNBcnJheSIsImluY2x1ZGVzIiwiaXNFbmNvZGVkQXJyYXkiLCJkZWNvZGUiLCJuZXdWYWx1ZSIsInNwbGl0IiwibWFwIiwiaXRlbSIsInRlc3QiLCJhcnJheVZhbHVlIiwidmFsaWRhdGVBcnJheUZvcm1hdFNlcGFyYXRvciIsIlR5cGVFcnJvciIsInN0cmljdCIsImVuY29kZVVSSUNvbXBvbmVudCIsImtleXNTb3J0ZXIiLCJpbnB1dCIsIkFycmF5Iiwic29ydCIsIk9iamVjdCIsImtleXMiLCJhIiwiYiIsIk51bWJlciIsInJlbW92ZUhhc2giLCJoYXNoU3RhcnQiLCJpbmRleE9mIiwic2xpY2UiLCJnZXRIYXNoIiwidXJsIiwiaGFzaCIsImV4dHJhY3QiLCJxdWVyeVN0YXJ0IiwicGFyc2VWYWx1ZSIsInBhcnNlTnVtYmVycyIsImlzTmFOIiwidHJpbSIsInBhcnNlQm9vbGVhbnMiLCJ0b0xvd2VyQ2FzZSIsInBhcnNlIiwicXVlcnkiLCJmb3JtYXR0ZXIiLCJyZXQiLCJjcmVhdGUiLCJwYXJhbSIsImsiLCJyZWR1Y2UiLCJCb29sZWFuIiwiZXhwb3J0cyIsInN0cmluZ2lmeSIsIm9iamVjdCIsInNob3VsZEZpbHRlciIsIm9iamVjdENvcHkiLCJmaWx0ZXIiLCJ4IiwicGFyc2VVcmwiLCJ1cmxfIiwicGFyc2VGcmFnbWVudElkZW50aWZpZXIiLCJmcmFnbWVudElkZW50aWZpZXIiLCJzdHJpbmdpZnlVcmwiLCJxdWVyeUZyb21VcmwiLCJwYXJzZWRRdWVyeUZyb21VcmwiLCJxdWVyeVN0cmluZyIsInBpY2siLCJleGNsdWRlIiwiZXhjbHVzaW9uRmlsdGVyIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0EsSUFBTUEsZUFBZSxHQUFHQyxPQUFPLENBQUMsbUJBQUQsQ0FBL0I7O0FBQ0EsSUFBTUMsZUFBZSxHQUFHRCxPQUFPLENBQUMsc0JBQUQsQ0FBL0I7O0FBQ0EsSUFBTUUsWUFBWSxHQUFHRixPQUFPLENBQUMsZ0JBQUQsQ0FBNUI7O0FBQ0EsSUFBTUcsWUFBWSxHQUFHSCxPQUFPLENBQUMsWUFBRCxDQUE1Qjs7QUFFQSxJQUFNSSxpQkFBaUIsR0FBRyxTQUFwQkEsaUJBQW9CLENBQUFDLEtBQUs7QUFBQSxTQUFJQSxLQUFLLEtBQUssSUFBVixJQUFrQkEsS0FBSyxLQUFLQyxTQUFoQztBQUFBLENBQS9COztBQUVBLElBQU1DLHdCQUF3QixHQUFHQyxNQUFNLENBQUMsMEJBQUQsQ0FBdkM7O0FBRUEsU0FBU0MscUJBQVQsQ0FBK0JDLE9BQS9CLEVBQXdDO0FBQ3ZDLFVBQVFBLE9BQU8sQ0FBQ0MsV0FBaEI7QUFDQyxTQUFLLE9BQUw7QUFDQyxhQUFPLFVBQUFDLEdBQUc7QUFBQSxlQUFJLFVBQUNDLE1BQUQsRUFBU1IsS0FBVCxFQUFtQjtBQUNoQyxjQUFNUyxLQUFLLEdBQUdELE1BQU0sQ0FBQ0UsTUFBckI7O0FBRUEsY0FDQ1YsS0FBSyxLQUFLQyxTQUFWLElBQ0NJLE9BQU8sQ0FBQ00sUUFBUixJQUFvQlgsS0FBSyxLQUFLLElBRC9CLElBRUNLLE9BQU8sQ0FBQ08sZUFBUixJQUEyQlosS0FBSyxLQUFLLEVB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QWQsSUFBd0IsVUFBQW5FLEdBQUc7QUFBQSxXQUFJLENBQUNtRSxNQUFNLENBQUNuRCxRQUFQLENBQWdCaEIsR0FBaEIsQ0FBTDtBQUFBLEdBQTNCLEdBQXVELFVBQUNBLEdBQUQsRUFBTVAsS0FBTjtBQUFBLFdBQWdCLENBQUMwRSxNQUFNLENBQUNuRSxHQUFELEVBQU1QLEtBQU4sQ0FBdkI7QUFBQSxHQUEvRTtBQUVBLFNBQU9xRSxPQUFPLENBQUNlLElBQVIsQ0FBYS9DLEtBQWIsRUFBb0JpRCxlQUFwQixFQUFxQ2pGLE9BQXJDLENBQVA7QUFDQSxDQUpEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuY29uc3Qgc3RyaWN0VXJpRW5jb2RlID0gcmVxdWlyZSgnc3RyaWN0LXVyaS1lbmNvZGUnKTtcbmNvbnN0IGRlY29kZUNvbXBvbmVudCA9IHJlcXVpcmUoJ2RlY29kZS11cmktY29tcG9uZW50Jyk7XG5jb25zdCBzcGxpdE9uRmlyc3QgPSByZXF1aXJlKCdzcGxpdC1vbi1maXJzdCcpO1xuY29uc3QgZmlsdGVyT2JqZWN0ID0gcmVxdWlyZSgnZmlsdGVyLW9iaicpO1xuXG5jb25zdCBpc051bGxPclVuZGVmaW5lZCA9IHZhbHVlID0+IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQ7XG5cbmNvbnN0IGVuY29kZUZyYWdtZW50SWRlbnRpZmllciA9IFN5bWJvbCgnZW5jb2RlRnJhZ21lbnRJZGVudGlmaWVyJyk7XG5cbmZ1bmN0aW9uIGVuY29kZXJGb3JBcnJheUZvcm1hdChvcHRpb25zKSB7XG5cdHN3aXRjaCAob3B0aW9ucy5hcnJheUZvcm1hdCkge1xuXHRcdGNhc2UgJ2luZGV4Jzpcblx0XHRcdHJldHVybiBrZXkgPT4gKHJlc3VsdCwgdmFsdWUpID0+IHtcblx0XHRcdFx0Y29uc3QgaW5kZXggPSByZXN1bHQubGVuZ3RoO1xuXG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHR2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcE51bGwgJiYgdmFsdWUgPT09IG51bGwpIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcEVtcHR5U3RyaW5nICYmIHZhbHVlID09PSAnJylcblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdHJldHVybiBbLi4ucmVzdWx0LCBbZW5jb2RlKGtleSwgb3B0aW9ucyksICdbJywgaW5kZXgsICddJ10uam9pbignJyldO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0XHQuLi5yZXN1bHQsXG5cdFx0XHRcdFx0W2VuY29kZShrZXksIG9wdGlvbnMpLCAnWycsIGVuY29kZShpbmRleCwgb3B0aW9ucyksICddPScsIGVuY29kZSh2YWx1ZSwgb3B0aW9ucyldLmpvaW4oJycpXG5cdFx0XHRcdF07XG5cdFx0XHR9O1xuXG5cdFx0Y2FzZSAnYnJhY2tldCc6XG5cdFx0XHRyZXR1cm4ga2V5ID0+IChyZXN1bHQsIHZhbHVlKSA9PiB7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHR2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcE51bGwgJiYgdmFsdWUgPT09IG51bGwpIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcEVtcHR5U3RyaW5nICYmIHZhbHVlID09PSAnJylcblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdHJldHVybiBbLi4ucmVzdWx0LCBbZW5jb2RlKGtleSwgb3B0aW9ucyksICdbXSddLmpvaW4oJycpXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBbLi4ucmVzdWx0LCBbZW5jb2RlKGtleSwgb3B0aW9ucyksICdbXT0nLCBlbmNvZGUodmFsdWUsIG9wdGlvbnMpXS5qb2luKCcnKV07XG5cdFx0XHR9O1xuXG5cdFx0Y2FzZSAnY29sb24tbGlzdC1zZXBhcmF0b3InOlxuXHRcdFx0cmV0dXJuIGtleSA9PiAocmVzdWx0LCB2YWx1ZSkgPT4ge1xuXHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0dmFsdWUgPT09IHVuZGVmaW5lZCB8fFxuXHRcdFx0XHRcdChvcHRpb25zLnNraXBOdWxsICYmIHZhbHVlID09PSBudWxsKSB8fFxuXHRcdFx0XHRcdChvcHRpb25zLnNraXBFbXB0eVN0cmluZyAmJiB2YWx1ZSA9PT0gJycpXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodmFsdWUgPT09IG51bGwpIHtcblx0XHRcdFx0XHRyZXR1cm4gWy4uLnJlc3VsdCwgW2VuY29kZShrZXksIG9wdGlvbnMpLCAnOmxpc3Q9J10uam9pbignJyldO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIFsuLi5yZXN1bHQsIFtlbmNvZGUoa2V5LCBvcHRpb25zKSwgJzpsaXN0PScsIGVuY29kZSh2YWx1ZSwgb3B0aW9ucyldLmpvaW4oJycpXTtcblx0XHRcdH07XG5cblx0XHRjYXNlICdjb21tYSc6XG5cdFx0Y2FzZSAnc2VwYXJhdG9yJzpcblx0XHRjYXNlICdicmFja2V0LXNlcGFyYXRvcic6IHtcblx0XHRcdGNvbnN0IGtleVZhbHVlU2VwID0gb3B0aW9ucy5hcnJheUZvcm1hdCA9PT0gJ2JyYWNrZXQtc2VwYXJhdG9yJyA/XG5cdFx0XHRcdCdbXT0nIDpcblx0XHRcdFx0Jz0nO1xuXG5cdFx0XHRyZXR1cm4ga2V5ID0+IChyZXN1bHQsIHZhbHVlKSA9PiB7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHR2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcE51bGwgJiYgdmFsdWUgPT09IG51bGwpIHx8XG5cdFx0XHRcdFx0KG9wdGlvbnMuc2tpcEVtcHR5U3RyaW5nICYmIHZhbHVlID09PSAnJylcblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFRyYW5zbGF0ZSBudWxsIHRvIGFuIGVtcHR5IHN0cmluZyBzbyB0aGF0IGl0IGRvZXNuJ3Qgc2VyaWFsaXplIGFzICdudWxsJ1xuXHRcdFx0XHR2YWx1ZSA9IHZhbHVlID09PSBudWxsID8gJycgOiB2YWx1ZTtcblxuXHRcdFx0XHRpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdHJldHVybiBbW2VuY29kZShrZXksIG9wdGlvbnMpLCBrZXlWYWx1ZVNlcCwgZW5jb2RlKHZhbHVlLCBvcHRpb25zKV0uam9pbignJyldO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIFtbcmVzdWx0LCBlbmNvZGUodmFsdWUsIG9wdGlvbnMpXS5qb2luKG9wdGlvbnMuYXJyYXlGb3JtYXRTZXBhcmF0b3IpXTtcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0ZGVmYXVsdDpcblx0XHRcdHJldHVybiBrZXkgPT4gKHJlc3VsdCwgdmFsdWUpID0+IHtcblx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdHZhbHVlID09PSB1bmRlZmluZWQgfHxcblx0XHRcdFx0XHQob3B0aW9ucy5za2lwTnVsbCAmJiB2YWx1ZSA9PT0gbnVsbCkgfHxcblx0XHRcdFx0XHQob3B0aW9ucy5za2lwRW1wdHlTdHJpbmcgJiYgdmFsdWUgPT09ICcnKVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHZhbHVlID09PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFsuLi5yZXN1bHQsIGVuY29kZShrZXksIG9wdGlvbnMpXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBbLi4ucmVzdWx0LCBbZW5jb2RlKGtleSwgb3B0aW9ucyksICc9JywgZW5jb2RlKHZhbHVlLCBvcHRpb25zKV0uam9pbignJyldO1xuXHRcdFx0fTtcblx0fVxufVxuXG5mdW5jdGlvbiBwYXJzZXJGb3JBcnJheUZvcm1hdChvcHRpb25zKSB7XG5cdGxldCByZXN1bHQ7XG5cblx0c3dpdGNoIChvcHRpb25zLmFycmF5Rm9ybWF0KSB7XG5cdFx0Y2FzZSAnaW5kZXgnOlxuXHRcdFx0cmV0dXJuIChrZXksIHZhbHVlLCBhY2N1bXVsYXRvcikgPT4ge1xuXHRcdFx0XHRyZXN1bHQgPSAvXFxbKFxcZCopXFxdJC8uZXhlYyhrZXkpO1xuXG5cdFx0XHRcdGtleSA9IGtleS5yZXBsYWNlKC9cXFtcXGQqXFxdJC8sICcnKTtcblxuXHRcdFx0XHRpZiAoIXJlc3VsdCkge1xuXHRcdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSB2YWx1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYWNjdW11bGF0b3Jba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0YWNjdW11bGF0b3Jba2V5XSA9IHt9O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YWNjdW11bGF0b3Jba2V5XVtyZXN1bHRbMV1dID0gdmFsdWU7XG5cdFx0XHR9O1xuXG5cdFx0Y2FzZSAnYnJhY2tldCc6XG5cdFx0XHRyZXR1cm4gKGtleSwgdmFsdWUsIGFjY3VtdWxhdG9yKSA9PiB7XG5cdFx0XHRcdHJlc3VsdCA9IC8oXFxbXFxdKSQvLmV4ZWMoa2V5KTtcblx0XHRcdFx0a2V5ID0ga2V5LnJlcGxhY2UoL1xcW1xcXSQvLCAnJyk7XG5cblx0XHRcdFx0aWYgKCFyZXN1bHQpIHtcblx0XHRcdFx0XHRhY2N1bXVsYXRvcltrZXldID0gdmFsdWU7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFjY3VtdWxhdG9yW2tleV0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSBbdmFsdWVdO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSBbXS5jb25jYXQoYWNjdW11bGF0b3Jba2V5XSwgdmFsdWUpO1xuXHRcdFx0fTtcblxuXHRcdGNhc2UgJ2NvbG9uLWxpc3Qtc2VwYXJhdG9yJzpcblx0XHRcdHJldHVybiAoa2V5LCB2YWx1ZSwgYWNjdW11bGF0b3IpID0+IHtcblx0XHRcdFx0cmVzdWx0ID0gLyg6bGlzdCkkLy5leGVjKGtleSk7XG5cdFx0XHRcdGtleSA9IGtleS5yZXBsYWNlKC86bGlzdCQvLCAnJyk7XG5cblx0XHRcdFx0aWYgKCFyZXN1bHQpIHtcblx0XHRcdFx0XHRhY2N1bXVsYXRvcltrZXldID0gdmFsdWU7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFjY3VtdWxhdG9yW2tleV0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSBbdmFsdWVdO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSBbXS5jb25jYXQoYWNjdW11bGF0b3Jba2V5XSwgdmFsdWUpO1xuXHRcdFx0fTtcblxuXHRcdGNhc2UgJ2NvbW1hJzpcblx0XHRjYXNlICdzZXBhcmF0b3InOlxuXHRcdFx0cmV0dXJuIChrZXksIHZhbHVlLCBhY2N1bXVsYXRvcikgPT4ge1xuXHRcdFx0XHRjb25zdCBpc0FycmF5ID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5pbmNsdWRlcyhvcHRpb25zLmFycmF5Rm9ybWF0U2VwYXJhdG9yKTtcblx0XHRcdFx0Y29uc3QgaXNFbmNvZGVkQXJyYXkgPSAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAhaXNBcnJheSAmJiBkZWNvZGUodmFsdWUsIG9wdGlvbnMpLmluY2x1ZGVzKG9wdGlvbnMuYXJyYXlGb3JtYXRTZXBhcmF0b3IpKTtcblx0XHRcdFx0dmFsdWUgPSBpc0VuY29kZWRBcnJheSA/IGRlY29kZSh2YWx1ZSwgb3B0aW9ucykgOiB2YWx1ZTtcblx0XHRcdFx0Y29uc3QgbmV3VmFsdWUgPSBpc0FycmF5IHx8IGlzRW5jb2RlZEFycmF5ID8gdmFsdWUuc3BsaXQob3B0aW9ucy5hcnJheUZvcm1hdFNlcGFyYXRvcikubWFwKGl0ZW0gPT4gZGVjb2RlKGl0ZW0sIG9wdGlvbnMpKSA6IHZhbHVlID09PSBudWxsID8gdmFsdWUgOiBkZWNvZGUodmFsdWUsIG9wdGlvbnMpO1xuXHRcdFx0XHRhY2N1bXVsYXRvcltrZXldID0gbmV3VmFsdWU7XG5cdFx0XHR9O1xuXG5cdFx0Y2FzZSAnYnJhY2tldC1zZXBhcmF0b3InOlxuXHRcdFx0cmV0dXJuIChrZXksIHZhbHVlLCBhY2N1bXVsYXRvcikgPT4ge1xuXHRcdFx0XHRjb25zdCBpc0FycmF5ID0gLyhcXFtcXF0pJC8udGVzdChrZXkpO1xuXHRcdFx0XHRrZXkgPSBrZXkucmVwbGFjZSgvXFxbXFxdJC8sICcnKTtcblxuXHRcdFx0XHRpZiAoIWlzQXJyYXkpIHtcblx0XHRcdFx0XHRhY2N1bXVsYXRvcltrZXldID0gdmFsdWUgPyBkZWNvZGUodmFsdWUsIG9wdGlvbnMpIDogdmFsdWU7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgYXJyYXlWYWx1ZSA9IHZhbHVlID09PSBudWxsID9cblx0XHRcdFx0XHRbXSA6XG5cdFx0XHRcdFx0dmFsdWUuc3BsaXQob3B0aW9ucy5hcnJheUZvcm1hdFNlcGFyYXRvcikubWFwKGl0ZW0gPT4gZGVjb2RlKGl0ZW0sIG9wdGlvbnMpKTtcblxuXHRcdFx0XHRpZiAoYWNjdW11bGF0b3Jba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0YWNjdW11bGF0b3Jba2V5XSA9IGFycmF5VmFsdWU7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YWNjdW11bGF0b3Jba2V5XSA9IFtdLmNvbmNhdChhY2N1bXVsYXRvcltrZXldLCBhcnJheVZhbHVlKTtcblx0XHRcdH07XG5cblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIChrZXksIHZhbHVlLCBhY2N1bXVsYXRvcikgPT4ge1xuXHRcdFx0XHRpZiAoYWNjdW11bGF0b3Jba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0YWNjdW11bGF0b3Jba2V5XSA9IHZhbHVlO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGFjY3VtdWxhdG9yW2tleV0gPSBbXS5jb25jYXQoYWNjdW11bGF0b3Jba2V5XSwgdmFsdWUpO1xuXHRcdFx0fTtcblx0fVxufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUFycmF5Rm9ybWF0U2VwYXJhdG9yKHZhbHVlKSB7XG5cdGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnIHx8IHZhbHVlLmxlbmd0aCAhPT0gMSkge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ2FycmF5Rm9ybWF0U2VwYXJhdG9yIG11c3QgYmUgc2luZ2xlIGNoYXJhY3RlciBzdHJpbmcnKTtcblx0fVxufVxuXG5mdW5jdGlvbiBlbmNvZGUodmFsdWUsIG9wdGlvbnMpIHtcblx0aWYgKG9wdGlvbnMuZW5jb2RlKSB7XG5cdFx0cmV0dXJuIG9wdGlvbnMuc3RyaWN0ID8gc3RyaWN0VXJpRW5jb2RlKHZhbHVlKSA6IGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG5cdH1cblxuXHRyZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIGRlY29kZSh2YWx1ZSwgb3B0aW9ucykge1xuXHRpZiAob3B0aW9ucy5kZWNvZGUpIHtcblx0XHRyZXR1cm4gZGVjb2RlQ29tcG9uZW50KHZhbHVlKTtcblx0fVxuXG5cdHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24ga2V5c1NvcnRlcihpbnB1dCkge1xuXHRpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcblx0XHRyZXR1cm4gaW5wdXQuc29ydCgpO1xuXHR9XG5cblx0aWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcblx0XHRyZXR1cm4ga2V5c1NvcnRlcihPYmplY3Qua2V5cyhpbnB1dCkpXG5cdFx0XHQuc29ydCgoYSwgYikgPT4gTnVtYmVyKGEpIC0gTnVtYmVyKGIpKVxuXHRcdFx0Lm1hcChrZXkgPT4gaW5wdXRba2V5XSk7XG5cdH1cblxuXHRyZXR1cm4gaW5wdXQ7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUhhc2goaW5wdXQpIHtcblx0Y29uc3QgaGFzaFN0YXJ0ID0gaW5wdXQuaW5kZXhPZignIycpO1xuXHRpZiAoaGFzaFN0YXJ0ICE9PSAtMSkge1xuXHRcdGlucHV0ID0gaW5wdXQuc2xpY2UoMCwgaGFzaFN0YXJ0KTtcblx0fVxuXG5cdHJldHVybiBpbnB1dDtcbn1cblxuZnVuY3Rpb24gZ2V0SGFzaCh1cmwpIHtcblx0bGV0IGhhc2ggPSAnJztcblx0Y29uc3QgaGFzaFN0YXJ0ID0gdXJsLmluZGV4T2YoJyMnKTtcblx0aWYgKGhhc2hTdGFydCAhPT0gLTEpIHtcblx0XHRoYXNoID0gdXJsLnNsaWNlKGhhc2hTdGFydCk7XG5cdH1cblxuXHRyZXR1cm4gaGFzaDtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdChpbnB1dCkge1xuXHRpbnB1dCA9IHJlbW92ZUhhc2goaW5wdXQpO1xuXHRjb25zdCBxdWVyeVN0YXJ0ID0gaW5wdXQuaW5kZXhPZignPycpO1xuXHRpZiAocXVlcnlTdGFydCA9PT0gLTEpIHtcblx0XHRyZXR1cm4gJyc7XG5cdH1cblxuXHRyZXR1cm4gaW5wdXQuc2xpY2UocXVlcnlTdGFydCArIDEpO1xufVxuXG5mdW5jdGlvbiBwYXJzZVZhbHVlKHZhbHVlLCBvcHRpb25zKSB7XG5cdGlmIChvcHRpb25zLnBhcnNlTnVtYmVycyAmJiAhTnVtYmVyLmlzTmFOKE51bWJlcih2YWx1ZSkpICYmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLnRyaW0oKSAhPT0gJycpKSB7XG5cdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXHR9IGVsc2UgaWYgKG9wdGlvbnMucGFyc2VCb29sZWFucyAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAodmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnIHx8IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZScpKSB7XG5cdFx0dmFsdWUgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7XG5cdH1cblxuXHRyZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIHBhcnNlKHF1ZXJ5LCBvcHRpb25zKSB7XG5cdG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHtcblx0XHRkZWNvZGU6IHRydWUsXG5cdFx0c29ydDogdHJ1ZSxcblx0XHRhcnJheUZvcm1hdDogJ25vbmUnLFxuXHRcdGFycmF5Rm9ybWF0U2VwYXJhdG9yOiAnLCcsXG5cdFx0cGFyc2VOdW1iZXJzOiBmYWxzZSxcblx0XHRwYXJzZUJvb2xlYW5zOiBmYWxzZVxuXHR9LCBvcHRpb25zKTtcblxuXHR2YWxpZGF0ZUFycmF5Rm9ybWF0U2VwYXJhdG9yKG9wdGlvbnMuYXJyYXlGb3JtYXRTZXBhcmF0b3IpO1xuXG5cdGNvbnN0IGZvcm1hdHRlciA9IHBhcnNlckZvckFycmF5Rm9ybWF0KG9wdGlvbnMpO1xuXG5cdC8vIENyZWF0ZSBhbiBvYmplY3Qgd2l0aCBubyBwcm90b3R5cGVcblx0Y29uc3QgcmV0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuXHRpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykge1xuXHRcdHJldHVybiByZXQ7XG5cdH1cblxuXHRxdWVyeSA9IHF1ZXJ5LnRyaW0oKS5yZXBsYWNlKC9eWz8jJl0vLCAnJyk7XG5cblx0aWYgKCFxdWVyeSkge1xuXHRcdHJldHVybiByZXQ7XG5cdH1cblxuXHRmb3IgKGNvbnN0IHBhcmFtIG9mIHF1ZXJ5LnNwbGl0KCcmJykpIHtcblx0XHRpZiAocGFyYW0gPT09ICcnKSB7XG5cdFx0XHRjb250aW51ZTtcblx0XHR9XG5cblx0XHRsZXQgW2tleSwgdmFsdWVdID0gc3BsaXRPbkZpcnN0KG9wdGlvbnMuZGVjb2RlID8gcGFyYW0ucmVwbGFjZSgvXFwrL2csICcgJykgOiBwYXJhbSwgJz0nKTtcblxuXHRcdC8vIE1pc3NpbmcgYD1gIHNob3VsZCBiZSBgbnVsbGA6XG5cdFx0Ly8gaHR0cDovL3czLm9yZy9UUi8yMDEyL1dELXVybC0yMDEyMDUyNC8jY29sbGVjdC11cmwtcGFyYW1ldGVyc1xuXHRcdHZhbHVlID0gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBbJ2NvbW1hJywgJ3NlcGFyYXRvcicsICdicmFja2V0LXNlcGFyYXRvciddLmluY2x1ZGVzKG9wdGlvbnMuYXJyYXlGb3JtYXQpID8gdmFsdWUgOiBkZWNvZGUodmFsdWUsIG9wdGlvbnMpO1xuXHRcdGZvcm1hdHRlcihkZWNvZGUoa2V5LCBvcHRpb25zKSwgdmFsdWUsIHJldCk7XG5cdH1cblxuXHRmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhyZXQpKSB7XG5cdFx0Y29uc3QgdmFsdWUgPSByZXRba2V5XTtcblx0XHRpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuXHRcdFx0Zm9yIChjb25zdCBrIG9mIE9iamVjdC5rZXlzKHZhbHVlKSkge1xuXHRcdFx0XHR2YWx1ZVtrXSA9IHBhcnNlVmFsdWUodmFsdWVba10sIG9wdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXRba2V5XSA9IHBhcnNlVmFsdWUodmFsdWUsIG9wdGlvbnMpO1xuXHRcdH1cblx0fVxuXG5cdGlmIChvcHRpb25zLnNvcnQgPT09IGZhbHNlKSB7XG5cdFx0cmV0dXJuIHJldDtcblx0fVxuXG5cdHJldHVybiAob3B0aW9ucy5zb3J0ID09PSB0cnVlID8gT2JqZWN0LmtleXMocmV0KS5zb3J0KCkgOiBPYmplY3Qua2V5cyhyZXQpLnNvcnQob3B0aW9ucy5zb3J0KSkucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xuXHRcdGNvbnN0IHZhbHVlID0gcmV0W2tleV07XG5cdFx0aWYgKEJvb2xlYW4odmFsdWUpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG5cdFx0XHQvLyBTb3J0IG9iamVjdCBrZXlzLCBub3QgdmFsdWVzXG5cdFx0XHRyZXN1bHRba2V5XSA9IGtleXNTb3J0ZXIodmFsdWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXN1bHRba2V5XSA9IHZhbHVlO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sIE9iamVjdC5jcmVhdGUobnVsbCkpO1xufVxuXG5leHBvcnRzLmV4dHJhY3QgPSBleHRyYWN0O1xuZXhwb3J0cy5wYXJzZSA9IHBhcnNlO1xuXG5leHBvcnRzLnN0cmluZ2lmeSA9IChvYmplY3QsIG9wdGlvbnMpID0+IHtcblx0aWYgKCFvYmplY3QpIHtcblx0XHRyZXR1cm4gJyc7XG5cdH1cblxuXHRvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG5cdFx0ZW5jb2RlOiB0cnVlLFxuXHRcdHN0cmljdDogdHJ1ZSxcblx0XHRhcnJheUZvcm1hdDogJ25vbmUnLFxuXHRcdGFycmF5Rm9ybWF0U2VwYXJhdG9yOiAnLCdcblx0fSwgb3B0aW9ucyk7XG5cblx0dmFsaWRhdGVBcnJheUZvcm1hdFNlcGFyYXRvcihvcHRpb25zLmFycmF5Rm9ybWF0U2VwYXJhdG9yKTtcblxuXHRjb25zdCBzaG91bGRGaWx0ZXIgPSBrZXkgPT4gKFxuXHRcdChvcHRpb25zLnNraXBOdWxsICYmIGlzTnVsbE9yVW5kZWZpbmVkKG9iamVjdFtrZXldKSkgfHxcblx0XHQob3B0aW9ucy5za2lwRW1wdHlTdHJpbmcgJiYgb2JqZWN0W2tleV0gPT09ICcnKVxuXHQpO1xuXG5cdGNvbnN0IGZvcm1hdHRlciA9IGVuY29kZXJGb3JBcnJheUZvcm1hdChvcHRpb25zKTtcblxuXHRjb25zdCBvYmplY3RDb3B5ID0ge307XG5cblx0Zm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMob2JqZWN0KSkge1xuXHRcdGlmICghc2hvdWxkRmlsdGVyKGtleSkpIHtcblx0XHRcdG9iamVjdENvcHlba2V5XSA9IG9iamVjdFtrZXldO1xuXHRcdH1cblx0fVxuXG5cdGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3RDb3B5KTtcblxuXHRpZiAob3B0aW9ucy5zb3J0ICE9PSBmYWxzZSkge1xuXHRcdGtleXMuc29ydChvcHRpb25zLnNvcnQpO1xuXHR9XG5cblx0cmV0dXJuIGtleXMubWFwKGtleSA9PiB7XG5cdFx0Y29uc3QgdmFsdWUgPSBvYmplY3Rba2V5XTtcblxuXHRcdGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRyZXR1cm4gJyc7XG5cdFx0fVxuXG5cdFx0aWYgKHZhbHVlID09PSBudWxsKSB7XG5cdFx0XHRyZXR1cm4gZW5jb2RlKGtleSwgb3B0aW9ucyk7XG5cdFx0fVxuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG5cdFx0XHRpZiAodmFsdWUubGVuZ3RoID09PSAwICYmIG9wdGlvbnMuYXJyYXlGb3JtYXQgPT09ICdicmFja2V0LXNlcGFyYXRvcicpIHtcblx0XHRcdFx0cmV0dXJuIGVuY29kZShrZXksIG9wdGlvbnMpICsgJ1tdJztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHZhbHVlXG5cdFx0XHRcdC5yZWR1Y2UoZm9ybWF0dGVyKGtleSksIFtdKVxuXHRcdFx0XHQuam9pbignJicpO1xuXHRcdH1cblxuXHRcdHJldHVybiBlbmNvZGUoa2V5LCBvcHRpb25zKSArICc9JyArIGVuY29kZSh2YWx1ZSwgb3B0aW9ucyk7XG5cdH0pLmZpbHRlcih4ID0+IHgubGVuZ3RoID4gMCkuam9pbignJicpO1xufTtcblxuZXhwb3J0cy5wYXJzZVVybCA9ICh1cmwsIG9wdGlvbnMpID0+IHtcblx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuXHRcdGRlY29kZTogdHJ1ZVxuXHR9LCBvcHRpb25zKTtcblxuXHRjb25zdCBbdXJsXywgaGFzaF0gPSBzcGxpdE9uRmlyc3QodXJsLCAnIycpO1xuXG5cdHJldHVybiBPYmplY3QuYXNzaWduKFxuXHRcdHtcblx0XHRcdHVybDogdXJsXy5zcGxpdCgnPycpWzBdIHx8ICcnLFxuXHRcdFx0cXVlcnk6IHBhcnNlKGV4dHJhY3QodXJsKSwgb3B0aW9ucylcblx0XHR9LFxuXHRcdG9wdGlvbnMgJiYgb3B0aW9ucy5wYXJzZUZyYWdtZW50SWRlbnRpZmllciAmJiBoYXNoID8ge2ZyYWdtZW50SWRlbnRpZmllcjogZGVjb2RlKGhhc2gsIG9wdGlvbnMpfSA6IHt9XG5cdCk7XG59O1xuXG5leHBvcnRzLnN0cmluZ2lmeVVybCA9IChvYmplY3QsIG9wdGlvbnMpID0+IHtcblx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuXHRcdGVuY29kZTogdHJ1ZSxcblx0XHRzdHJpY3Q6IHRydWUsXG5cdFx0W2VuY29kZUZyYWdtZW50SWRlbnRpZmllcl06IHRydWVcblx0fSwgb3B0aW9ucyk7XG5cblx0Y29uc3QgdXJsID0gcmVtb3ZlSGFzaChvYmplY3QudXJsKS5zcGxpdCgnPycpWzBdIHx8ICcnO1xuXHRjb25zdCBxdWVyeUZyb21VcmwgPSBleHBvcnRzLmV4dHJhY3Qob2JqZWN0LnVybCk7XG5cdGNvbnN0IHBhcnNlZFF1ZXJ5RnJvbVVybCA9IGV4cG9ydHMucGFyc2UocXVlcnlGcm9tVXJsLCB7c29ydDogZmFsc2V9KTtcblxuXHRjb25zdCBxdWVyeSA9IE9iamVjdC5hc3NpZ24ocGFyc2VkUXVlcnlGcm9tVXJsLCBvYmplY3QucXVlcnkpO1xuXHRsZXQgcXVlcnlTdHJpbmcgPSBleHBvcnRzLnN0cmluZ2lmeShxdWVyeSwgb3B0aW9ucyk7XG5cdGlmIChxdWVyeVN0cmluZykge1xuXHRcdHF1ZXJ5U3RyaW5nID0gYD8ke3F1ZXJ5U3RyaW5nfWA7XG5cdH1cblxuXHRsZXQgaGFzaCA9IGdldEhhc2gob2JqZWN0LnVybCk7XG5cdGlmIChvYmplY3QuZnJhZ21lbnRJZGVudGlmaWVyKSB7XG5cdFx0aGFzaCA9IGAjJHtvcHRpb25zW2VuY29kZUZyYWdtZW50SWRlbnRpZmllcl0gPyBlbmNvZGUob2JqZWN0LmZyYWdtZW50SWRlbnRpZmllciwgb3B0aW9ucykgOiBvYmplY3QuZnJhZ21lbnRJZGVudGlmaWVyfWA7XG5cdH1cblxuXHRyZXR1cm4gYCR7dXJsfSR7cXVlcnlTdHJpbmd9JHtoYXNofWA7XG59O1xuXG5leHBvcnRzLnBpY2sgPSAoaW5wdXQsIGZpbHRlciwgb3B0aW9ucykgPT4ge1xuXHRvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG5cdFx0cGFyc2VGcmFnbWVudElkZW50aWZpZXI6IHRydWUsXG5cdFx0W2VuY29kZUZyYWdtZW50SWRlbnRpZmllcl06IGZhbHNlXG5cdH0sIG9wdGlvbnMpO1xuXG5cdGNvbnN0IHt1cmwsIHF1ZXJ5LCBmcmFnbWVudElkZW50aWZpZXJ9ID0gZXhwb3J0cy5wYXJzZVVybChpbnB1dCwgb3B0aW9ucyk7XG5cdHJldHVybiBleHBvcnRzLnN0cmluZ2lmeVVybCh7XG5cdFx0dXJsLFxuXHRcdHF1ZXJ5OiBmaWx0ZXJPYmplY3QocXVlcnksIGZpbHRlciksXG5cdFx0ZnJhZ21lbnRJZGVudGlmaWVyXG5cdH0sIG9wdGlvbnMpO1xufTtcblxuZXhwb3J0cy5leGNsdWRlID0gKGlucHV0LCBmaWx0ZXIsIG9wdGlvbnMpID0+IHtcblx0Y29uc3QgZXhjbHVzaW9uRmlsdGVyID0gQXJyYXkuaXNBcnJheShmaWx0ZXIpID8ga2V5ID0+ICFmaWx0ZXIuaW5jbHVkZXMoa2V5KSA6IChrZXksIHZhbHVlKSA9PiAhZmlsdGVyKGtleSwgdmFsdWUpO1xuXG5cdHJldHVybiBleHBvcnRzLnBpY2soaW5wdXQsIGV4Y2x1c2lvbkZpbHRlciwgb3B0aW9ucyk7XG59O1xuIl19