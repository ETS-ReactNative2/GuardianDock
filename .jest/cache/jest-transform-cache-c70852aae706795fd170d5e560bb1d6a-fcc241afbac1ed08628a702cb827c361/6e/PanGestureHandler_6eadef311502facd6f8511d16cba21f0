418597206c557b3b066ca548a5f9ac22
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.managePanProps = managePanProps;
exports.PanGestureHandler = exports.panHandlerName = exports.panGestureHandlerCustomNativeProps = exports.panGestureHandlerProps = void 0;

var _createHandler = _interopRequireDefault(require("./createHandler"));

var _gestureHandlerCommon = require("./gestureHandlerCommon");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var panGestureHandlerProps = ['activeOffsetY', 'activeOffsetX', 'failOffsetY', 'failOffsetX', 'minDist', 'minVelocity', 'minVelocityX', 'minVelocityY', 'minPointers', 'maxPointers', 'avgTouches', 'enableTrackpadTwoFingerGesture'];
exports.panGestureHandlerProps = panGestureHandlerProps;
var panGestureHandlerCustomNativeProps = ['activeOffsetYStart', 'activeOffsetYEnd', 'activeOffsetXStart', 'activeOffsetXEnd', 'failOffsetYStart', 'failOffsetYEnd', 'failOffsetXStart', 'failOffsetXEnd'];
exports.panGestureHandlerCustomNativeProps = panGestureHandlerCustomNativeProps;
var panHandlerName = 'PanGestureHandler';
exports.panHandlerName = panHandlerName;
var PanGestureHandler = (0, _createHandler.default)({
  name: panHandlerName,
  allowedProps: [].concat((0, _toConsumableArray2.default)(_gestureHandlerCommon.baseGestureHandlerProps), panGestureHandlerProps),
  config: {},
  transformProps: managePanProps,
  customNativeProps: panGestureHandlerCustomNativeProps
});
exports.PanGestureHandler = PanGestureHandler;

function validatePanGestureHandlerProps(props) {
  if (Array.isArray(props.activeOffsetX) && (props.activeOffsetX[0] > 0 || props.activeOffsetX[1] < 0)) {
    throw new Error("First element of activeOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.activeOffsetY) && (props.activeOffsetY[0] > 0 || props.activeOffsetY[1] < 0)) {
    throw new Error("First element of activeOffsetY should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetX) && (props.failOffsetX[0] > 0 || props.failOffsetX[1] < 0)) {
    throw new Error("First element of failOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetY) && (props.failOffsetY[0] > 0 || props.failOffsetY[1] < 0)) {
    throw new Error("First element of failOffsetY should be negative, a the second one should be positive");
  }

  if (props.minDist && (props.failOffsetX || props.failOffsetY)) {
    throw new Error("It is not supported to use minDist with failOffsetX or failOffsetY, use activeOffsetX and activeOffsetY instead");
  }

  if (props.minDist && (props.activeOffsetX || props.activeOffsetY)) {
    throw new Error("It is not supported to use minDist with activeOffsetX or activeOffsetY");
  }
}

function transformPanGestureHandlerProps(props) {
  var res = (0, _extends2.default)({}, props);

  if (props.activeOffsetX !== undefined) {
    delete res.activeOffsetX;

    if (Array.isArray(props.activeOffsetX)) {
      res.activeOffsetXStart = props.activeOffsetX[0];
      res.activeOffsetXEnd = props.activeOffsetX[1];
    } else if (props.activeOffsetX < 0) {
      res.activeOffsetXStart = props.activeOffsetX;
    } else {
      res.activeOffsetXEnd = props.activeOffsetX;
    }
  }

  if (props.activeOffsetY !== undefined) {
    delete res.activeOffsetY;

    if (Array.isArray(props.activeOffsetY)) {
      res.activeOffsetYStart = props.activeOffsetY[0];
      res.activeOffsetYEnd = props.activeOffsetY[1];
    } else if (props.activeOffsetY < 0) {
      res.activeOffsetYStart = props.activeOffsetY;
    } else {
      res.activeOffsetYEnd = props.activeOffsetY;
    }
  }

  if (props.failOffsetX !== undefined) {
    delete res.failOffsetX;

    if (Array.isArray(props.failOffsetX)) {
      res.failOffsetXStart = props.failOffsetX[0];
      res.failOffsetXEnd = props.failOffsetX[1];
    } else if (props.failOffsetX < 0) {
      res.failOffsetXStart = props.failOffsetX;
    } else {
      res.failOffsetXEnd = props.failOffsetX;
    }
  }

  if (props.failOffsetY !== undefined) {
    delete res.failOffsetY;

    if (Array.isArray(props.failOffsetY)) {
      res.failOffsetYStart = props.failOffsetY[0];
      res.failOffsetYEnd = props.failOffsetY[1];
    } else if (props.failOffsetY < 0) {
      res.failOffsetYStart = props.failOffsetY;
    } else {
      res.failOffsetYEnd = props.failOffsetY;
    }
  }

  return res;
}

function managePanProps(props) {
  if (__DEV__) {
    validatePanGestureHandlerProps(props);
  }

  return transformPanGestureHandlerProps(props);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUJEO0FBQ0Q7O0FBQ0QsU0FBT1UsK0JBQStCLENBQUNULEtBQUQsQ0FBdEM7QUFDRCIsIm5hbWVzIjpbInBhbkdlc3R1cmVIYW5kbGVyUHJvcHMiLCJwYW5HZXN0dXJlSGFuZGxlckN1c3RvbU5hdGl2ZVByb3BzIiwicGFuSGFuZGxlck5hbWUiLCJQYW5HZXN0dXJlSGFuZGxlciIsIm5hbWUiLCJhbGxvd2VkUHJvcHMiLCJiYXNlR2VzdHVyZUhhbmRsZXJQcm9wcyIsImNvbmZpZyIsInRyYW5zZm9ybVByb3BzIiwibWFuYWdlUGFuUHJvcHMiLCJjdXN0b21OYXRpdmVQcm9wcyIsInZhbGlkYXRlUGFuR2VzdHVyZUhhbmRsZXJQcm9wcyIsInByb3BzIiwiQXJyYXkiLCJpc0FycmF5IiwiYWN0aXZlT2Zmc2V0WCIsIkVycm9yIiwiYWN0aXZlT2Zmc2V0WSIsImZhaWxPZmZzZXRYIiwiZmFpbE9mZnNldFkiLCJtaW5EaXN0IiwidHJhbnNmb3JtUGFuR2VzdHVyZUhhbmRsZXJQcm9wcyIsInJlcyIsInVuZGVmaW5lZCIsImFjdGl2ZU9mZnNldFhTdGFydCIsImFjdGl2ZU9mZnNldFhFbmQiLCJhY3RpdmVPZmZzZXRZU3RhcnQiLCJhY3RpdmVPZmZzZXRZRW5kIiwiZmFpbE9mZnNldFhTdGFydCIsImZhaWxPZmZzZXRYRW5kIiwiZmFpbE9mZnNldFlTdGFydCIsImZhaWxPZmZzZXRZRW5kIiwiX19ERVZfXyJdLCJzb3VyY2VzIjpbIlBhbkdlc3R1cmVIYW5kbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVIYW5kbGVyIGZyb20gJy4vY3JlYXRlSGFuZGxlcic7XG5pbXBvcnQge1xuICBCYXNlR2VzdHVyZUhhbmRsZXJQcm9wcyxcbiAgYmFzZUdlc3R1cmVIYW5kbGVyUHJvcHMsXG59IGZyb20gJy4vZ2VzdHVyZUhhbmRsZXJDb21tb24nO1xuXG5leHBvcnQgY29uc3QgcGFuR2VzdHVyZUhhbmRsZXJQcm9wcyA9IFtcbiAgJ2FjdGl2ZU9mZnNldFknLFxuICAnYWN0aXZlT2Zmc2V0WCcsXG4gICdmYWlsT2Zmc2V0WScsXG4gICdmYWlsT2Zmc2V0WCcsXG4gICdtaW5EaXN0JyxcbiAgJ21pblZlbG9jaXR5JyxcbiAgJ21pblZlbG9jaXR5WCcsXG4gICdtaW5WZWxvY2l0eVknLFxuICAnbWluUG9pbnRlcnMnLFxuICAnbWF4UG9pbnRlcnMnLFxuICAnYXZnVG91Y2hlcycsXG4gICdlbmFibGVUcmFja3BhZFR3b0Zpbmdlckdlc3R1cmUnLFxuXSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IHBhbkdlc3R1cmVIYW5kbGVyQ3VzdG9tTmF0aXZlUHJvcHMgPSBbXG4gICdhY3RpdmVPZmZzZXRZU3RhcnQnLFxuICAnYWN0aXZlT2Zmc2V0WUVuZCcsXG4gICdhY3RpdmVPZmZzZXRYU3RhcnQnLFxuICAnYWN0aXZlT2Zmc2V0WEVuZCcsXG4gICdmYWlsT2Zmc2V0WVN0YXJ0JyxcbiAgJ2ZhaWxPZmZzZXRZRW5kJyxcbiAgJ2ZhaWxPZmZzZXRYU3RhcnQnLFxuICAnZmFpbE9mZnNldFhFbmQnLFxuXSBhcyBjb25zdDtcblxuZXhwb3J0IHR5cGUgUGFuR2VzdHVyZUhhbmRsZXJFdmVudFBheWxvYWQgPSB7XG4gIC8qKlxuICAgKiBYIGNvb3JkaW5hdGUgb2YgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHBvaW50ZXIgKGZpbmdlciBvciBhIGxlYWRpbmdcbiAgICogcG9pbnRlciB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBmaW5nZXJzIHBsYWNlZCkgcmVsYXRpdmUgdG8gdGhlIHZpZXdcbiAgICogYXR0YWNoZWQgdG8gdGhlIGhhbmRsZXIuIEV4cHJlc3NlZCBpbiBwb2ludCB1bml0cy5cbiAgICovXG4gIHg6IG51bWJlcjtcblxuICAvKipcbiAgICogWSBjb29yZGluYXRlIG9mIHRoZSBjdXJyZW50IHBvc2l0aW9uIG9mIHRoZSBwb2ludGVyIChmaW5nZXIgb3IgYSBsZWFkaW5nXG4gICAqIHBvaW50ZXIgd2hlbiB0aGVyZSBhcmUgbXVsdGlwbGUgZmluZ2VycyBwbGFjZWQpIHJlbGF0aXZlIHRvIHRoZSB2aWV3XG4gICAqIGF0dGFjaGVkIHRvIHRoZSBoYW5kbGVyLiBFeHByZXNzZWQgaW4gcG9pbnQgdW5pdHMuXG4gICAqL1xuICB5OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFggY29vcmRpbmF0ZSBvZiB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgcG9pbnRlciAoZmluZ2VyIG9yIGEgbGVhZGluZ1xuICAgKiBwb2ludGVyIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGZpbmdlcnMgcGxhY2VkKSByZWxhdGl2ZSB0byB0aGUgd2luZG93LlxuICAgKiBUaGUgdmFsdWUgaXMgZXhwcmVzc2VkIGluIHBvaW50IHVuaXRzLiBJdCBpcyByZWNvbW1lbmRlZCB0byB1c2UgaXQgaW5zdGVhZFxuICAgKiBvZiBgeGAgaW4gY2FzZXMgd2hlbiB0aGUgb3JpZ2luYWwgdmlldyBjYW4gYmUgdHJhbnNmb3JtZWQgYXMgYW4gZWZmZWN0IG9mXG4gICAqIHRoZSBnZXN0dXJlLlxuICAgKi9cbiAgYWJzb2x1dGVYOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFkgY29vcmRpbmF0ZSBvZiB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgcG9pbnRlciAoZmluZ2VyIG9yIGEgbGVhZGluZ1xuICAgKiBwb2ludGVyIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGZpbmdlcnMgcGxhY2VkKSByZWxhdGl2ZSB0byB0aGUgd2luZG93LlxuICAgKiBUaGUgdmFsdWUgaXMgZXhwcmVzc2VkIGluIHBvaW50IHVuaXRzLiBJdCBpcyByZWNvbW1lbmRlZCB0byB1c2UgaXQgaW5zdGVhZFxuICAgKiBvZiBgeWAgaW4gY2FzZXMgd2hlbiB0aGUgb3JpZ2luYWwgdmlldyBjYW4gYmUgdHJhbnNmb3JtZWQgYXMgYW5cbiAgICogZWZmZWN0IG9mIHRoZSBnZXN0dXJlLlxuICAgKi9cbiAgYWJzb2x1dGVZOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRyYW5zbGF0aW9uIG9mIHRoZSBwYW4gZ2VzdHVyZSBhbG9uZyBYIGF4aXMgYWNjdW11bGF0ZWQgb3ZlciB0aGUgdGltZSBvZlxuICAgKiB0aGUgZ2VzdHVyZS4gVGhlIHZhbHVlIGlzIGV4cHJlc3NlZCBpbiB0aGUgcG9pbnQgdW5pdHMuXG4gICAqL1xuICB0cmFuc2xhdGlvblg6IG51bWJlcjtcblxuICAvKipcbiAgICogVHJhbnNsYXRpb24gb2YgdGhlIHBhbiBnZXN0dXJlIGFsb25nIFkgYXhpcyBhY2N1bXVsYXRlZCBvdmVyIHRoZSB0aW1lIG9mXG4gICAqIHRoZSBnZXN0dXJlLiBUaGUgdmFsdWUgaXMgZXhwcmVzc2VkIGluIHRoZSBwb2ludCB1bml0cy5cbiAgICovXG4gIHRyYW5zbGF0aW9uWTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBWZWxvY2l0eSBvZiB0aGUgcGFuIGdlc3R1cmUgYWxvbmcgdGhlIFggYXhpcyBpbiB0aGUgY3VycmVudCBtb21lbnQuIFRoZVxuICAgKiB2YWx1ZSBpcyBleHByZXNzZWQgaW4gcG9pbnQgdW5pdHMgcGVyIHNlY29uZC5cbiAgICovXG4gIHZlbG9jaXR5WDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBWZWxvY2l0eSBvZiB0aGUgcGFuIGdlc3R1cmUgYWxvbmcgdGhlIFkgYXhpcyBpbiB0aGUgY3VycmVudCBtb21lbnQuIFRoZVxuICAgKiB2YWx1ZSBpcyBleHByZXNzZWQgaW4gcG9pbnQgdW5pdHMgcGVyIHNlY29uZC5cbiAgICovXG4gIHZlbG9jaXR5WTogbnVtYmVyO1xufTtcblxuaW50ZXJmYWNlIENvbW1vblBhblByb3BlcnRpZXMge1xuICAvKipcbiAgICogTWluaW11bSBkaXN0YW5jZSB0aGUgZmluZ2VyIChvciBtdWx0aXBsZSBmaW5nZXIpIG5lZWQgdG8gdHJhdmVsIGJlZm9yZSB0aGVcbiAgICogaGFuZGxlciBhY3RpdmF0ZXMuIEV4cHJlc3NlZCBpbiBwb2ludHMuXG4gICAqL1xuICBtaW5EaXN0PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBBbmRyb2lkIG9ubHkuXG4gICAqL1xuICBhdmdUb3VjaGVzPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRW5hYmxlcyB0d28tZmluZ2VyIGdlc3R1cmVzIG9uIHN1cHBvcnRlZCBkZXZpY2VzLCBmb3IgZXhhbXBsZSBpUGFkcyB3aXRoXG4gICAqIHRyYWNrcGFkcy4gSWYgbm90IGVuYWJsZWQgdGhlIGdlc3R1cmUgd2lsbCByZXF1aXJlIGNsaWNrICsgZHJhZywgd2l0aFxuICAgKiBlbmFibGVUcmFja3BhZFR3b0Zpbmdlckdlc3R1cmUgc3dpcGluZyB3aXRoIHR3byBmaW5nZXJzIHdpbGwgYWxzbyB0cmlnZ2VyXG4gICAqIHRoZSBnZXN0dXJlLlxuICAgKi9cbiAgZW5hYmxlVHJhY2twYWRUd29GaW5nZXJHZXN0dXJlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQSBudW1iZXIgb2YgZmluZ2VycyB0aGF0IGlzIHJlcXVpcmVkIHRvIGJlIHBsYWNlZCBiZWZvcmUgaGFuZGxlciBjYW5cbiAgICogYWN0aXZhdGUuIFNob3VsZCBiZSBhIGhpZ2hlciBvciBlcXVhbCB0byAwIGludGVnZXIuXG4gICAqL1xuICBtaW5Qb2ludGVycz86IG51bWJlcjtcblxuICAvKipcbiAgICogV2hlbiB0aGUgZ2l2ZW4gbnVtYmVyIG9mIGZpbmdlcnMgaXMgcGxhY2VkIG9uIHRoZSBzY3JlZW4gYW5kIGhhbmRsZXIgaGFzbid0XG4gICAqIHlldCBhY3RpdmF0ZWQgaXQgd2lsbCBmYWlsIHJlY29nbml6aW5nIHRoZSBnZXN0dXJlLiBTaG91bGQgYmUgYSBoaWdoZXIgb3JcbiAgICogZXF1YWwgdG8gMCBpbnRlZ2VyLlxuICAgKi9cbiAgbWF4UG9pbnRlcnM/OiBudW1iZXI7XG5cbiAgbWluVmVsb2NpdHk/OiBudW1iZXI7XG4gIG1pblZlbG9jaXR5WD86IG51bWJlcjtcbiAgbWluVmVsb2NpdHlZPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhbkdlc3R1cmVDb25maWcgZXh0ZW5kcyBDb21tb25QYW5Qcm9wZXJ0aWVzIHtcbiAgYWN0aXZlT2Zmc2V0WVN0YXJ0PzogbnVtYmVyO1xuICBhY3RpdmVPZmZzZXRZRW5kPzogbnVtYmVyO1xuICBhY3RpdmVPZmZzZXRYU3RhcnQ/OiBudW1iZXI7XG4gIGFjdGl2ZU9mZnNldFhFbmQ/OiBudW1iZXI7XG4gIGZhaWxPZmZzZXRZU3RhcnQ/OiBudW1iZXI7XG4gIGZhaWxPZmZzZXRZRW5kPzogbnVtYmVyO1xuICBmYWlsT2Zmc2V0WFN0YXJ0PzogbnVtYmVyO1xuICBmYWlsT2Zmc2V0WEVuZD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYW5HZXN0dXJlSGFuZGxlclByb3BzXG4gIGV4dGVuZHMgQmFzZUdlc3R1cmVIYW5kbGVyUHJvcHM8UGFuR2VzdHVyZUhhbmRsZXJFdmVudFBheWxvYWQ+LFxuICAgIENvbW1vblBhblByb3BlcnRpZXMge1xuICAvKipcbiAgICogUmFuZ2UgYWxvbmcgWCBheGlzIChpbiBwb2ludHMpIHdoZXJlIGZpbmdlcnMgdHJhdmVscyB3aXRob3V0IGFjdGl2YXRpb24gb2ZcbiAgICogaGFuZGxlci4gTW92aW5nIG91dHNpZGUgb2YgdGhpcyByYW5nZSBpbXBsaWVzIGFjdGl2YXRpb24gb2YgaGFuZGxlci4gUmFuZ2VcbiAgICogY2FuIGJlIGdpdmVuIGFzIGFuIGFycmF5IG9yIGEgc2luZ2xlIG51bWJlci4gSWYgcmFuZ2UgaXMgc2V0IGFzIGFuIGFycmF5LFxuICAgKiBmaXJzdCB2YWx1ZSBtdXN0IGJlIGxvd2VyIG9yIGVxdWFsIHRvIDAsIGEgdGhlIHNlY29uZCBvbmUgaGlnaGVyIG9yIGVxdWFsXG4gICAqIHRvIDAuIElmIG9ubHkgb25lIG51bWJlciBgcGAgaXMgZ2l2ZW4gYSByYW5nZSBvZiBgKC1pbmYsIHApYCB3aWxsIGJlIHVzZWRcbiAgICogaWYgYHBgIGlzIGhpZ2hlciBvciBlcXVhbCB0byAwIGFuZCBgKC1wLCBpbmYpYCBvdGhlcndpc2UuXG4gICAqL1xuICBhY3RpdmVPZmZzZXRZPzogbnVtYmVyIHwgbnVtYmVyW107XG5cbiAgLyoqXG4gICAqIFJhbmdlIGFsb25nIFggYXhpcyAoaW4gcG9pbnRzKSB3aGVyZSBmaW5nZXJzIHRyYXZlbHMgd2l0aG91dCBhY3RpdmF0aW9uIG9mXG4gICAqIGhhbmRsZXIuIE1vdmluZyBvdXRzaWRlIG9mIHRoaXMgcmFuZ2UgaW1wbGllcyBhY3RpdmF0aW9uIG9mIGhhbmRsZXIuIFJhbmdlXG4gICAqIGNhbiBiZSBnaXZlbiBhcyBhbiBhcnJheSBvciBhIHNpbmdsZSBudW1iZXIuIElmIHJhbmdlIGlzIHNldCBhcyBhbiBhcnJheSxcbiAgICogZmlyc3QgdmFsdWUgbXVzdCBiZSBsb3dlciBvciBlcXVhbCB0byAwLCBhIHRoZSBzZWNvbmQgb25lIGhpZ2hlciBvciBlcXVhbFxuICAgKiB0byAwLiBJZiBvbmx5IG9uZSBudW1iZXIgYHBgIGlzIGdpdmVuIGEgcmFuZ2Ugb2YgYCgtaW5mLCBwKWAgd2lsbCBiZSB1c2VkXG4gICAqIGlmIGBwYCBpcyBoaWdoZXIgb3IgZXF1YWwgdG8gMCBhbmQgYCgtcCwgaW5mKWAgb3RoZXJ3aXNlLlxuICAgKi9cbiAgYWN0aXZlT2Zmc2V0WD86IG51bWJlciB8IG51bWJlcltdO1xuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSBmaW5nZXIgbW92ZXMgb3V0c2lkZSB0aGlzIHJhbmdlIChpbiBwb2ludHMpIGFsb25nIFkgYXhpcyBhbmRcbiAgICogaGFuZGxlciBoYXNuJ3QgeWV0IGFjdGl2YXRlZCBpdCB3aWxsIGZhaWwgcmVjb2duaXppbmcgdGhlIGdlc3R1cmUuIFJhbmdlXG4gICAqIGNhbiBiZSBnaXZlbiBhcyBhbiBhcnJheSBvciBhIHNpbmdsZSBudW1iZXIuIElmIHJhbmdlIGlzIHNldCBhcyBhbiBhcnJheSxcbiAgICogZmlyc3QgdmFsdWUgbXVzdCBiZSBsb3dlciBvciBlcXVhbCB0byAwLCBhIHRoZSBzZWNvbmQgb25lIGhpZ2hlciBvciBlcXVhbFxuICAgKiB0byAwLiBJZiBvbmx5IG9uZSBudW1iZXIgYHBgIGlzIGdpdmVuIGEgcmFuZ2Ugb2YgYCgtaW5mLCBwKWAgd2lsbCBiZSB1c2VkXG4gICAqIGlmIGBwYCBpcyBoaWdoZXIgb3IgZXF1YWwgdG8gMCBhbmQgYCgtcCwgaW5mKWAgb3RoZXJ3aXNlLlxuICAgKi9cbiAgZmFpbE9mZnNldFk/OiBudW1iZXIgfCBudW1iZXJbXTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgZmluZ2VyIG1vdmVzIG91dHNpZGUgdGhpcyByYW5nZSAoaW4gcG9pbnRzKSBhbG9uZyBYIGF4aXMgYW5kXG4gICAqIGhhbmRsZXIgaGFzbid0IHlldCBhY3RpdmF0ZWQgaXQgd2lsbCBmYWlsIHJlY29nbml6aW5nIHRoZSBnZXN0dXJlLiBSYW5nZVxuICAgKiBjYW4gYmUgZ2l2ZW4gYXMgYW4gYXJyYXkgb3IgYSBzaW5nbGUgbnVtYmVyLiBJZiByYW5nZSBpcyBzZXQgYXMgYW4gYXJyYXksXG4gICAqIGZpcnN0IHZhbHVlIG11c3QgYmUgbG93ZXIgb3IgZXF1YWwgdG8gMCwgYSB0aGUgc2Vjb25kIG9uZSBoaWdoZXIgb3IgZXF1YWxcbiAgICogdG8gMC4gSWYgb25seSBvbmUgbnVtYmVyIGBwYCBpcyBnaXZlbiBhIHJhbmdlIG9mIGAoLWluZiwgcClgIHdpbGwgYmUgdXNlZFxuICAgKiBpZiBgcGAgaXMgaGlnaGVyIG9yIGVxdWFsIHRvIDAgYW5kIGAoLXAsIGluZilgIG90aGVyd2lzZS5cbiAgICovXG4gIGZhaWxPZmZzZXRYPzogbnVtYmVyIHwgbnVtYmVyW107XG59XG5cbmV4cG9ydCBjb25zdCBwYW5IYW5kbGVyTmFtZSA9ICdQYW5HZXN0dXJlSGFuZGxlcic7XG5cbmV4cG9ydCB0eXBlIFBhbkdlc3R1cmVIYW5kbGVyID0gdHlwZW9mIFBhbkdlc3R1cmVIYW5kbGVyO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZWRlY2xhcmUgLS0gYmFja3dhcmQgY29tcGF0aWJpbGl0eTsgc2VlIGRlc2NyaXB0aW9uIG9uIHRoZSB0b3Agb2YgZ2VzdHVyZUhhbmRsZXJDb21tb24udHMgZmlsZVxuZXhwb3J0IGNvbnN0IFBhbkdlc3R1cmVIYW5kbGVyID0gY3JlYXRlSGFuZGxlcjxcbiAgUGFuR2VzdHVyZUhhbmRsZXJQcm9wcyxcbiAgUGFuR2VzdHVyZUhhbmRsZXJFdmVudFBheWxvYWRcbj4oe1xuICBuYW1lOiBwYW5IYW5kbGVyTmFtZSxcbiAgYWxsb3dlZFByb3BzOiBbXG4gICAgLi4uYmFzZUdlc3R1cmVIYW5kbGVyUHJvcHMsXG4gICAgLi4ucGFuR2VzdHVyZUhhbmRsZXJQcm9wcyxcbiAgXSBhcyBjb25zdCxcbiAgY29uZmlnOiB7fSxcbiAgdHJhbnNmb3JtUHJvcHM6IG1hbmFnZVBhblByb3BzLFxuICBjdXN0b21OYXRpdmVQcm9wczogcGFuR2VzdHVyZUhhbmRsZXJDdXN0b21OYXRpdmVQcm9wcyxcbn0pO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuYWN0aXZlT2Zmc2V0WCkgJiZcbiAgICAocHJvcHMuYWN0aXZlT2Zmc2V0WFswXSA+IDAgfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WFsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGFjdGl2ZU9mZnNldFggc2hvdWxkIGJlIG5lZ2F0aXZlLCBhIHRoZSBzZWNvbmQgb25lIHNob3VsZCBiZSBwb3NpdGl2ZWBcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuYWN0aXZlT2Zmc2V0WSkgJiZcbiAgICAocHJvcHMuYWN0aXZlT2Zmc2V0WVswXSA+IDAgfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WVsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGFjdGl2ZU9mZnNldFkgc2hvdWxkIGJlIG5lZ2F0aXZlLCBhIHRoZSBzZWNvbmQgb25lIHNob3VsZCBiZSBwb3NpdGl2ZWBcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuZmFpbE9mZnNldFgpICYmXG4gICAgKHByb3BzLmZhaWxPZmZzZXRYWzBdID4gMCB8fCBwcm9wcy5mYWlsT2Zmc2V0WFsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGZhaWxPZmZzZXRYIHNob3VsZCBiZSBuZWdhdGl2ZSwgYSB0aGUgc2Vjb25kIG9uZSBzaG91bGQgYmUgcG9zaXRpdmVgXG4gICAgKTtcbiAgfVxuXG4gIGlmIChcbiAgICBBcnJheS5pc0FycmF5KHByb3BzLmZhaWxPZmZzZXRZKSAmJlxuICAgIChwcm9wcy5mYWlsT2Zmc2V0WVswXSA+IDAgfHwgcHJvcHMuZmFpbE9mZnNldFlbMV0gPCAwKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgRmlyc3QgZWxlbWVudCBvZiBmYWlsT2Zmc2V0WSBzaG91bGQgYmUgbmVnYXRpdmUsIGEgdGhlIHNlY29uZCBvbmUgc2hvdWxkIGJlIHBvc2l0aXZlYFxuICAgICk7XG4gIH1cblxuICBpZiAocHJvcHMubWluRGlzdCAmJiAocHJvcHMuZmFpbE9mZnNldFggfHwgcHJvcHMuZmFpbE9mZnNldFkpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEl0IGlzIG5vdCBzdXBwb3J0ZWQgdG8gdXNlIG1pbkRpc3Qgd2l0aCBmYWlsT2Zmc2V0WCBvciBmYWlsT2Zmc2V0WSwgdXNlIGFjdGl2ZU9mZnNldFggYW5kIGFjdGl2ZU9mZnNldFkgaW5zdGVhZGBcbiAgICApO1xuICB9XG5cbiAgaWYgKHByb3BzLm1pbkRpc3QgJiYgKHByb3BzLmFjdGl2ZU9mZnNldFggfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgSXQgaXMgbm90IHN1cHBvcnRlZCB0byB1c2UgbWluRGlzdCB3aXRoIGFjdGl2ZU9mZnNldFggb3IgYWN0aXZlT2Zmc2V0WWBcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgdHlwZSBJbnRlcm5hbFBhbkdIS2V5cyA9XG4gICAgfCAnYWN0aXZlT2Zmc2V0WFN0YXJ0J1xuICAgIHwgJ2FjdGl2ZU9mZnNldFhFbmQnXG4gICAgfCAnZmFpbE9mZnNldFhTdGFydCdcbiAgICB8ICdmYWlsT2Zmc2V0WEVuZCdcbiAgICB8ICdhY3RpdmVPZmZzZXRZU3RhcnQnXG4gICAgfCAnYWN0aXZlT2Zmc2V0WUVuZCdcbiAgICB8ICdmYWlsT2Zmc2V0WVN0YXJ0J1xuICAgIHwgJ2ZhaWxPZmZzZXRZRW5kJztcbiAgdHlwZSBQYW5HZXN0dXJlSGFuZGxlckludGVybmFsUHJvcHMgPSBQYW5HZXN0dXJlSGFuZGxlclByb3BzICZcbiAgICBQYXJ0aWFsPFJlY29yZDxJbnRlcm5hbFBhbkdIS2V5cywgbnVtYmVyPj47XG5cbiAgY29uc3QgcmVzOiBQYW5HZXN0dXJlSGFuZGxlckludGVybmFsUHJvcHMgPSB7IC4uLnByb3BzIH07XG5cbiAgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFggIT09IHVuZGVmaW5lZCkge1xuICAgIGRlbGV0ZSByZXMuYWN0aXZlT2Zmc2V0WDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5hY3RpdmVPZmZzZXRYKSkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMF07XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WEVuZCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMV07XG4gICAgfSBlbHNlIGlmIChwcm9wcy5hY3RpdmVPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRYRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WDtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMuYWN0aXZlT2Zmc2V0WSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlcy5hY3RpdmVPZmZzZXRZO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmFjdGl2ZU9mZnNldFkpKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRZRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFlFbmQgPSBwcm9wcy5hY3RpdmVPZmZzZXRZO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5mYWlsT2Zmc2V0WCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlcy5mYWlsT2Zmc2V0WDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5mYWlsT2Zmc2V0WCkpIHtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WFN0YXJ0ID0gcHJvcHMuZmFpbE9mZnNldFhbMF07XG4gICAgICByZXMuZmFpbE9mZnNldFhFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WFsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmZhaWxPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYRW5kID0gcHJvcHMuZmFpbE9mZnNldFg7XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLmZhaWxPZmZzZXRZICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWxldGUgcmVzLmZhaWxPZmZzZXRZO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmZhaWxPZmZzZXRZKSkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRZU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WUVuZCA9IHByb3BzLmZhaWxPZmZzZXRZWzFdO1xuICAgIH0gZWxzZSBpZiAocHJvcHMuZmFpbE9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlTdGFydCA9IHByb3BzLmZhaWxPZmZzZXRZO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFuYWdlUGFuUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgaWYgKF9fREVWX18pIHtcbiAgICB2YWxpZGF0ZVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHMpO1xuICB9XG4gIHJldHVybiB0cmFuc2Zvcm1QYW5HZXN0dXJlSGFuZGxlclByb3BzKHByb3BzKTtcbn1cbiJdfQ==