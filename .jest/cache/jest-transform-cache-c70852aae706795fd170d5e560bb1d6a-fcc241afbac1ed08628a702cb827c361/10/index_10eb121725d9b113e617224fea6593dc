13a9ea72d88f918673c32e2d1822a575
var colorNames = require('color-name');

var swizzle = require('simple-swizzle');

var hasOwnProperty = Object.hasOwnProperty;
var reverseNames = {};

for (var name in colorNames) {
  if (hasOwnProperty.call(colorNames, name)) {
    reverseNames[colorNames[name]] = name;
  }
}

var cs = module.exports = {
  to: {},
  get: {}
};

cs.get = function (string) {
  var prefix = string.substring(0, 3).toLowerCase();
  var val;
  var model;

  switch (prefix) {
    case 'hsl':
      val = cs.get.hsl(string);
      model = 'hsl';
      break;

    case 'hwb':
      val = cs.get.hwb(string);
      model = 'hwb';
      break;

    default:
      val = cs.get.rgb(string);
      model = 'rgb';
      break;
  }

  if (!val) {
    return null;
  }

  return {
    model: model,
    value: val
  };
};

cs.get.rgb = function (string) {
  if (!string) {
    return null;
  }

  var abbr = /^#([a-f0-9]{3,4})$/i;
  var hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;
  var rgba = /^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;
  var per = /^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;
  var keyword = /^(\w+)$/;
  var rgb = [0, 0, 0, 1];
  var match;
  var i;
  var hexAlpha;

  if (match = string.match(hex)) {
    hexAlpha = match[2];
    match = match[1];

    for (i = 0; i < 3; i++) {
      var i2 = i * 2;
      rgb[i] = parseInt(match.slice(i2, i2 + 2), 16);
    }

    if (hexAlpha) {
      rgb[3] = parseInt(hexAlpha, 16) / 255;
    }
  } else if (match = string.match(abbr)) {
    match = match[1];
    hexAlpha = match[3];

    for (i = 0; i < 3; i++) {
      rgb[i] = parseInt(match[i] + match[i], 16);
    }

    if (hexAlpha) {
      rgb[3] = parseInt(hexAlpha + hexAlpha, 16) / 255;
    }
  } else if (match = string.match(rgba)) {
    for (i = 0; i < 3; i++) {
      rgb[i] = parseInt(match[i + 1], 0);
    }

    if (match[4]) {
      if (match[5]) {
        rgb[3] = parseFloat(match[4]) * 0.01;
      } else {
        rgb[3] = parseFloat(match[4]);
      }
    }
  } else if (match = string.match(per)) {
    for (i = 0; i < 3; i++) {
      rgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);
    }

    if (match[4]) {
      if (match[5]) {
        rgb[3] = parseFloat(match[4]) * 0.01;
      } else {
        rgb[3] = parseFloat(match[4]);
      }
    }
  } else if (match = string.match(keyword)) {
    if (match[1] === 'transparent') {
      return [0, 0, 0, 0];
    }

    if (!hasOwnProperty.call(colorNames, match[1])) {
      return null;
    }

    rgb = colorNames[match[1]];
    rgb[3] = 1;
    return rgb;
  } else {
    return null;
  }

  for (i = 0; i < 3; i++) {
    rgb[i] = clamp(rgb[i], 0, 255);
  }

  rgb[3] = clamp(rgb[3], 0, 1);
  return rgb;
};

cs.get.hsl = function (string) {
  if (!string) {
    return null;
  }

  var hsl = /^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;
  var match = string.match(hsl);

  if (match) {
    var alpha = parseFloat(match[4]);
    var h = (parseFloat(match[1]) % 360 + 360) % 360;
    var s = clamp(parseFloat(match[2]), 0, 100);
    var l = clamp(parseFloat(match[3]), 0, 100);
    var a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);
    return [h, s, l, a];
  }

  return null;
};

cs.get.hwb = function (string) {
  if (!string) {
    return null;
  }

  var hwb = /^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;
  var match = string.match(hwb);

  if (match) {
    var alpha = parseFloat(match[4]);
    var h = (parseFloat(match[1]) % 360 + 360) % 360;
    var w = clamp(parseFloat(match[2]), 0, 100);
    var b = clamp(parseFloat(match[3]), 0, 100);
    var a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);
    return [h, w, b, a];
  }

  return null;
};

cs.to.hex = function () {
  var rgba = swizzle(arguments);
  return '#' + hexDouble(rgba[0]) + hexDouble(rgba[1]) + hexDouble(rgba[2]) + (rgba[3] < 1 ? hexDouble(Math.round(rgba[3] * 255)) : '');
};

cs.to.rgb = function () {
  var rgba = swizzle(arguments);
  return rgba.length < 4 || rgba[3] === 1 ? 'rgb(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ')' : 'rgba(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ', ' + rgba[3] + ')';
};

cs.to.rgb.percent = function () {
  var rgba = swizzle(arguments);
  var r = Math.round(rgba[0] / 255 * 100);
  var g = Math.round(rgba[1] / 255 * 100);
  var b = Math.round(rgba[2] / 255 * 100);
  return rgba.length < 4 || rgba[3] === 1 ? 'rgb(' + r + '%, ' + g + '%, ' + b + '%)' : 'rgba(' + r + '%, ' + g + '%, ' + b + '%, ' + rgba[3] + ')';
};

cs.to.hsl = function () {
  var hsla = swizzle(arguments);
  return hsla.length < 4 || hsla[3] === 1 ? 'hsl(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%)' : 'hsla(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%, ' + hsla[3] + ')';
};

cs.to.hwb = function () {
  var hwba = swizzle(arguments);
  var a = '';

  if (hwba.length >= 4 && hwba[3] !== 1) {
    a = ', ' + hwba[3];
  }

  return 'hwb(' + hwba[0] + ', ' + hwba[1] + '%, ' + hwba[2] + '%' + a + ')';
};

cs.to.keyword = function (rgb) {
  return reverseNames[rgb.slice(0, 3)];
};

function clamp(num, min, max) {
  return Math.min(Math.max(min, num), max);
}

function hexDouble(num) {
  var str = Math.round(num).toString(16).toUpperCase();
  return str.length < 2 ? '0' + str : str;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImNvbG9yTmFtZXMiLCJyZXF1aXJlIiwic3dpenpsZSIsImhhc093blByb3BlcnR5IiwiT2JqZWN0IiwicmV2ZXJzZU5hbWVzIiwibmFtZSIsImNhbGwiLCJjcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJ0byIsImdldCIsInN0cmluZyIsInByZWZpeCIsInN1YnN0cmluZyIsInRvTG93ZXJDYXNlIiwidmFsIiwibW9kZWwiLCJoc2wiLCJod2IiLCJyZ2IiLCJ2YWx1ZSIsImFiYnIiLCJoZXgiLCJyZ2JhIiwicGVyIiwia2V5d29yZCIsIm1hdGNoIiwiaSIsImhleEFscGhhIiwiaTIiLCJwYXJzZUludCIsInNsaWNlIiwicGFyc2VGbG9hdCIsIk1hdGgiLCJyb3VuZCIsImNsYW1wIiwiYWxwaGEiLCJoIiwicyIsImwiLCJhIiwiaXNOYU4iLCJ3IiwiYiIsImFyZ3VtZW50cyIsImhleERvdWJsZSIsImxlbmd0aCIsInBlcmNlbnQiLCJyIiwiZyIsImhzbGEiLCJod2JhIiwibnVtIiwibWluIiwibWF4Iiwic3RyIiwidG9TdHJpbmciLCJ0b1VwcGVyQ2FzZSJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBSUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsWUFBRCxDQUF4Qjs7QUFDQSxJQUFJQyxPQUFPLEdBQUdELE9BQU8sQ0FBQyxnQkFBRCxDQUFyQjs7QUFDQSxJQUFJRSxjQUFjLEdBQUdDLE1BQU0sQ0FBQ0QsY0FBNUI7QUFFQSxJQUFJRSxZQUFZLEdBQUcsRUFBbkI7O0FBR0EsS0FBSyxJQUFJQyxJQUFULElBQWlCTixVQUFqQixFQUE2QjtBQUM1QixNQUFJRyxjQUFjLENBQUNJLElBQWYsQ0FBb0JQLFVBQXBCLEVBQWdDTSxJQUFoQyxDQUFKLEVBQTJDO0FBQzFDRCxJQUFBQSxZQUFZLENBQUNMLFVBQVUsQ0FBQ00sSUFBRCxDQUFYLENBQVosR0FBaUNBLElBQWpDO0FBQ0E7QUFDRDs7QUFFRCxJQUFJRSxFQUFFLEdBQUdDLE1BQU0s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O0FBQzdCLFNBQU9yQixJQUFJLENBQUNvQixHQUFMLENBQVNwQixJQUFJLENBQUNxQixHQUFMLENBQVNELEdBQVQsRUFBY0QsR0FBZCxDQUFULEVBQTZCRSxHQUE3QixDQUFQO0FBQ0E7O0FBRUQsU0FBU1QsU0FBVCxDQUFtQk8sR0FBbkIsRUFBd0I7QUFDdkIsTUFBSUcsR0FBRyxHQUFHdEIsSUFBSSxDQUFDQyxLQUFMLENBQVdrQixHQUFYLEVBQWdCSSxRQUFoQixDQUF5QixFQUF6QixFQUE2QkMsV0FBN0IsRUFBVjtBQUNBLFNBQVFGLEdBQUcsQ0FBQ1QsTUFBSixHQUFhLENBQWQsR0FBbUIsTUFBTVMsR0FBekIsR0FBK0JBLEdBQXRDO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBNSVQgbGljZW5zZSAqL1xudmFyIGNvbG9yTmFtZXMgPSByZXF1aXJlKCdjb2xvci1uYW1lJyk7XG52YXIgc3dpenpsZSA9IHJlcXVpcmUoJ3NpbXBsZS1zd2l6emxlJyk7XG52YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QuaGFzT3duUHJvcGVydHk7XG5cbnZhciByZXZlcnNlTmFtZXMgPSB7fTtcblxuLy8gY3JlYXRlIGEgbGlzdCBvZiByZXZlcnNlIGNvbG9yIG5hbWVzXG5mb3IgKHZhciBuYW1lIGluIGNvbG9yTmFtZXMpIHtcblx0aWYgKGhhc093blByb3BlcnR5LmNhbGwoY29sb3JOYW1lcywgbmFtZSkpIHtcblx0XHRyZXZlcnNlTmFtZXNbY29sb3JOYW1lc1tuYW1lXV0gPSBuYW1lO1xuXHR9XG59XG5cbnZhciBjcyA9IG1vZHVsZS5leHBvcnRzID0ge1xuXHR0bzoge30sXG5cdGdldDoge31cbn07XG5cbmNzLmdldCA9IGZ1bmN0aW9uIChzdHJpbmcpIHtcblx0dmFyIHByZWZpeCA9IHN0cmluZy5zdWJzdHJpbmcoMCwgMykudG9Mb3dlckNhc2UoKTtcblx0dmFyIHZhbDtcblx0dmFyIG1vZGVsO1xuXHRzd2l0Y2ggKHByZWZpeCkge1xuXHRcdGNhc2UgJ2hzbCc6XG5cdFx0XHR2YWwgPSBjcy5nZXQuaHNsKHN0cmluZyk7XG5cdFx0XHRtb2RlbCA9ICdoc2wnO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAnaHdiJzpcblx0XHRcdHZhbCA9IGNzLmdldC5od2Ioc3RyaW5nKTtcblx0XHRcdG1vZGVsID0gJ2h3Yic7XG5cdFx0XHRicmVhaztcblx0XHRkZWZhdWx0OlxuXHRcdFx0dmFsID0gY3MuZ2V0LnJnYihzdHJpbmcpO1xuXHRcdFx0bW9kZWwgPSAncmdiJztcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0aWYgKCF2YWwpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHJldHVybiB7bW9kZWw6IG1vZGVsLCB2YWx1ZTogdmFsfTtcbn07XG5cbmNzLmdldC5yZ2IgPSBmdW5jdGlvbiAoc3RyaW5nKSB7XG5cdGlmICghc3RyaW5nKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHR2YXIgYWJiciA9IC9eIyhbYS1mMC05XXszLDR9KSQvaTtcblx0dmFyIGhleCA9IC9eIyhbYS1mMC05XXs2fSkoW2EtZjAtOV17Mn0pPyQvaTtcblx0dmFyIHJnYmEgPSAvXnJnYmE/XFwoXFxzKihbKy1dP1xcZCspKD89W1xccyxdKVxccyooPzosXFxzKik/KFsrLV0/XFxkKykoPz1bXFxzLF0pXFxzKig/OixcXHMqKT8oWystXT9cXGQrKVxccyooPzpbLHxcXC9dXFxzKihbKy1dP1tcXGRcXC5dKykoJT8pXFxzKik/XFwpJC87XG5cdHZhciBwZXIgPSAvXnJnYmE/XFwoXFxzKihbKy1dP1tcXGRcXC5dKylcXCVcXHMqLD9cXHMqKFsrLV0/W1xcZFxcLl0rKVxcJVxccyosP1xccyooWystXT9bXFxkXFwuXSspXFwlXFxzKig/OlssfFxcL11cXHMqKFsrLV0/W1xcZFxcLl0rKSglPylcXHMqKT9cXCkkLztcblx0dmFyIGtleXdvcmQgPSAvXihcXHcrKSQvO1xuXG5cdHZhciByZ2IgPSBbMCwgMCwgMCwgMV07XG5cdHZhciBtYXRjaDtcblx0dmFyIGk7XG5cdHZhciBoZXhBbHBoYTtcblxuXHRpZiAobWF0Y2ggPSBzdHJpbmcubWF0Y2goaGV4KSkge1xuXHRcdGhleEFscGhhID0gbWF0Y2hbMl07XG5cdFx0bWF0Y2ggPSBtYXRjaFsxXTtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcblx0XHRcdC8vIGh0dHBzOi8vanNwZXJmLmNvbS9zbGljZS12cy1zdWJzdHItdnMtc3Vic3RyaW5nLW1ldGhvZHMtbG9uZy1zdHJpbmcvMTlcblx0XHRcdHZhciBpMiA9IGkgKiAyO1xuXHRcdFx0cmdiW2ldID0gcGFyc2VJbnQobWF0Y2guc2xpY2UoaTIsIGkyICsgMiksIDE2KTtcblx0XHR9XG5cblx0XHRpZiAoaGV4QWxwaGEpIHtcblx0XHRcdHJnYlszXSA9IHBhcnNlSW50KGhleEFscGhhLCAxNikgLyAyNTU7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKGFiYnIpKSB7XG5cdFx0bWF0Y2ggPSBtYXRjaFsxXTtcblx0XHRoZXhBbHBoYSA9IG1hdGNoWzNdO1xuXG5cdFx0Zm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xuXHRcdFx0cmdiW2ldID0gcGFyc2VJbnQobWF0Y2hbaV0gKyBtYXRjaFtpXSwgMTYpO1xuXHRcdH1cblxuXHRcdGlmIChoZXhBbHBoYSkge1xuXHRcdFx0cmdiWzNdID0gcGFyc2VJbnQoaGV4QWxwaGEgKyBoZXhBbHBoYSwgMTYpIC8gMjU1O1xuXHRcdH1cblx0fSBlbHNlIGlmIChtYXRjaCA9IHN0cmluZy5tYXRjaChyZ2JhKSkge1xuXHRcdGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcblx0XHRcdHJnYltpXSA9IHBhcnNlSW50KG1hdGNoW2kgKyAxXSwgMCk7XG5cdFx0fVxuXG5cdFx0aWYgKG1hdGNoWzRdKSB7XG5cdFx0XHRpZiAobWF0Y2hbNV0pIHtcblx0XHRcdFx0cmdiWzNdID0gcGFyc2VGbG9hdChtYXRjaFs0XSkgKiAwLjAxO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmdiWzNdID0gcGFyc2VGbG9hdChtYXRjaFs0XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2UgaWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKHBlcikpIHtcblx0XHRmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG5cdFx0XHRyZ2JbaV0gPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQobWF0Y2hbaSArIDFdKSAqIDIuNTUpO1xuXHRcdH1cblxuXHRcdGlmIChtYXRjaFs0XSkge1xuXHRcdFx0aWYgKG1hdGNoWzVdKSB7XG5cdFx0XHRcdHJnYlszXSA9IHBhcnNlRmxvYXQobWF0Y2hbNF0pICogMC4wMTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJnYlszXSA9IHBhcnNlRmxvYXQobWF0Y2hbNF0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIGlmIChtYXRjaCA9IHN0cmluZy5tYXRjaChrZXl3b3JkKSkge1xuXHRcdGlmIChtYXRjaFsxXSA9PT0gJ3RyYW5zcGFyZW50Jykge1xuXHRcdFx0cmV0dXJuIFswLCAwLCAwLCAwXTtcblx0XHR9XG5cblx0XHRpZiAoIWhhc093blByb3BlcnR5LmNhbGwoY29sb3JOYW1lcywgbWF0Y2hbMV0pKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRyZ2IgPSBjb2xvck5hbWVzW21hdGNoWzFdXTtcblx0XHRyZ2JbM10gPSAxO1xuXG5cdFx0cmV0dXJuIHJnYjtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcblx0XHRyZ2JbaV0gPSBjbGFtcChyZ2JbaV0sIDAsIDI1NSk7XG5cdH1cblx0cmdiWzNdID0gY2xhbXAocmdiWzNdLCAwLCAxKTtcblxuXHRyZXR1cm4gcmdiO1xufTtcblxuY3MuZ2V0LmhzbCA9IGZ1bmN0aW9uIChzdHJpbmcpIHtcblx0aWYgKCFzdHJpbmcpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHZhciBoc2wgPSAvXmhzbGE/XFwoXFxzKihbKy1dPyg/OlxcZHswLDN9XFwuKT9cXGQrKSg/OmRlZyk/XFxzKiw/XFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKiw/XFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKig/OlssfFxcL11cXHMqKFsrLV0/KD89XFwuXFxkfFxcZCkoPzowfFsxLTldXFxkKik/KD86XFwuXFxkKik/KD86W2VFXVsrLV0/XFxkKyk/KVxccyopP1xcKSQvO1xuXHR2YXIgbWF0Y2ggPSBzdHJpbmcubWF0Y2goaHNsKTtcblxuXHRpZiAobWF0Y2gpIHtcblx0XHR2YXIgYWxwaGEgPSBwYXJzZUZsb2F0KG1hdGNoWzRdKTtcblx0XHR2YXIgaCA9ICgocGFyc2VGbG9hdChtYXRjaFsxXSkgJSAzNjApICsgMzYwKSAlIDM2MDtcblx0XHR2YXIgcyA9IGNsYW1wKHBhcnNlRmxvYXQobWF0Y2hbMl0pLCAwLCAxMDApO1xuXHRcdHZhciBsID0gY2xhbXAocGFyc2VGbG9hdChtYXRjaFszXSksIDAsIDEwMCk7XG5cdFx0dmFyIGEgPSBjbGFtcChpc05hTihhbHBoYSkgPyAxIDogYWxwaGEsIDAsIDEpO1xuXG5cdFx0cmV0dXJuIFtoLCBzLCBsLCBhXTtcblx0fVxuXG5cdHJldHVybiBudWxsO1xufTtcblxuY3MuZ2V0Lmh3YiA9IGZ1bmN0aW9uIChzdHJpbmcpIHtcblx0aWYgKCFzdHJpbmcpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHZhciBod2IgPSAvXmh3YlxcKFxccyooWystXT9cXGR7MCwzfSg/OlxcLlxcZCspPykoPzpkZWcpP1xccyosXFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKixcXHMqKFsrLV0/W1xcZFxcLl0rKSVcXHMqKD86LFxccyooWystXT8oPz1cXC5cXGR8XFxkKSg/OjB8WzEtOV1cXGQqKT8oPzpcXC5cXGQqKT8oPzpbZUVdWystXT9cXGQrKT8pXFxzKik/XFwpJC87XG5cdHZhciBtYXRjaCA9IHN0cmluZy5tYXRjaChod2IpO1xuXG5cdGlmIChtYXRjaCkge1xuXHRcdHZhciBhbHBoYSA9IHBhcnNlRmxvYXQobWF0Y2hbNF0pO1xuXHRcdHZhciBoID0gKChwYXJzZUZsb2F0KG1hdGNoWzFdKSAlIDM2MCkgKyAzNjApICUgMzYwO1xuXHRcdHZhciB3ID0gY2xhbXAocGFyc2VGbG9hdChtYXRjaFsyXSksIDAsIDEwMCk7XG5cdFx0dmFyIGIgPSBjbGFtcChwYXJzZUZsb2F0KG1hdGNoWzNdKSwgMCwgMTAwKTtcblx0XHR2YXIgYSA9IGNsYW1wKGlzTmFOKGFscGhhKSA/IDEgOiBhbHBoYSwgMCwgMSk7XG5cdFx0cmV0dXJuIFtoLCB3LCBiLCBhXTtcblx0fVxuXG5cdHJldHVybiBudWxsO1xufTtcblxuY3MudG8uaGV4ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcmdiYSA9IHN3aXp6bGUoYXJndW1lbnRzKTtcblxuXHRyZXR1cm4gKFxuXHRcdCcjJyArXG5cdFx0aGV4RG91YmxlKHJnYmFbMF0pICtcblx0XHRoZXhEb3VibGUocmdiYVsxXSkgK1xuXHRcdGhleERvdWJsZShyZ2JhWzJdKSArXG5cdFx0KHJnYmFbM10gPCAxXG5cdFx0XHQ/IChoZXhEb3VibGUoTWF0aC5yb3VuZChyZ2JhWzNdICogMjU1KSkpXG5cdFx0XHQ6ICcnKVxuXHQpO1xufTtcblxuY3MudG8ucmdiID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcmdiYSA9IHN3aXp6bGUoYXJndW1lbnRzKTtcblxuXHRyZXR1cm4gcmdiYS5sZW5ndGggPCA0IHx8IHJnYmFbM10gPT09IDFcblx0XHQ/ICdyZ2IoJyArIE1hdGgucm91bmQocmdiYVswXSkgKyAnLCAnICsgTWF0aC5yb3VuZChyZ2JhWzFdKSArICcsICcgKyBNYXRoLnJvdW5kKHJnYmFbMl0pICsgJyknXG5cdFx0OiAncmdiYSgnICsgTWF0aC5yb3VuZChyZ2JhWzBdKSArICcsICcgKyBNYXRoLnJvdW5kKHJnYmFbMV0pICsgJywgJyArIE1hdGgucm91bmQocmdiYVsyXSkgKyAnLCAnICsgcmdiYVszXSArICcpJztcbn07XG5cbmNzLnRvLnJnYi5wZXJjZW50ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcmdiYSA9IHN3aXp6bGUoYXJndW1lbnRzKTtcblxuXHR2YXIgciA9IE1hdGgucm91bmQocmdiYVswXSAvIDI1NSAqIDEwMCk7XG5cdHZhciBnID0gTWF0aC5yb3VuZChyZ2JhWzFdIC8gMjU1ICogMTAwKTtcblx0dmFyIGIgPSBNYXRoLnJvdW5kKHJnYmFbMl0gLyAyNTUgKiAxMDApO1xuXG5cdHJldHVybiByZ2JhLmxlbmd0aCA8IDQgfHwgcmdiYVszXSA9PT0gMVxuXHRcdD8gJ3JnYignICsgciArICclLCAnICsgZyArICclLCAnICsgYiArICclKSdcblx0XHQ6ICdyZ2JhKCcgKyByICsgJyUsICcgKyBnICsgJyUsICcgKyBiICsgJyUsICcgKyByZ2JhWzNdICsgJyknO1xufTtcblxuY3MudG8uaHNsID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgaHNsYSA9IHN3aXp6bGUoYXJndW1lbnRzKTtcblx0cmV0dXJuIGhzbGEubGVuZ3RoIDwgNCB8fCBoc2xhWzNdID09PSAxXG5cdFx0PyAnaHNsKCcgKyBoc2xhWzBdICsgJywgJyArIGhzbGFbMV0gKyAnJSwgJyArIGhzbGFbMl0gKyAnJSknXG5cdFx0OiAnaHNsYSgnICsgaHNsYVswXSArICcsICcgKyBoc2xhWzFdICsgJyUsICcgKyBoc2xhWzJdICsgJyUsICcgKyBoc2xhWzNdICsgJyknO1xufTtcblxuLy8gaHdiIGlzIGEgYml0IGRpZmZlcmVudCB0aGFuIHJnYihhKSAmIGhzbChhKSBzaW5jZSB0aGVyZSBpcyBubyBhbHBoYSBzcGVjaWZpYyBzeW50YXhcbi8vIChod2IgaGF2ZSBhbHBoYSBvcHRpb25hbCAmIDEgaXMgZGVmYXVsdCB2YWx1ZSlcbmNzLnRvLmh3YiA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGh3YmEgPSBzd2l6emxlKGFyZ3VtZW50cyk7XG5cblx0dmFyIGEgPSAnJztcblx0aWYgKGh3YmEubGVuZ3RoID49IDQgJiYgaHdiYVszXSAhPT0gMSkge1xuXHRcdGEgPSAnLCAnICsgaHdiYVszXTtcblx0fVxuXG5cdHJldHVybiAnaHdiKCcgKyBod2JhWzBdICsgJywgJyArIGh3YmFbMV0gKyAnJSwgJyArIGh3YmFbMl0gKyAnJScgKyBhICsgJyknO1xufTtcblxuY3MudG8ua2V5d29yZCA9IGZ1bmN0aW9uIChyZ2IpIHtcblx0cmV0dXJuIHJldmVyc2VOYW1lc1tyZ2Iuc2xpY2UoMCwgMyldO1xufTtcblxuLy8gaGVscGVyc1xuZnVuY3Rpb24gY2xhbXAobnVtLCBtaW4sIG1heCkge1xuXHRyZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgobWluLCBudW0pLCBtYXgpO1xufVxuXG5mdW5jdGlvbiBoZXhEb3VibGUobnVtKSB7XG5cdHZhciBzdHIgPSBNYXRoLnJvdW5kKG51bSkudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCk7XG5cdHJldHVybiAoc3RyLmxlbmd0aCA8IDIpID8gJzAnICsgc3RyIDogc3RyO1xufVxuIl19