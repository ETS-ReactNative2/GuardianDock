4706c8c5308dfcd95b9548161530ff6a
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _objectWithoutProperties2 = _interopRequireDefault2(require("@babel/runtime/helpers/objectWithoutProperties"));

var _extends3 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

var _excluded = ["navigation"];
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = DrawerView;

var _elements = require("@react-navigation/elements");

var _native = require("@react-navigation/native");

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var Reanimated = _interopRequireWildcard(require("react-native-reanimated"));

var _reactNativeSafeAreaContext = require("react-native-safe-area-context");

var _DrawerPositionContext = _interopRequireDefault(require("../utils/DrawerPositionContext"));

var _DrawerStatusContext = _interopRequireDefault(require("../utils/DrawerStatusContext"));

var _getDrawerStatusFromState = _interopRequireDefault(require("../utils/getDrawerStatusFromState"));

var _DrawerContent = _interopRequireDefault(require("./DrawerContent"));

var _DrawerToggleButton = _interopRequireDefault(require("./DrawerToggleButton"));

var _GestureHandler = require("./GestureHandler");

var _ScreenFallback = require("./ScreenFallback");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}

function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache(nodeInterop);

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

var getDefaultDrawerWidth = function getDefaultDrawerWidth(_ref) {
  var height = _ref.height,
      width = _ref.width;
  var smallerAxisSize = Math.min(height, width);
  var isLandscape = width > height;
  var isTablet = smallerAxisSize >= 600;
  var appBarHeight = _reactNative.Platform.OS === 'ios' ? isLandscape ? 32 : 44 : 56;
  var maxWidth = isTablet ? 320 : 280;
  return Math.min(smallerAxisSize - appBarHeight, maxWidth);
};

var GestureHandlerWrapper = _GestureHandler.GestureHandlerRootView !== null && _GestureHandler.GestureHandlerRootView !== void 0 ? _GestureHandler.GestureHandlerRootView : _reactNative.View;

function DrawerViewBase(_ref2) {
  var _Reanimated$isConfigu;

  var state = _ref2.state,
      navigation = _ref2.navigation,
      descriptors = _ref2.descriptors,
      defaultStatus = _ref2.defaultStatus,
      _ref2$drawerContent = _ref2.drawerContent,
      drawerContent = _ref2$drawerContent === void 0 ? function (props) {
    return React.createElement(_DrawerContent.default, props);
  } : _ref2$drawerContent,
      _ref2$detachInactiveS = _ref2.detachInactiveScreens,
      detachInactiveScreens = _ref2$detachInactiveS === void 0 ? _reactNative.Platform.OS === 'web' || _reactNative.Platform.OS === 'android' || _reactNative.Platform.OS === 'ios' : _ref2$detachInactiveS,
      _ref2$useLegacyImplem = _ref2.useLegacyImplementation,
      useLegacyImplementation = _ref2$useLegacyImplem === void 0 ? !global.nativeCallSyncHook || !((_Reanimated$isConfigu = Reanimated.isConfigured) !== null && _Reanimated$isConfigu !== void 0 && _Reanimated$isConfigu.call(Reanimated)) : _ref2$useLegacyImplem;
  var Drawer = useLegacyImplementation ? require("./legacy/Drawer").default : require("./modern/Drawer").default;
  var focusedRouteKey = state.routes[state.index].key;
  var _descriptors$focusedR = descriptors[focusedRouteKey].options,
      _descriptors$focusedR2 = _descriptors$focusedR.drawerHideStatusBarOnOpen,
      drawerHideStatusBarOnOpen = _descriptors$focusedR2 === void 0 ? false : _descriptors$focusedR2,
      _descriptors$focusedR3 = _descriptors$focusedR.drawerPosition,
      drawerPosition = _descriptors$focusedR3 === void 0 ? _reactNative.I18nManager.isRTL ? 'right' : 'left' : _descriptors$focusedR3,
      _descriptors$focusedR4 = _descriptors$focusedR.drawerStatusBarAnimation,
      drawerStatusBarAnimation = _descriptors$focusedR4 === void 0 ? 'slide' : _descriptors$focusedR4,
      drawerStyle = _descriptors$focusedR.drawerStyle,
      _descriptors$focusedR5 = _descriptors$focusedR.drawerType,
      drawerType = _descriptors$focusedR5 === void 0 ? _reactNative.Platform.select({
    ios: 'slide',
    default: 'front'
  }) : _descriptors$focusedR5,
      gestureHandlerProps = _descriptors$focusedR.gestureHandlerProps,
      _descriptors$focusedR6 = _descriptors$focusedR.keyboardDismissMode,
      keyboardDismissMode = _descriptors$focusedR6 === void 0 ? 'on-drag' : _descriptors$focusedR6,
      _descriptors$focusedR7 = _descriptors$focusedR.overlayColor,
      overlayColor = _descriptors$focusedR7 === void 0 ? 'rgba(0, 0, 0, 0.5)' : _descriptors$focusedR7,
      _descriptors$focusedR8 = _descriptors$focusedR.swipeEdgeWidth,
      swipeEdgeWidth = _descriptors$focusedR8 === void 0 ? 32 : _descriptors$focusedR8,
      _descriptors$focusedR9 = _descriptors$focusedR.swipeEnabled,
      swipeEnabled = _descriptors$focusedR9 === void 0 ? _reactNative.Platform.OS !== 'web' && _reactNative.Platform.OS !== 'windows' && _reactNative.Platform.OS !== 'macos' : _descriptors$focusedR9,
      _descriptors$focusedR10 = _descriptors$focusedR.swipeMinDistance,
      swipeMinDistance = _descriptors$focusedR10 === void 0 ? 60 : _descriptors$focusedR10;

  var _React$useState = React.useState([focusedRouteKey]),
      _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
      loaded = _React$useState2[0],
      setLoaded = _React$useState2[1];

  if (!loaded.includes(focusedRouteKey)) {
    setLoaded([].concat((0, _toConsumableArray2.default)(loaded), [focusedRouteKey]));
  }

  var dimensions = (0, _reactNativeSafeAreaContext.useSafeAreaFrame)();

  var _ref5 = (0, _native.useTheme)(),
      colors = _ref5.colors;

  var drawerStatus = (0, _getDrawerStatusFromState.default)(state);
  var handleDrawerOpen = React.useCallback(function () {
    navigation.dispatch((0, _extends3.default)({}, _native.DrawerActions.openDrawer(), {
      target: state.key
    }));
  }, [navigation, state.key]);
  var handleDrawerClose = React.useCallback(function () {
    navigation.dispatch((0, _extends3.default)({}, _native.DrawerActions.closeDrawer(), {
      target: state.key
    }));
  }, [navigation, state.key]);
  React.useEffect(function () {
    if (drawerStatus === defaultStatus || drawerType === 'permanent') {
      return;
    }

    var handleHardwareBack = function handleHardwareBack() {
      if (!navigation.isFocused()) {
        return false;
      }

      if (defaultStatus === 'open') {
        handleDrawerOpen();
      } else {
        handleDrawerClose();
      }

      return true;
    };

    var handleEscape = function handleEscape(e) {
      if (e.key === 'Escape') {
        handleHardwareBack();
      }
    };

    var subscription = _reactNative.BackHandler.addEventListener('hardwareBackPress', handleHardwareBack);

    if (_reactNative.Platform.OS === 'web') {
      var _document, _document$body, _document$body$addEve;

      (_document = document) === null || _document === void 0 ? void 0 : (_document$body = _document.body) === null || _document$body === void 0 ? void 0 : (_document$body$addEve = _document$body.addEventListener) === null || _document$body$addEve === void 0 ? void 0 : _document$body$addEve.call(_document$body, 'keyup', handleEscape);
    }

    return function () {
      subscription.remove();

      if (_reactNative.Platform.OS === 'web') {
        var _document2, _document2$body, _document2$body$remov;

        (_document2 = document) === null || _document2 === void 0 ? void 0 : (_document2$body = _document2.body) === null || _document2$body === void 0 ? void 0 : (_document2$body$remov = _document2$body.removeEventListener) === null || _document2$body$remov === void 0 ? void 0 : _document2$body$remov.call(_document2$body, 'keyup', handleEscape);
      }
    };
  }, [defaultStatus, drawerStatus, drawerType, handleDrawerClose, handleDrawerOpen, navigation]);

  var renderDrawerContent = function renderDrawerContent() {
    return React.createElement(_DrawerPositionContext.default.Provider, {
      value: drawerPosition
    }, drawerContent({
      state: state,
      navigation: navigation,
      descriptors: descriptors
    }));
  };

  var renderSceneContent = function renderSceneContent() {
    return React.createElement(_ScreenFallback.MaybeScreenContainer, {
      enabled: detachInactiveScreens,
      hasTwoStates: true,
      style: styles.content
    }, state.routes.map(function (route, index) {
      var descriptor = descriptors[route.key];
      var _descriptor$options = descriptor.options,
          _descriptor$options$l = _descriptor$options.lazy,
          lazy = _descriptor$options$l === void 0 ? true : _descriptor$options$l,
          unmountOnBlur = _descriptor$options.unmountOnBlur;
      var isFocused = state.index === index;

      if (unmountOnBlur && !isFocused) {
        return null;
      }

      if (lazy && !loaded.includes(route.key) && !isFocused) {
        return null;
      }

      var _descriptor$options2 = descriptor.options,
          _descriptor$options2$ = _descriptor$options2.header,
          header = _descriptor$options2$ === void 0 ? function (_ref3) {
        var _options$headerLeft;

        var layout = _ref3.layout,
            options = _ref3.options;
        return React.createElement(_elements.Header, _extends({}, options, {
          layout: layout,
          title: (0, _elements.getHeaderTitle)(options, route.name),
          headerLeft: (_options$headerLeft = options.headerLeft) !== null && _options$headerLeft !== void 0 ? _options$headerLeft : function (props) {
            return React.createElement(_DrawerToggleButton.default, props);
          }
        }));
      } : _descriptor$options2$,
          sceneContainerStyle = _descriptor$options2.sceneContainerStyle;
      return React.createElement(_ScreenFallback.MaybeScreen, {
        key: route.key,
        style: [_reactNative.StyleSheet.absoluteFill, {
          zIndex: isFocused ? 0 : -1
        }],
        visible: isFocused,
        enabled: detachInactiveScreens
      }, React.createElement(_elements.Screen, {
        focused: isFocused,
        route: descriptor.route,
        navigation: descriptor.navigation,
        headerShown: descriptor.options.headerShown,
        headerTransparent: descriptor.options.headerTransparent,
        headerStatusBarHeight: descriptor.options.headerStatusBarHeight,
        header: header({
          layout: dimensions,
          route: descriptor.route,
          navigation: descriptor.navigation,
          options: descriptor.options
        }),
        style: sceneContainerStyle
      }, descriptor.render()));
    }));
  };

  return React.createElement(_DrawerStatusContext.default.Provider, {
    value: drawerStatus
  }, React.createElement(Drawer, {
    open: drawerStatus !== 'closed',
    onOpen: handleDrawerOpen,
    onClose: handleDrawerClose,
    gestureHandlerProps: gestureHandlerProps,
    swipeEnabled: swipeEnabled,
    swipeEdgeWidth: swipeEdgeWidth,
    swipeVelocityThreshold: 500,
    swipeDistanceThreshold: swipeMinDistance,
    hideStatusBarOnOpen: drawerHideStatusBarOnOpen,
    statusBarAnimation: drawerStatusBarAnimation,
    keyboardDismissMode: keyboardDismissMode,
    drawerType: drawerType,
    drawerPosition: drawerPosition,
    drawerStyle: [{
      width: getDefaultDrawerWidth(dimensions),
      backgroundColor: colors.card
    }, drawerType === 'permanent' && (drawerPosition === 'left' ? {
      borderRightColor: colors.border,
      borderRightWidth: _reactNative.StyleSheet.hairlineWidth
    } : {
      borderLeftColor: colors.border,
      borderLeftWidth: _reactNative.StyleSheet.hairlineWidth
    }), drawerStyle],
    overlayStyle: {
      backgroundColor: overlayColor
    },
    renderDrawerContent: renderDrawerContent,
    renderSceneContent: renderSceneContent,
    dimensions: dimensions
  }));
}

function DrawerView(_ref4) {
  var navigation = _ref4.navigation,
      rest = (0, _objectWithoutProperties2.default)(_ref4, _excluded);
  return React.createElement(_elements.SafeAreaProviderCompat, null, React.createElement(GestureHandlerWrapper, {
    style: styles.content
  }, React.createElement(DrawerViewBase, _extends({
    navigation: navigation
  }, rest))));
}

var styles = _reactNative.StyleSheet.create({
  content: {
    flex: 1
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxXQUFmQSxLQUNHTCxjQUFjLEtBQUssTUFBbkJBLEdBQ0c7QUFDRW1GLHNCQUFnQixFQUFFaEUsTUFBTSxDQUFDaUUsTUFEM0I7QUFFRUMsc0JBQWdCLEVBQUVyQix3QkFBV3NCO0FBRi9CLEtBREh0RixHQUtHO0FBQ0V1RixxQkFBZSxFQUFFcEUsTUFBTSxDQUFDaUUsTUFEMUI7QUFFRUkscUJBQWUsRUFBRXhCLHdCQUFXc0I7QUFGOUIsS0FOTmpGLENBTFcsRUFlWEQsV0FmVyxDQWRmO0FBK0JFcUYsZ0JBQVksRUFBRTtBQUFFUixxQkFBZSxFQUFFdkU7QUFBbkIsS0EvQmhCO0FBZ0NFOEIsdUJBQW1CLEVBQUVBLG1CQWhDdkI7QUFpQ0VJLHNCQUFrQixFQUFFQSxrQkFqQ3RCO0FBa0NFMUIsY0FBVSxFQUFFQTtBQWxDZCxJQURGLENBREY7QUF3Q0Q7O0FBRWMsU0FBU3dFLFVBQVQsUUFBb0Q7QUFBQSxNQUE5QmpILFVBQThCLFNBQTlCQSxVQUE4QjtBQUFBLE1BQWZrSCxJQUFlO0FBQ2pFLFNBQ0U3RyxvQkFBQzRFLGdDQUFELFFBQ0U1RSxvQkFBQ1YscUJBQUQ7QUFBdUI0RSxTQUFLLEVBQUVDLE1BQU0sQ0FBQ0M7QUFBckMsS0FDRXBFLG9CQUFDUCxjQUFEO0FBQWdCRSxjQUFVLEVBQUVBO0FBQTVCLEtBQTRDa0gsSUFBNUMsRUFERixDQURGLENBREY7QUFPRDs7QUFFRCxJQUFNMUMsTUFBTSxHQUFHZSx3QkFBVzRCLE1BQVg1QixDQUFrQjtBQUMvQmQsU0FBTyxFQUFFO0FBQ1AyQyxRQUFJLEVBQUU7QUFEQztBQURzQixDQUFsQjdCLENBQWYiLCJuYW1lcyI6WyJnZXREZWZhdWx0RHJhd2VyV2lkdGgiLCJoZWlnaHQiLCJ3aWR0aCIsInNtYWxsZXJBeGlzU2l6ZSIsIk1hdGgiLCJtaW4iLCJpc0xhbmRzY2FwZSIsImlzVGFibGV0IiwiYXBwQmFySGVpZ2h0IiwiUGxhdGZvcm0iLCJPUyIsIm1heFdpZHRoIiwiR2VzdHVyZUhhbmRsZXJXcmFwcGVyIiwiR2VzdHVyZUhhbmRsZXJSb290VmlldyIsIlZpZXciLCJEcmF3ZXJWaWV3QmFzZSIsInN0YXRlIiwibmF2aWdhdGlvbiIsImRlc2NyaXB0b3JzIiwiZGVmYXVsdFN0YXR1cyIsImRyYXdlckNvbnRlbnQiLCJwcm9wcyIsIlJlYWN0IiwiX0RyYXdlckNvbnRlbnQiLCJkZXRhY2hJbmFjdGl2ZVNjcmVlbnMiLCJ1c2VMZWdhY3lJbXBsZW1lbnRhdGlvbiIsImdsb2JhbCIsIm5hdGl2ZUNhbGxTeW5jSG9vayIsIlJlYW5pbWF0ZWQiLCJpc0NvbmZpZ3VyZWQiLCJfUmVhbmltYXRlZCRpc0NvbmZpZ3UiLCJEcmF3ZXIiLCJyZXF1aXJlIiwiZGVmYXVsdCIsImZvY3VzZWRSb3V0ZUtleSIsInJvdXRlcyIsImluZGV4Iiwia2V5Iiwib3B0aW9ucyIsImRyYXdlckhpZGVTdGF0dXNCYXJPbk9wZW4iLCJkcmF3ZXJQb3NpdGlvbiIsIkkxOG5NYW5hZ2VyIiwiaXNSVEwiLCJkcmF3ZXJTdGF0dXNCYXJBbmltYXRpb24iLCJkcmF3ZXJTdHlsZSIsImRyYXdlclR5cGUiLCJzZWxlY3QiLCJpb3MiLCJnZXN0dXJlSGFuZGxlclByb3BzIiwia2V5Ym9hcmREaXNtaXNzTW9kZSIsIm92ZXJsYXlDb2xvciIsInN3aXBlRWRnZVdpZHRoIiwic3dpcGVFbmFibGVkIiwic3dpcGVNaW5EaXN0YW5jZSIsInVzZVN0YXRlIiwibG9hZGVkIiwic2V0TG9hZGVkIiwiaW5jbHVkZXMiLCJkaW1lbnNpb25zIiwiY29sb3JzIiwiZHJhd2VyU3RhdHVzIiwiaGFuZGxlRHJhd2VyT3BlbiIsInVzZUNhbGxiYWNrIiwiZGlzcGF0Y2giLCJEcmF3ZXJBY3Rpb25zIiwib3BlbkRyYXdlciIsInRhcmdldCIsImhhbmRsZURyYXdlckNsb3NlIiwiY2xvc2VEcmF3ZXIiLCJ1c2VFZmZlY3QiLCJoYW5kbGVIYXJkd2FyZUJhY2siLCJpc0ZvY3VzZWQiLCJoYW5kbGVFc2NhcGUiLCJlIiwic3Vic2NyaXB0aW9uIiwiQmFja0hhbmRsZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiYm9keSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW5kZXJEcmF3ZXJDb250ZW50IiwiX0RyYXdlclBvc2l0aW9uQ29udGV4dCIsIlByb3ZpZGVyIiwidmFsdWUiLCJyZW5kZXJTY2VuZUNvbnRlbnQiLCJfU2NyZWVuRmFsbGJhY2siLCJlbmFibGVkIiwiaGFzVHdvU3RhdGVzIiwic3R5bGUiLCJzdHlsZXMiLCJjb250ZW50IiwibWFwIiwicm91dGUiLCJkZXNjcmlwdG9yIiwibGF6eSIsInVubW91bnRPbkJsdXIiLCJoZWFkZXIiLCJsYXlvdXQiLCJfZWxlbWVudHMiLCJ0aXRsZSIsIm5hbWUiLCJoZWFkZXJMZWZ0IiwiX0RyYXdlclRvZ2dsZUJ1dHRvbiIsInNjZW5lQ29udGFpbmVyU3R5bGUiLCJTdHlsZVNoZWV0IiwiYWJzb2x1dGVGaWxsIiwiekluZGV4IiwidmlzaWJsZSIsImZvY3VzZWQiLCJoZWFkZXJTaG93biIsImhlYWRlclRyYW5zcGFyZW50IiwiaGVhZGVyU3RhdHVzQmFySGVpZ2h0IiwicmVuZGVyIiwiX0RyYXdlclN0YXR1c0NvbnRleHQiLCJvcGVuIiwib25PcGVuIiwib25DbG9zZSIsInN3aXBlVmVsb2NpdHlUaHJlc2hvbGQiLCJzd2lwZURpc3RhbmNlVGhyZXNob2xkIiwiaGlkZVN0YXR1c0Jhck9uT3BlbiIsInN0YXR1c0JhckFuaW1hdGlvbiIsImJhY2tncm91bmRDb2xvciIsImNhcmQiLCJib3JkZXJSaWdodENvbG9yIiwiYm9yZGVyIiwiYm9yZGVyUmlnaHRXaWR0aCIsImhhaXJsaW5lV2lkdGgiLCJib3JkZXJMZWZ0Q29sb3IiLCJib3JkZXJMZWZ0V2lkdGgiLCJvdmVybGF5U3R5bGUiLCJEcmF3ZXJWaWV3IiwicmVzdCIsImNyZWF0ZSIsImZsZXgiXSwic291cmNlcyI6WyJEcmF3ZXJWaWV3LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBnZXRIZWFkZXJUaXRsZSxcbiAgSGVhZGVyLFxuICBTYWZlQXJlYVByb3ZpZGVyQ29tcGF0LFxuICBTY3JlZW4sXG59IGZyb20gJ0ByZWFjdC1uYXZpZ2F0aW9uL2VsZW1lbnRzJztcbmltcG9ydCB7XG4gIERyYXdlckFjdGlvbnMsXG4gIERyYXdlck5hdmlnYXRpb25TdGF0ZSxcbiAgRHJhd2VyU3RhdHVzLFxuICBQYXJhbUxpc3RCYXNlLFxuICB1c2VUaGVtZSxcbn0gZnJvbSAnQHJlYWN0LW5hdmlnYXRpb24vbmF0aXZlJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG4gIEJhY2tIYW5kbGVyLFxuICBJMThuTWFuYWdlcixcbiAgUGxhdGZvcm0sXG4gIFN0eWxlU2hlZXQsXG4gIFZpZXcsXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgKiBhcyBSZWFuaW1hdGVkIGZyb20gJ3JlYWN0LW5hdGl2ZS1yZWFuaW1hdGVkJztcbmltcG9ydCB7IHVzZVNhZmVBcmVhRnJhbWUgfSBmcm9tICdyZWFjdC1uYXRpdmUtc2FmZS1hcmVhLWNvbnRleHQnO1xuXG5pbXBvcnQgdHlwZSB7XG4gIERyYXdlckNvbnRlbnRDb21wb25lbnRQcm9wcyxcbiAgRHJhd2VyRGVzY3JpcHRvck1hcCxcbiAgRHJhd2VySGVhZGVyUHJvcHMsXG4gIERyYXdlck5hdmlnYXRpb25Db25maWcsXG4gIERyYXdlck5hdmlnYXRpb25IZWxwZXJzLFxuICBEcmF3ZXJOYXZpZ2F0aW9uUHJvcCxcbiAgRHJhd2VyUHJvcHMsXG59IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCBEcmF3ZXJQb3NpdGlvbkNvbnRleHQgZnJvbSAnLi4vdXRpbHMvRHJhd2VyUG9zaXRpb25Db250ZXh0JztcbmltcG9ydCBEcmF3ZXJTdGF0dXNDb250ZXh0IGZyb20gJy4uL3V0aWxzL0RyYXdlclN0YXR1c0NvbnRleHQnO1xuaW1wb3J0IGdldERyYXdlclN0YXR1c0Zyb21TdGF0ZSBmcm9tICcuLi91dGlscy9nZXREcmF3ZXJTdGF0dXNGcm9tU3RhdGUnO1xuaW1wb3J0IERyYXdlckNvbnRlbnQgZnJvbSAnLi9EcmF3ZXJDb250ZW50JztcbmltcG9ydCBEcmF3ZXJUb2dnbGVCdXR0b24gZnJvbSAnLi9EcmF3ZXJUb2dnbGVCdXR0b24nO1xuaW1wb3J0IHsgR2VzdHVyZUhhbmRsZXJSb290VmlldyB9IGZyb20gJy4vR2VzdHVyZUhhbmRsZXInO1xuaW1wb3J0IHsgTWF5YmVTY3JlZW4sIE1heWJlU2NyZWVuQ29udGFpbmVyIH0gZnJvbSAnLi9TY3JlZW5GYWxsYmFjayc7XG5cbnR5cGUgUHJvcHMgPSBEcmF3ZXJOYXZpZ2F0aW9uQ29uZmlnICYge1xuICBkZWZhdWx0U3RhdHVzOiBEcmF3ZXJTdGF0dXM7XG4gIHN0YXRlOiBEcmF3ZXJOYXZpZ2F0aW9uU3RhdGU8UGFyYW1MaXN0QmFzZT47XG4gIG5hdmlnYXRpb246IERyYXdlck5hdmlnYXRpb25IZWxwZXJzO1xuICBkZXNjcmlwdG9yczogRHJhd2VyRGVzY3JpcHRvck1hcDtcbn07XG5cbmNvbnN0IGdldERlZmF1bHREcmF3ZXJXaWR0aCA9ICh7XG4gIGhlaWdodCxcbiAgd2lkdGgsXG59OiB7XG4gIGhlaWdodDogbnVtYmVyO1xuICB3aWR0aDogbnVtYmVyO1xufSkgPT4ge1xuICAvKlxuICAgKiBEZWZhdWx0IGRyYXdlciB3aWR0aCBpcyBzY3JlZW4gd2lkdGggLSBoZWFkZXIgaGVpZ2h0XG4gICAqIHdpdGggYSBtYXggd2lkdGggb2YgMjgwIG9uIG1vYmlsZSBhbmQgMzIwIG9uIHRhYmxldFxuICAgKiBodHRwczovL21hdGVyaWFsLmlvL2NvbXBvbmVudHMvbmF2aWdhdGlvbi1kcmF3ZXJcbiAgICovXG4gIGNvbnN0IHNtYWxsZXJBeGlzU2l6ZSA9IE1hdGgubWluKGhlaWdodCwgd2lkdGgpO1xuICBjb25zdCBpc0xhbmRzY2FwZSA9IHdpZHRoID4gaGVpZ2h0O1xuICBjb25zdCBpc1RhYmxldCA9IHNtYWxsZXJBeGlzU2l6ZSA+PSA2MDA7XG4gIGNvbnN0IGFwcEJhckhlaWdodCA9IFBsYXRmb3JtLk9TID09PSAnaW9zJyA/IChpc0xhbmRzY2FwZSA/IDMyIDogNDQpIDogNTY7XG4gIGNvbnN0IG1heFdpZHRoID0gaXNUYWJsZXQgPyAzMjAgOiAyODA7XG5cbiAgcmV0dXJuIE1hdGgubWluKHNtYWxsZXJBeGlzU2l6ZSAtIGFwcEJhckhlaWdodCwgbWF4V2lkdGgpO1xufTtcblxuY29uc3QgR2VzdHVyZUhhbmRsZXJXcmFwcGVyID0gR2VzdHVyZUhhbmRsZXJSb290VmlldyA/PyBWaWV3O1xuXG5mdW5jdGlvbiBEcmF3ZXJWaWV3QmFzZSh7XG4gIHN0YXRlLFxuICBuYXZpZ2F0aW9uLFxuICBkZXNjcmlwdG9ycyxcbiAgZGVmYXVsdFN0YXR1cyxcbiAgZHJhd2VyQ29udGVudCA9IChwcm9wczogRHJhd2VyQ29udGVudENvbXBvbmVudFByb3BzKSA9PiAoXG4gICAgPERyYXdlckNvbnRlbnQgey4uLnByb3BzfSAvPlxuICApLFxuICBkZXRhY2hJbmFjdGl2ZVNjcmVlbnMgPSBQbGF0Zm9ybS5PUyA9PT0gJ3dlYicgfHxcbiAgICBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnIHx8XG4gICAgUGxhdGZvcm0uT1MgPT09ICdpb3MnLFxuICAvLyBSdW5uaW5nIGluIGNocm9tZSBkZWJ1Z2dlclxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIHVzZUxlZ2FjeUltcGxlbWVudGF0aW9uID0gIWdsb2JhbC5uYXRpdmVDYWxsU3luY0hvb2sgfHxcbiAgICAvLyBSZWFuaW1hdGVkIDIgaXMgbm90IGNvbmZpZ3VyZWRcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yOiB0aGUgdHlwZSBkZWZpbml0aW9ucyBhcmUgaW5jb21wbGV0ZVxuICAgICFSZWFuaW1hdGVkLmlzQ29uZmlndXJlZD8uKCksXG59OiBQcm9wcykge1xuICBjb25zdCBEcmF3ZXI6IFJlYWN0LkNvbXBvbmVudFR5cGU8RHJhd2VyUHJvcHM+ID0gdXNlTGVnYWN5SW1wbGVtZW50YXRpb25cbiAgICA/IHJlcXVpcmUoJy4vbGVnYWN5L0RyYXdlcicpLmRlZmF1bHRcbiAgICA6IHJlcXVpcmUoJy4vbW9kZXJuL0RyYXdlcicpLmRlZmF1bHQ7XG5cbiAgY29uc3QgZm9jdXNlZFJvdXRlS2V5ID0gc3RhdGUucm91dGVzW3N0YXRlLmluZGV4XS5rZXk7XG4gIGNvbnN0IHtcbiAgICBkcmF3ZXJIaWRlU3RhdHVzQmFyT25PcGVuID0gZmFsc2UsXG4gICAgZHJhd2VyUG9zaXRpb24gPSBJMThuTWFuYWdlci5pc1JUTCA/ICdyaWdodCcgOiAnbGVmdCcsXG4gICAgZHJhd2VyU3RhdHVzQmFyQW5pbWF0aW9uID0gJ3NsaWRlJyxcbiAgICBkcmF3ZXJTdHlsZSxcbiAgICBkcmF3ZXJUeXBlID0gUGxhdGZvcm0uc2VsZWN0KHsgaW9zOiAnc2xpZGUnLCBkZWZhdWx0OiAnZnJvbnQnIH0pLFxuICAgIGdlc3R1cmVIYW5kbGVyUHJvcHMsXG4gICAga2V5Ym9hcmREaXNtaXNzTW9kZSA9ICdvbi1kcmFnJyxcbiAgICBvdmVybGF5Q29sb3IgPSAncmdiYSgwLCAwLCAwLCAwLjUpJyxcbiAgICBzd2lwZUVkZ2VXaWR0aCA9IDMyLFxuICAgIHN3aXBlRW5hYmxlZCA9IFBsYXRmb3JtLk9TICE9PSAnd2ViJyAmJlxuICAgICAgUGxhdGZvcm0uT1MgIT09ICd3aW5kb3dzJyAmJlxuICAgICAgUGxhdGZvcm0uT1MgIT09ICdtYWNvcycsXG4gICAgc3dpcGVNaW5EaXN0YW5jZSA9IDYwLFxuICB9ID0gZGVzY3JpcHRvcnNbZm9jdXNlZFJvdXRlS2V5XS5vcHRpb25zO1xuXG4gIGNvbnN0IFtsb2FkZWQsIHNldExvYWRlZF0gPSBSZWFjdC51c2VTdGF0ZShbZm9jdXNlZFJvdXRlS2V5XSk7XG5cbiAgaWYgKCFsb2FkZWQuaW5jbHVkZXMoZm9jdXNlZFJvdXRlS2V5KSkge1xuICAgIHNldExvYWRlZChbLi4ubG9hZGVkLCBmb2N1c2VkUm91dGVLZXldKTtcbiAgfVxuXG4gIGNvbnN0IGRpbWVuc2lvbnMgPSB1c2VTYWZlQXJlYUZyYW1lKCk7XG5cbiAgY29uc3QgeyBjb2xvcnMgfSA9IHVzZVRoZW1lKCk7XG5cbiAgY29uc3QgZHJhd2VyU3RhdHVzID0gZ2V0RHJhd2VyU3RhdHVzRnJvbVN0YXRlKHN0YXRlKTtcblxuICBjb25zdCBoYW5kbGVEcmF3ZXJPcGVuID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIG5hdmlnYXRpb24uZGlzcGF0Y2goe1xuICAgICAgLi4uRHJhd2VyQWN0aW9ucy5vcGVuRHJhd2VyKCksXG4gICAgICB0YXJnZXQ6IHN0YXRlLmtleSxcbiAgICB9KTtcbiAgfSwgW25hdmlnYXRpb24sIHN0YXRlLmtleV0pO1xuXG4gIGNvbnN0IGhhbmRsZURyYXdlckNsb3NlID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIG5hdmlnYXRpb24uZGlzcGF0Y2goe1xuICAgICAgLi4uRHJhd2VyQWN0aW9ucy5jbG9zZURyYXdlcigpLFxuICAgICAgdGFyZ2V0OiBzdGF0ZS5rZXksXG4gICAgfSk7XG4gIH0sIFtuYXZpZ2F0aW9uLCBzdGF0ZS5rZXldKTtcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChkcmF3ZXJTdGF0dXMgPT09IGRlZmF1bHRTdGF0dXMgfHwgZHJhd2VyVHlwZSA9PT0gJ3Blcm1hbmVudCcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBoYW5kbGVIYXJkd2FyZUJhY2sgPSAoKSA9PiB7XG4gICAgICAvLyBXZSBzaG91bGRuJ3QgaGFuZGxlIHRoZSBiYWNrIGJ1dHRvbiBpZiB0aGUgcGFyZW50IHNjcmVlbiBpc24ndCBmb2N1c2VkXG4gICAgICAvLyBUaGlzIHdpbGwgYXZvaWQgdGhlIGRyYXdlciBvdmVycmlkaW5nIGV2ZW50IGxpc3RlbmVycyBmcm9tIGEgZm9jdXNlZCBzY3JlZW5cbiAgICAgIGlmICghbmF2aWdhdGlvbi5pc0ZvY3VzZWQoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChkZWZhdWx0U3RhdHVzID09PSAnb3BlbicpIHtcbiAgICAgICAgaGFuZGxlRHJhd2VyT3BlbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGFuZGxlRHJhd2VyQ2xvc2UoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZUVzY2FwZSA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIGhhbmRsZUhhcmR3YXJlQmFjaygpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBXZSBvbmx5IGFkZCB0aGUgbGlzdGVuZXJzIHdoZW4gZHJhd2VyIG9wZW5zXG4gICAgLy8gVGhpcyB3YXkgd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IHRoZSBsaXN0ZW5lciBpcyBhZGRlZCBhcyBsYXRlIGFzIHBvc3NpYmxlXG4gICAgLy8gVGhpcyB3aWxsIG1ha2Ugc3VyZSB0aGF0IG91ciBoYW5kbGVyIHdpbGwgcnVuIGZpcnN0IHdoZW4gYmFjayBidXR0b24gaXMgcHJlc3NlZFxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IEJhY2tIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnaGFyZHdhcmVCYWNrUHJlc3MnLFxuICAgICAgaGFuZGxlSGFyZHdhcmVCYWNrXG4gICAgKTtcblxuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ3dlYicpIHtcbiAgICAgIGRvY3VtZW50Py5ib2R5Py5hZGRFdmVudExpc3RlbmVyPy4oJ2tleXVwJywgaGFuZGxlRXNjYXBlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgc3Vic2NyaXB0aW9uLnJlbW92ZSgpO1xuXG4gICAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICd3ZWInKSB7XG4gICAgICAgIGRvY3VtZW50Py5ib2R5Py5yZW1vdmVFdmVudExpc3RlbmVyPy4oJ2tleXVwJywgaGFuZGxlRXNjYXBlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbXG4gICAgZGVmYXVsdFN0YXR1cyxcbiAgICBkcmF3ZXJTdGF0dXMsXG4gICAgZHJhd2VyVHlwZSxcbiAgICBoYW5kbGVEcmF3ZXJDbG9zZSxcbiAgICBoYW5kbGVEcmF3ZXJPcGVuLFxuICAgIG5hdmlnYXRpb24sXG4gIF0pO1xuXG4gIGNvbnN0IHJlbmRlckRyYXdlckNvbnRlbnQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxEcmF3ZXJQb3NpdGlvbkNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2RyYXdlclBvc2l0aW9ufT5cbiAgICAgICAge2RyYXdlckNvbnRlbnQoe1xuICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICBuYXZpZ2F0aW9uOiBuYXZpZ2F0aW9uLFxuICAgICAgICAgIGRlc2NyaXB0b3JzOiBkZXNjcmlwdG9ycyxcbiAgICAgICAgfSl9XG4gICAgICA8L0RyYXdlclBvc2l0aW9uQ29udGV4dC5Qcm92aWRlcj5cbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IHJlbmRlclNjZW5lQ29udGVudCA9ICgpID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgPE1heWJlU2NyZWVuQ29udGFpbmVyXG4gICAgICAgIGVuYWJsZWQ9e2RldGFjaEluYWN0aXZlU2NyZWVuc31cbiAgICAgICAgaGFzVHdvU3RhdGVzXG4gICAgICAgIHN0eWxlPXtzdHlsZXMuY29udGVudH1cbiAgICAgID5cbiAgICAgICAge3N0YXRlLnJvdXRlcy5tYXAoKHJvdXRlLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBkZXNjcmlwdG9yc1tyb3V0ZS5rZXldO1xuICAgICAgICAgIGNvbnN0IHsgbGF6eSA9IHRydWUsIHVubW91bnRPbkJsdXIgfSA9IGRlc2NyaXB0b3Iub3B0aW9ucztcbiAgICAgICAgICBjb25zdCBpc0ZvY3VzZWQgPSBzdGF0ZS5pbmRleCA9PT0gaW5kZXg7XG5cbiAgICAgICAgICBpZiAodW5tb3VudE9uQmx1ciAmJiAhaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAobGF6eSAmJiAhbG9hZGVkLmluY2x1ZGVzKHJvdXRlLmtleSkgJiYgIWlzRm9jdXNlZCkge1xuICAgICAgICAgICAgLy8gRG9uJ3QgcmVuZGVyIGEgbGF6eSBzY3JlZW4gaWYgd2UndmUgbmV2ZXIgbmF2aWdhdGVkIHRvIGl0XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBoZWFkZXIgPSAoeyBsYXlvdXQsIG9wdGlvbnMgfTogRHJhd2VySGVhZGVyUHJvcHMpID0+IChcbiAgICAgICAgICAgICAgPEhlYWRlclxuICAgICAgICAgICAgICAgIHsuLi5vcHRpb25zfVxuICAgICAgICAgICAgICAgIGxheW91dD17bGF5b3V0fVxuICAgICAgICAgICAgICAgIHRpdGxlPXtnZXRIZWFkZXJUaXRsZShvcHRpb25zLCByb3V0ZS5uYW1lKX1cbiAgICAgICAgICAgICAgICBoZWFkZXJMZWZ0PXtcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVyTGVmdCA/P1xuICAgICAgICAgICAgICAgICAgKChwcm9wcykgPT4gPERyYXdlclRvZ2dsZUJ1dHRvbiB7Li4ucHJvcHN9IC8+KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBzY2VuZUNvbnRhaW5lclN0eWxlLFxuICAgICAgICAgIH0gPSBkZXNjcmlwdG9yLm9wdGlvbnM7XG5cbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE1heWJlU2NyZWVuXG4gICAgICAgICAgICAgIGtleT17cm91dGUua2V5fVxuICAgICAgICAgICAgICBzdHlsZT17W1N0eWxlU2hlZXQuYWJzb2x1dGVGaWxsLCB7IHpJbmRleDogaXNGb2N1c2VkID8gMCA6IC0xIH1dfVxuICAgICAgICAgICAgICB2aXNpYmxlPXtpc0ZvY3VzZWR9XG4gICAgICAgICAgICAgIGVuYWJsZWQ9e2RldGFjaEluYWN0aXZlU2NyZWVuc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFNjcmVlblxuICAgICAgICAgICAgICAgIGZvY3VzZWQ9e2lzRm9jdXNlZH1cbiAgICAgICAgICAgICAgICByb3V0ZT17ZGVzY3JpcHRvci5yb3V0ZX1cbiAgICAgICAgICAgICAgICBuYXZpZ2F0aW9uPXtkZXNjcmlwdG9yLm5hdmlnYXRpb259XG4gICAgICAgICAgICAgICAgaGVhZGVyU2hvd249e2Rlc2NyaXB0b3Iub3B0aW9ucy5oZWFkZXJTaG93bn1cbiAgICAgICAgICAgICAgICBoZWFkZXJUcmFuc3BhcmVudD17ZGVzY3JpcHRvci5vcHRpb25zLmhlYWRlclRyYW5zcGFyZW50fVxuICAgICAgICAgICAgICAgIGhlYWRlclN0YXR1c0JhckhlaWdodD17ZGVzY3JpcHRvci5vcHRpb25zLmhlYWRlclN0YXR1c0JhckhlaWdodH1cbiAgICAgICAgICAgICAgICBoZWFkZXI9e2hlYWRlcih7XG4gICAgICAgICAgICAgICAgICBsYXlvdXQ6IGRpbWVuc2lvbnMsXG4gICAgICAgICAgICAgICAgICByb3V0ZTogZGVzY3JpcHRvci5yb3V0ZSxcbiAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb246XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0b3IubmF2aWdhdGlvbiBhcyBEcmF3ZXJOYXZpZ2F0aW9uUHJvcDxQYXJhbUxpc3RCYXNlPixcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGRlc2NyaXB0b3Iub3B0aW9ucyxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICBzdHlsZT17c2NlbmVDb250YWluZXJTdHlsZX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtkZXNjcmlwdG9yLnJlbmRlcigpfVxuICAgICAgICAgICAgICA8L1NjcmVlbj5cbiAgICAgICAgICAgIDwvTWF5YmVTY3JlZW4+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L01heWJlU2NyZWVuQ29udGFpbmVyPlxuICAgICk7XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8RHJhd2VyU3RhdHVzQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17ZHJhd2VyU3RhdHVzfT5cbiAgICAgIDxEcmF3ZXJcbiAgICAgICAgb3Blbj17ZHJhd2VyU3RhdHVzICE9PSAnY2xvc2VkJ31cbiAgICAgICAgb25PcGVuPXtoYW5kbGVEcmF3ZXJPcGVufVxuICAgICAgICBvbkNsb3NlPXtoYW5kbGVEcmF3ZXJDbG9zZX1cbiAgICAgICAgZ2VzdHVyZUhhbmRsZXJQcm9wcz17Z2VzdHVyZUhhbmRsZXJQcm9wc31cbiAgICAgICAgc3dpcGVFbmFibGVkPXtzd2lwZUVuYWJsZWR9XG4gICAgICAgIHN3aXBlRWRnZVdpZHRoPXtzd2lwZUVkZ2VXaWR0aH1cbiAgICAgICAgc3dpcGVWZWxvY2l0eVRocmVzaG9sZD17NTAwfVxuICAgICAgICBzd2lwZURpc3RhbmNlVGhyZXNob2xkPXtzd2lwZU1pbkRpc3RhbmNlfVxuICAgICAgICBoaWRlU3RhdHVzQmFyT25PcGVuPXtkcmF3ZXJIaWRlU3RhdHVzQmFyT25PcGVufVxuICAgICAgICBzdGF0dXNCYXJBbmltYXRpb249e2RyYXdlclN0YXR1c0JhckFuaW1hdGlvbn1cbiAgICAgICAga2V5Ym9hcmREaXNtaXNzTW9kZT17a2V5Ym9hcmREaXNtaXNzTW9kZX1cbiAgICAgICAgZHJhd2VyVHlwZT17ZHJhd2VyVHlwZX1cbiAgICAgICAgZHJhd2VyUG9zaXRpb249e2RyYXdlclBvc2l0aW9ufVxuICAgICAgICBkcmF3ZXJTdHlsZT17W1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHdpZHRoOiBnZXREZWZhdWx0RHJhd2VyV2lkdGgoZGltZW5zaW9ucyksXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGNvbG9ycy5jYXJkLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZHJhd2VyVHlwZSA9PT0gJ3Blcm1hbmVudCcgJiZcbiAgICAgICAgICAgIChkcmF3ZXJQb3NpdGlvbiA9PT0gJ2xlZnQnXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgYm9yZGVyUmlnaHRDb2xvcjogY29sb3JzLmJvcmRlcixcbiAgICAgICAgICAgICAgICAgIGJvcmRlclJpZ2h0V2lkdGg6IFN0eWxlU2hlZXQuaGFpcmxpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgYm9yZGVyTGVmdENvbG9yOiBjb2xvcnMuYm9yZGVyLFxuICAgICAgICAgICAgICAgICAgYm9yZGVyTGVmdFdpZHRoOiBTdHlsZVNoZWV0LmhhaXJsaW5lV2lkdGgsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgZHJhd2VyU3R5bGUsXG4gICAgICAgIF19XG4gICAgICAgIG92ZXJsYXlTdHlsZT17eyBiYWNrZ3JvdW5kQ29sb3I6IG92ZXJsYXlDb2xvciB9fVxuICAgICAgICByZW5kZXJEcmF3ZXJDb250ZW50PXtyZW5kZXJEcmF3ZXJDb250ZW50fVxuICAgICAgICByZW5kZXJTY2VuZUNvbnRlbnQ9e3JlbmRlclNjZW5lQ29udGVudH1cbiAgICAgICAgZGltZW5zaW9ucz17ZGltZW5zaW9uc31cbiAgICAgIC8+XG4gICAgPC9EcmF3ZXJTdGF0dXNDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEcmF3ZXJWaWV3KHsgbmF2aWdhdGlvbiwgLi4ucmVzdCB9OiBQcm9wcykge1xuICByZXR1cm4gKFxuICAgIDxTYWZlQXJlYVByb3ZpZGVyQ29tcGF0PlxuICAgICAgPEdlc3R1cmVIYW5kbGVyV3JhcHBlciBzdHlsZT17c3R5bGVzLmNvbnRlbnR9PlxuICAgICAgICA8RHJhd2VyVmlld0Jhc2UgbmF2aWdhdGlvbj17bmF2aWdhdGlvbn0gey4uLnJlc3R9IC8+XG4gICAgICA8L0dlc3R1cmVIYW5kbGVyV3JhcHBlcj5cbiAgICA8L1NhZmVBcmVhUHJvdmlkZXJDb21wYXQ+XG4gICk7XG59XG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgY29udGVudDoge1xuICAgIGZsZXg6IDEsXG4gIH0sXG59KTtcbiJdfQ==