30aee6b5e78241d26b08523097b5db52
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.FABGroup = exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _color = _interopRequireDefault(require("color"));

var _FAB = _interopRequireDefault(require("./FAB"));

var _Text = _interopRequireDefault(require("../Typography/Text"));

var _Card = _interopRequireDefault(require("../Card/Card"));

var _theming = require("../../core/theming");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

var FABGroup = function FABGroup(_ref) {
  var actions = _ref.actions,
      icon = _ref.icon,
      open = _ref.open,
      _onPress = _ref.onPress,
      accessibilityLabel = _ref.accessibilityLabel,
      theme = _ref.theme,
      style = _ref.style,
      fabStyle = _ref.fabStyle,
      visible = _ref.visible,
      testID = _ref.testID,
      onStateChange = _ref.onStateChange,
      colorProp = _ref.color;

  var _React$useRef = React.useRef(new _reactNative.Animated.Value(0)),
      backdrop = _React$useRef.current;

  var animations = React.useRef(actions.map(function () {
    return new _reactNative.Animated.Value(open ? 1 : 0);
  }));

  var _React$useState = React.useState(null),
      _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
      prevActions = _React$useState2[0],
      setPrevActions = _React$useState2[1];

  var scale = theme.animation.scale;
  React.useEffect(function () {
    if (open) {
      _reactNative.Animated.parallel([_reactNative.Animated.timing(backdrop, {
        toValue: 1,
        duration: 250 * scale,
        useNativeDriver: true
      }), _reactNative.Animated.stagger(50 * scale, animations.current.map(function (animation) {
        return _reactNative.Animated.timing(animation, {
          toValue: 1,
          duration: 150 * scale,
          useNativeDriver: true
        });
      }).reverse())]).start();
    } else {
      _reactNative.Animated.parallel([_reactNative.Animated.timing(backdrop, {
        toValue: 0,
        duration: 200 * scale,
        useNativeDriver: true
      })].concat((0, _toConsumableArray2.default)(animations.current.map(function (animation) {
        return _reactNative.Animated.timing(animation, {
          toValue: 0,
          duration: 150 * scale,
          useNativeDriver: true
        });
      })))).start();
    }
  }, [open, actions, backdrop, scale]);

  var close = function close() {
    return onStateChange({
      open: false
    });
  };

  var toggle = function toggle() {
    return onStateChange({
      open: !open
    });
  };

  var colors = theme.colors;
  var labelColor = theme.dark ? colors.text : (0, _color.default)(colors.text).fade(0.54).rgb().string();
  var backdropOpacity = open ? backdrop.interpolate({
    inputRange: [0, 0.5, 1],
    outputRange: [0, 1, 1]
  }) : backdrop;
  var opacities = animations.current;
  var scales = opacities.map(function (opacity) {
    return open ? opacity.interpolate({
      inputRange: [0, 1],
      outputRange: [0.8, 1]
    }) : 1;
  });

  if (actions.length !== (prevActions === null || prevActions === void 0 ? void 0 : prevActions.length)) {
    animations.current = actions.map(function (_, i) {
      return animations.current[i] || new _reactNative.Animated.Value(open ? 1 : 0);
    });
    setPrevActions(actions);
  }

  return React.createElement(_reactNative.View, {
    pointerEvents: "box-none",
    style: [styles.container, style]
  }, React.createElement(_reactNative.TouchableWithoutFeedback, {
    onPress: close
  }, React.createElement(_reactNative.Animated.View, {
    pointerEvents: open ? 'auto' : 'none',
    style: [styles.backdrop, {
      opacity: backdropOpacity,
      backgroundColor: colors.backdrop
    }]
  })), React.createElement(_reactNative.SafeAreaView, {
    pointerEvents: "box-none",
    style: styles.safeArea
  }, React.createElement(_reactNative.View, {
    pointerEvents: open ? 'box-none' : 'none'
  }, actions.map(function (it, i) {
    var _it$labelTextColor;

    return React.createElement(_reactNative.View, {
      key: i,
      style: [styles.item, {
        marginHorizontal: typeof it.small === 'undefined' || it.small ? 24 : 16
      }],
      pointerEvents: open ? 'box-none' : 'none'
    }, it.label && React.createElement(_reactNative.View, null, React.createElement(_Card.default, {
      style: [styles.label, {
        transform: [{
          scale: scales[i]
        }],
        opacity: opacities[i]
      }, it.labelStyle],
      onPress: function onPress() {
        it.onPress();
        close();
      },
      accessibilityLabel: it.accessibilityLabel !== 'undefined' ? it.accessibilityLabel : it.label,
      accessibilityTraits: "button",
      accessibilityComponentType: "button",
      accessibilityRole: "button"
    }, React.createElement(_Text.default, {
      style: {
        color: (_it$labelTextColor = it.labelTextColor) !== null && _it$labelTextColor !== void 0 ? _it$labelTextColor : labelColor
      }
    }, it.label))), React.createElement(_FAB.default, {
      small: typeof it.small !== 'undefined' ? it.small : true,
      icon: it.icon,
      color: it.color,
      style: [{
        transform: [{
          scale: scales[i]
        }],
        opacity: opacities[i],
        backgroundColor: theme.colors.surface
      }, it.style],
      onPress: function onPress() {
        it.onPress();
        close();
      },
      accessibilityLabel: typeof it.accessibilityLabel !== 'undefined' ? it.accessibilityLabel : it.label,
      accessibilityTraits: "button",
      accessibilityComponentType: "button",
      accessibilityRole: "button",
      testID: it.testID,
      visible: open
    }));
  })), React.createElement(_FAB.default, {
    onPress: function onPress() {
      _onPress === null || _onPress === void 0 ? void 0 : _onPress();
      toggle();
    },
    icon: icon,
    color: colorProp,
    accessibilityLabel: accessibilityLabel,
    accessibilityTraits: "button",
    accessibilityComponentType: "button",
    accessibilityRole: "button",
    accessibilityState: {
      expanded: open
    },
    style: [styles.fab, fabStyle],
    visible: visible,
    testID: testID
  })));
};

FABGroup.displayName = 'FAB.Group';

var _default = (0, _theming.withTheme)(FABGroup);

exports.default = _default;
var FABGroupWithTheme = (0, _theming.withTheme)(FABGroup);
exports.FABGroup = FABGroupWithTheme;

var styles = _reactNative.StyleSheet.create({
  safeArea: {
    alignItems: 'flex-end'
  },
  container: (0, _extends2.default)({}, _reactNative.StyleSheet.absoluteFillObject, {
    justifyContent: 'flex-end'
  }),
  fab: {
    marginHorizontal: 16,
    marginBottom: 16,
    marginTop: 0
  },
  backdrop: (0, _extends2.default)({}, _reactNative.StyleSheet.absoluteFillObject),
  label: {
    borderRadius: 5,
    paddingHorizontal: 12,
    paddingVertical: 6,
    marginVertical: 8,
    marginHorizontal: 16,
    elevation: 2
  },
  item: {
    marginBottom: 16,
    flexDirection: 'row',
    justifyContent: 'flex-end',
    alignItems: 'center'
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFO0FBSlI7QUF4QnlCLENBQWxCRixDQUFmIiwibmFtZXMiOlsiRkFCR3JvdXAiLCJhY3Rpb25zIiwiaWNvbiIsIm9wZW4iLCJvblByZXNzIiwiYWNjZXNzaWJpbGl0eUxhYmVsIiwidGhlbWUiLCJzdHlsZSIsImZhYlN0eWxlIiwidmlzaWJsZSIsInRlc3RJRCIsIm9uU3RhdGVDaGFuZ2UiLCJjb2xvclByb3AiLCJjb2xvciIsIlJlYWN0IiwidXNlUmVmIiwiQW5pbWF0ZWQiLCJWYWx1ZSIsImJhY2tkcm9wIiwiY3VycmVudCIsImFuaW1hdGlvbnMiLCJtYXAiLCJ1c2VTdGF0ZSIsInByZXZBY3Rpb25zIiwic2V0UHJldkFjdGlvbnMiLCJzY2FsZSIsImFuaW1hdGlvbiIsInVzZUVmZmVjdCIsInBhcmFsbGVsIiwidGltaW5nIiwidG9WYWx1ZSIsImR1cmF0aW9uIiwidXNlTmF0aXZlRHJpdmVyIiwic3RhZ2dlciIsInJldmVyc2UiLCJzdGFydCIsImNsb3NlIiwidG9nZ2xlIiwiY29sb3JzIiwibGFiZWxDb2xvciIsImRhcmsiLCJ0ZXh0IiwiZmFkZSIsInJnYiIsInN0cmluZyIsImJhY2tkcm9wT3BhY2l0eSIsImludGVycG9sYXRlIiwiaW5wdXRSYW5nZSIsIm91dHB1dFJhbmdlIiwib3BhY2l0aWVzIiwic2NhbGVzIiwib3BhY2l0eSIsImxlbmd0aCIsIl8iLCJpIiwiX3JlYWN0TmF0aXZlIiwicG9pbnRlckV2ZW50cyIsInN0eWxlcyIsImNvbnRhaW5lciIsIlZpZXciLCJiYWNrZ3JvdW5kQ29sb3IiLCJzYWZlQXJlYSIsIml0Iiwia2V5IiwiaXRlbSIsIm1hcmdpbkhvcml6b250YWwiLCJzbWFsbCIsImxhYmVsIiwiX0NhcmQiLCJ0cmFuc2Zvcm0iLCJsYWJlbFN0eWxlIiwiYWNjZXNzaWJpbGl0eVRyYWl0cyIsImFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlIiwiYWNjZXNzaWJpbGl0eVJvbGUiLCJfVGV4dCIsImxhYmVsVGV4dENvbG9yIiwiX0ZBQiIsInN1cmZhY2UiLCJhY2Nlc3NpYmlsaXR5U3RhdGUiLCJleHBhbmRlZCIsImZhYiIsImRpc3BsYXlOYW1lIiwiRkFCR3JvdXBXaXRoVGhlbWUiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwiYWxpZ25JdGVtcyIsImFic29sdXRlRmlsbE9iamVjdCIsImp1c3RpZnlDb250ZW50IiwibWFyZ2luQm90dG9tIiwibWFyZ2luVG9wIiwiYm9yZGVyUmFkaXVzIiwicGFkZGluZ0hvcml6b250YWwiLCJwYWRkaW5nVmVydGljYWwiLCJtYXJnaW5WZXJ0aWNhbCIsImVsZXZhdGlvbiIsImZsZXhEaXJlY3Rpb24iXSwic291cmNlcyI6WyJGQUJHcm91cC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgU3R5bGVQcm9wLFxuICBTdHlsZVNoZWV0LFxuICBBbmltYXRlZCxcbiAgU2FmZUFyZWFWaWV3LFxuICBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2ssXG4gIFZpZXcsXG4gIFZpZXdTdHlsZSxcbn0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBjb2xvciBmcm9tICdjb2xvcic7XG5pbXBvcnQgRkFCIGZyb20gJy4vRkFCJztcbmltcG9ydCBUZXh0IGZyb20gJy4uL1R5cG9ncmFwaHkvVGV4dCc7XG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9DYXJkL0NhcmQnO1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnLi4vLi4vY29yZS90aGVtaW5nJztcbmltcG9ydCB0eXBlIHsgSWNvblNvdXJjZSB9IGZyb20gJy4uL0ljb24nO1xuXG50eXBlIFByb3BzID0ge1xuICAvKipcbiAgICogQWN0aW9uIGl0ZW1zIHRvIGRpc3BsYXkgaW4gdGhlIGZvcm0gb2YgYSBzcGVlZCBkaWFsLlxuICAgKiBBbiBhY3Rpb24gaXRlbSBzaG91bGQgY29udGFpbiB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAqIC0gYGljb25gOiBpY29uIHRvIGRpc3BsYXkgKHJlcXVpcmVkKVxuICAgKiAtIGBsYWJlbGA6IG9wdGlvbmFsIGxhYmVsIHRleHRcbiAgICogLSBgYWNjZXNzaWJpbGl0eUxhYmVsYDogYWNjZXNzaWJpbGl0eSBsYWJlbCBmb3IgdGhlIGFjdGlvbiwgdXNlcyBsYWJlbCBieSBkZWZhdWx0IGlmIHNwZWNpZmllZFxuICAgKiAtIGBjb2xvcmA6IGN1c3RvbSBpY29uIGNvbG9yIG9mIHRoZSBhY3Rpb24gaXRlbVxuICAgKiAtIGBsYWJlbFRleHRDb2xvcmA6IGN1c3RvbSBsYWJlbCB0ZXh0IGNvbG9yIG9mIHRoZSBhY3Rpb24gaXRlbVxuICAgKiAtIGBzdHlsZWA6IHBhc3MgYWRkaXRpb25hbCBzdHlsZXMgZm9yIHRoZSBmYWIgaXRlbSwgZm9yIGV4YW1wbGUsIGBiYWNrZ3JvdW5kQ29sb3JgXG4gICAqIC0gYGxhYmVsU3R5bGVgOiBwYXNzIGFkZGl0aW9uYWwgc3R5bGVzIGZvciB0aGUgZmFiIGl0ZW0gbGFiZWwsIGZvciBleGFtcGxlLCBgYmFja2dyb3VuZENvbG9yYFxuICAgKiAtIGBzbWFsbGA6IGJvb2xlYW4gZGVzY3JpYmluZyB3aGV0aGVyIHNtYWxsIG9yIG5vcm1hbCBzaXplZCBGQUIgaXMgcmVuZGVyZWQuIERlZmF1bHRzIHRvIGB0cnVlYFxuICAgKiAtIGBvblByZXNzYDogY2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiBgRkFCYCBpcyBwcmVzc2VkIChyZXF1aXJlZClcbiAgICovXG4gIGFjdGlvbnM6IEFycmF5PHtcbiAgICBpY29uOiBJY29uU291cmNlO1xuICAgIGxhYmVsPzogc3RyaW5nO1xuICAgIGNvbG9yPzogc3RyaW5nO1xuICAgIGxhYmVsVGV4dENvbG9yPzogc3RyaW5nO1xuICAgIGFjY2Vzc2liaWxpdHlMYWJlbD86IHN0cmluZztcbiAgICBzdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICAgIGxhYmVsU3R5bGU/OiBTdHlsZVByb3A8Vmlld1N0eWxlPjtcbiAgICBzbWFsbD86IGJvb2xlYW47XG4gICAgb25QcmVzczogKCkgPT4gdm9pZDtcbiAgICB0ZXN0SUQ/OiBzdHJpbmc7XG4gIH0+O1xuICAvKipcbiAgICogSWNvbiB0byBkaXNwbGF5IGZvciB0aGUgYEZBQmAuXG4gICAqIFlvdSBjYW4gdG9nZ2xlIGl0IGJhc2VkIG9uIHdoZXRoZXIgdGhlIHNwZWVkIGRpYWwgaXMgb3BlbiB0byBkaXNwbGF5IGEgZGlmZmVyZW50IGljb24uXG4gICAqL1xuICBpY29uOiBJY29uU291cmNlO1xuICAvKipcbiAgICogQWNjZXNzaWJpbGl0eSBsYWJlbCBmb3IgdGhlIEZBQi4gVGhpcyBpcyByZWFkIGJ5IHRoZSBzY3JlZW4gcmVhZGVyIHdoZW4gdGhlIHVzZXIgdGFwcyB0aGUgRkFCLlxuICAgKi9cbiAgYWNjZXNzaWJpbGl0eUxhYmVsPzogc3RyaW5nO1xuICAvKipcbiAgICogQ3VzdG9tIGNvbG9yIGZvciB0aGUgYEZBQmAuXG4gICAqL1xuICBjb2xvcj86IHN0cmluZztcbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHRvIGV4ZWN1dGUgb24gcHJlc3NpbmcgdGhlIGBGQUJgLlxuICAgKi9cbiAgb25QcmVzcz86ICgpID0+IHZvaWQ7XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBzcGVlZCBkaWFsIGlzIG9wZW4uXG4gICAqL1xuICBvcGVuOiBib29sZWFuO1xuICAvKipcbiAgICogQ2FsbGJhY2sgd2hpY2ggaXMgY2FsbGVkIG9uIG9wZW5pbmcgYW5kIGNsb3NpbmcgdGhlIHNwZWVkIGRpYWwuXG4gICAqIFRoZSBvcGVuIHN0YXRlIG5lZWRzIHRvIGJlIHVwZGF0ZWQgd2hlbiBpdCdzIGNhbGxlZCwgb3RoZXJ3aXNlIHRoZSBjaGFuZ2UgaXMgZHJvcHBlZC5cbiAgICovXG4gIG9uU3RhdGVDaGFuZ2U6IChzdGF0ZTogeyBvcGVuOiBib29sZWFuIH0pID0+IHZvaWQ7XG4gIC8qKlxuICAgKiBXaGV0aGVyIGBGQUJgIGlzIGN1cnJlbnRseSB2aXNpYmxlLlxuICAgKi9cbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgLyoqXG4gICAqIFN0eWxlIGZvciB0aGUgZ3JvdXAuIFlvdSBjYW4gdXNlIGl0IHRvIHBhc3MgYWRkaXRpb25hbCBzdHlsZXMgaWYgeW91IG5lZWQuXG4gICAqIEZvciBleGFtcGxlLCB5b3UgY2FuIHNldCBhbiBhZGRpdGlvbmFsIHBhZGRpbmcgaWYgeW91IGhhdmUgYSB0YWIgYmFyIGF0IHRoZSBib3R0b20uXG4gICAqL1xuICBzdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICAvKipcbiAgICogU3R5bGUgZm9yIHRoZSBGQUIuIEl0IGFsbG93cyB0byBwYXNzIHRoZSBGQUIgYnV0dG9uIHN0eWxlcywgc3VjaCBhcyBiYWNrZ3JvdW5kQ29sb3IuXG4gICAqL1xuICBmYWJTdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqL1xuICB0aGVtZTogUmVhY3ROYXRpdmVQYXBlci5UaGVtZTtcbiAgLyoqXG4gICAqIFBhc3MgZG93biB0ZXN0SUQgZnJvbSBHcm91cCBwcm9wcyB0byBGQUIuXG4gICAqL1xuICB0ZXN0SUQ/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIEEgY29tcG9uZW50IHRvIGRpc3BsYXkgYSBzdGFjayBvZiBGQUJzIHdpdGggcmVsYXRlZCBhY3Rpb25zIGluIGEgc3BlZWQgZGlhbC5cbiAqIFRvIHJlbmRlciB0aGUgZ3JvdXAgYWJvdmUgb3RoZXIgY29tcG9uZW50cywgeW91J2xsIG5lZWQgdG8gd3JhcCBpdCB3aXRoIHRoZSBbYFBvcnRhbGBdKHBvcnRhbC5odG1sKSBjb21wb25lbnQuXG4gKlxuICogPGRpdiBjbGFzcz1cInNjcmVlbnNob3RzXCI+XG4gKiAgIDxpbWcgc3JjPVwic2NyZWVuc2hvdHMvZmFiLWdyb3VwLnBuZ1wiIC8+XG4gKiA8L2Rpdj5cbiAqXG4gKiAjIyBVc2FnZVxuICogYGBganNcbiAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAqIGltcG9ydCB7IEZBQiwgUG9ydGFsLCBQcm92aWRlciB9IGZyb20gJ3JlYWN0LW5hdGl2ZS1wYXBlcic7XG4gKlxuICogY29uc3QgTXlDb21wb25lbnQgPSAoKSA9PiB7XG4gKiAgIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gUmVhY3QudXNlU3RhdGUoeyBvcGVuOiBmYWxzZSB9KTtcbiAqXG4gKiAgIGNvbnN0IG9uU3RhdGVDaGFuZ2UgPSAoeyBvcGVuIH0pID0+IHNldFN0YXRlKHsgb3BlbiB9KTtcbiAqXG4gKiAgIGNvbnN0IHsgb3BlbiB9ID0gc3RhdGU7XG4gKlxuICogICByZXR1cm4gKFxuICogICAgIDxQcm92aWRlcj5cbiAqICAgICAgIDxQb3J0YWw+XG4gKiAgICAgICAgIDxGQUIuR3JvdXBcbiAqICAgICAgICAgICBvcGVuPXtvcGVufVxuICogICAgICAgICAgIGljb249e29wZW4gPyAnY2FsZW5kYXItdG9kYXknIDogJ3BsdXMnfVxuICogICAgICAgICAgIGFjdGlvbnM9e1tcbiAqICAgICAgICAgICAgIHsgaWNvbjogJ3BsdXMnLCBvblByZXNzOiAoKSA9PiBjb25zb2xlLmxvZygnUHJlc3NlZCBhZGQnKSB9LFxuICogICAgICAgICAgICAge1xuICogICAgICAgICAgICAgICBpY29uOiAnc3RhcicsXG4gKiAgICAgICAgICAgICAgIGxhYmVsOiAnU3RhcicsXG4gKiAgICAgICAgICAgICAgIG9uUHJlc3M6ICgpID0+IGNvbnNvbGUubG9nKCdQcmVzc2VkIHN0YXInKSxcbiAqICAgICAgICAgICAgIH0sXG4gKiAgICAgICAgICAgICB7XG4gKiAgICAgICAgICAgICAgIGljb246ICdlbWFpbCcsXG4gKiAgICAgICAgICAgICAgIGxhYmVsOiAnRW1haWwnLFxuICogICAgICAgICAgICAgICBvblByZXNzOiAoKSA9PiBjb25zb2xlLmxvZygnUHJlc3NlZCBlbWFpbCcpLFxuICogICAgICAgICAgICAgfSxcbiAqICAgICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICAgaWNvbjogJ2JlbGwnLFxuICogICAgICAgICAgICAgICBsYWJlbDogJ1JlbWluZCcsXG4gKiAgICAgICAgICAgICAgIG9uUHJlc3M6ICgpID0+IGNvbnNvbGUubG9nKCdQcmVzc2VkIG5vdGlmaWNhdGlvbnMnKSxcbiAqICAgICAgICAgICAgICAgc21hbGw6IGZhbHNlLFxuICogICAgICAgICAgICAgfSxcbiAqICAgICAgICAgICBdfVxuICogICAgICAgICAgIG9uU3RhdGVDaGFuZ2U9e29uU3RhdGVDaGFuZ2V9XG4gKiAgICAgICAgICAgb25QcmVzcz17KCkgPT4ge1xuICogICAgICAgICAgICAgaWYgKG9wZW4pIHtcbiAqICAgICAgICAgICAgICAgLy8gZG8gc29tZXRoaW5nIGlmIHRoZSBzcGVlZCBkaWFsIGlzIG9wZW5cbiAqICAgICAgICAgICAgIH1cbiAqICAgICAgICAgICB9fVxuICogICAgICAgICAvPlxuICogICAgICAgPC9Qb3J0YWw+XG4gKiAgICAgPC9Qcm92aWRlcj5cbiAqICAgKTtcbiAqIH07XG4gKlxuICogZXhwb3J0IGRlZmF1bHQgTXlDb21wb25lbnQ7XG4gKiBgYGBcbiAqL1xuY29uc3QgRkFCR3JvdXAgPSAoe1xuICBhY3Rpb25zLFxuICBpY29uLFxuICBvcGVuLFxuICBvblByZXNzLFxuICBhY2Nlc3NpYmlsaXR5TGFiZWwsXG4gIHRoZW1lLFxuICBzdHlsZSxcbiAgZmFiU3R5bGUsXG4gIHZpc2libGUsXG4gIHRlc3RJRCxcbiAgb25TdGF0ZUNoYW5nZSxcbiAgY29sb3I6IGNvbG9yUHJvcCxcbn06IFByb3BzKSA9PiB7XG4gIGNvbnN0IHsgY3VycmVudDogYmFja2Ryb3AgfSA9IFJlYWN0LnVzZVJlZjxBbmltYXRlZC5WYWx1ZT4oXG4gICAgbmV3IEFuaW1hdGVkLlZhbHVlKDApXG4gICk7XG4gIGNvbnN0IGFuaW1hdGlvbnMgPSBSZWFjdC51c2VSZWY8QW5pbWF0ZWQuVmFsdWVbXT4oXG4gICAgYWN0aW9ucy5tYXAoKCkgPT4gbmV3IEFuaW1hdGVkLlZhbHVlKG9wZW4gPyAxIDogMCkpXG4gICk7XG5cbiAgY29uc3QgW3ByZXZBY3Rpb25zLCBzZXRQcmV2QWN0aW9uc10gPSBSZWFjdC51c2VTdGF0ZTxcbiAgICB8IHtcbiAgICAgICAgaWNvbjogSWNvblNvdXJjZTtcbiAgICAgICAgbGFiZWw/OiBzdHJpbmc7XG4gICAgICAgIGNvbG9yPzogc3RyaW5nO1xuICAgICAgICBhY2Nlc3NpYmlsaXR5TGFiZWw/OiBzdHJpbmc7XG4gICAgICAgIHN0eWxlPzogU3R5bGVQcm9wPFZpZXdTdHlsZT47XG4gICAgICAgIG9uUHJlc3M6ICgpID0+IHZvaWQ7XG4gICAgICAgIHRlc3RJRD86IHN0cmluZztcbiAgICAgIH1bXVxuICAgIHwgbnVsbFxuICA+KG51bGwpO1xuXG4gIGNvbnN0IHsgc2NhbGUgfSA9IHRoZW1lLmFuaW1hdGlvbjtcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChvcGVuKSB7XG4gICAgICBBbmltYXRlZC5wYXJhbGxlbChbXG4gICAgICAgIEFuaW1hdGVkLnRpbWluZyhiYWNrZHJvcCwge1xuICAgICAgICAgIHRvVmFsdWU6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDI1MCAqIHNjYWxlLFxuICAgICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICAgIEFuaW1hdGVkLnN0YWdnZXIoXG4gICAgICAgICAgNTAgKiBzY2FsZSxcbiAgICAgICAgICBhbmltYXRpb25zLmN1cnJlbnRcbiAgICAgICAgICAgIC5tYXAoKGFuaW1hdGlvbikgPT5cbiAgICAgICAgICAgICAgQW5pbWF0ZWQudGltaW5nKGFuaW1hdGlvbiwge1xuICAgICAgICAgICAgICAgIHRvVmFsdWU6IDEsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDE1MCAqIHNjYWxlLFxuICAgICAgICAgICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgKSxcbiAgICAgIF0pLnN0YXJ0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIEFuaW1hdGVkLnBhcmFsbGVsKFtcbiAgICAgICAgQW5pbWF0ZWQudGltaW5nKGJhY2tkcm9wLCB7XG4gICAgICAgICAgdG9WYWx1ZTogMCxcbiAgICAgICAgICBkdXJhdGlvbjogMjAwICogc2NhbGUsXG4gICAgICAgICAgdXNlTmF0aXZlRHJpdmVyOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgLi4uYW5pbWF0aW9ucy5jdXJyZW50Lm1hcCgoYW5pbWF0aW9uKSA9PlxuICAgICAgICAgIEFuaW1hdGVkLnRpbWluZyhhbmltYXRpb24sIHtcbiAgICAgICAgICAgIHRvVmFsdWU6IDAsXG4gICAgICAgICAgICBkdXJhdGlvbjogMTUwICogc2NhbGUsXG4gICAgICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgICAgICAgfSlcbiAgICAgICAgKSxcbiAgICAgIF0pLnN0YXJ0KCk7XG4gICAgfVxuICB9LCBbb3BlbiwgYWN0aW9ucywgYmFja2Ryb3AsIHNjYWxlXSk7XG5cbiAgY29uc3QgY2xvc2UgPSAoKSA9PiBvblN0YXRlQ2hhbmdlKHsgb3BlbjogZmFsc2UgfSk7XG5cbiAgY29uc3QgdG9nZ2xlID0gKCkgPT4gb25TdGF0ZUNoYW5nZSh7IG9wZW46ICFvcGVuIH0pO1xuXG4gIGNvbnN0IHsgY29sb3JzIH0gPSB0aGVtZTtcblxuICBjb25zdCBsYWJlbENvbG9yID0gdGhlbWUuZGFya1xuICAgID8gY29sb3JzLnRleHRcbiAgICA6IGNvbG9yKGNvbG9ycy50ZXh0KS5mYWRlKDAuNTQpLnJnYigpLnN0cmluZygpO1xuICBjb25zdCBiYWNrZHJvcE9wYWNpdHkgPSBvcGVuXG4gICAgPyBiYWNrZHJvcC5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFswLCAwLjUsIDFdLFxuICAgICAgICBvdXRwdXRSYW5nZTogWzAsIDEsIDFdLFxuICAgICAgfSlcbiAgICA6IGJhY2tkcm9wO1xuXG4gIGNvbnN0IG9wYWNpdGllcyA9IGFuaW1hdGlvbnMuY3VycmVudDtcbiAgY29uc3Qgc2NhbGVzID0gb3BhY2l0aWVzLm1hcCgob3BhY2l0eSkgPT5cbiAgICBvcGVuXG4gICAgICA/IG9wYWNpdHkuaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWzAuOCwgMV0sXG4gICAgICAgIH0pXG4gICAgICA6IDFcbiAgKTtcblxuICBpZiAoYWN0aW9ucy5sZW5ndGggIT09IHByZXZBY3Rpb25zPy5sZW5ndGgpIHtcbiAgICBhbmltYXRpb25zLmN1cnJlbnQgPSBhY3Rpb25zLm1hcChcbiAgICAgIChfLCBpKSA9PiBhbmltYXRpb25zLmN1cnJlbnRbaV0gfHwgbmV3IEFuaW1hdGVkLlZhbHVlKG9wZW4gPyAxIDogMClcbiAgICApO1xuICAgIHNldFByZXZBY3Rpb25zKGFjdGlvbnMpO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8VmlldyBwb2ludGVyRXZlbnRzPVwiYm94LW5vbmVcIiBzdHlsZT17W3N0eWxlcy5jb250YWluZXIsIHN0eWxlXX0+XG4gICAgICA8VG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrIG9uUHJlc3M9e2Nsb3NlfT5cbiAgICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgICBwb2ludGVyRXZlbnRzPXtvcGVuID8gJ2F1dG8nIDogJ25vbmUnfVxuICAgICAgICAgIHN0eWxlPXtbXG4gICAgICAgICAgICBzdHlsZXMuYmFja2Ryb3AsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG9wYWNpdHk6IGJhY2tkcm9wT3BhY2l0eSxcbiAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBjb2xvcnMuYmFja2Ryb3AsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF19XG4gICAgICAgIC8+XG4gICAgICA8L1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaz5cbiAgICAgIDxTYWZlQXJlYVZpZXcgcG9pbnRlckV2ZW50cz1cImJveC1ub25lXCIgc3R5bGU9e3N0eWxlcy5zYWZlQXJlYX0+XG4gICAgICAgIDxWaWV3IHBvaW50ZXJFdmVudHM9e29wZW4gPyAnYm94LW5vbmUnIDogJ25vbmUnfT5cbiAgICAgICAgICB7YWN0aW9ucy5tYXAoKGl0LCBpKSA9PiAoXG4gICAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgICBrZXk9e2l9IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVhY3Qvbm8tYXJyYXktaW5kZXgta2V5XG4gICAgICAgICAgICAgIHN0eWxlPXtbXG4gICAgICAgICAgICAgICAgc3R5bGVzLml0ZW0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgbWFyZ2luSG9yaXpvbnRhbDpcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0LnNtYWxsID09PSAndW5kZWZpbmVkJyB8fCBpdC5zbWFsbCA/IDI0IDogMTYsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgICAgcG9pbnRlckV2ZW50cz17b3BlbiA/ICdib3gtbm9uZScgOiAnbm9uZSd9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpdC5sYWJlbCAmJiAoXG4gICAgICAgICAgICAgICAgPFZpZXc+XG4gICAgICAgICAgICAgICAgICA8Q2FyZFxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17XG4gICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVzLmxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IFt7IHNjYWxlOiBzY2FsZXNbaV0gfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IG9wYWNpdGllc1tpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpdC5sYWJlbFN0eWxlLFxuICAgICAgICAgICAgICAgICAgICAgIF0gYXMgU3R5bGVQcm9wPFZpZXdTdHlsZT5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvblByZXNzPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgaXQub25QcmVzcygpO1xuICAgICAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17XG4gICAgICAgICAgICAgICAgICAgICAgaXQuYWNjZXNzaWJpbGl0eUxhYmVsICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgPyBpdC5hY2Nlc3NpYmlsaXR5TGFiZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIDogaXQubGFiZWxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFdlIGtlZXAgb2xkIGExMXkgcHJvcHMgZm9yIGJhY2t3YXJkcyBjb21wYXQgd2l0aCBvbGQgUk4gdmVyc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVRyYWl0cz1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVJvbGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VGV4dCBzdHlsZT17eyBjb2xvcjogaXQubGFiZWxUZXh0Q29sb3IgPz8gbGFiZWxDb2xvciB9fT5cbiAgICAgICAgICAgICAgICAgICAgICB7aXQubGFiZWx9XG4gICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgIDwvQ2FyZD5cbiAgICAgICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxGQUJcbiAgICAgICAgICAgICAgICBzbWFsbD17dHlwZW9mIGl0LnNtYWxsICE9PSAndW5kZWZpbmVkJyA/IGl0LnNtYWxsIDogdHJ1ZX1cbiAgICAgICAgICAgICAgICBpY29uPXtpdC5pY29ufVxuICAgICAgICAgICAgICAgIGNvbG9yPXtpdC5jb2xvcn1cbiAgICAgICAgICAgICAgICBzdHlsZT17XG4gICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IFt7IHNjYWxlOiBzY2FsZXNbaV0gfV0sXG4gICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogb3BhY2l0aWVzW2ldLFxuICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUuY29sb3JzLnN1cmZhY2UsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGl0LnN0eWxlLFxuICAgICAgICAgICAgICAgICAgXSBhcyBTdHlsZVByb3A8Vmlld1N0eWxlPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvblByZXNzPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICBpdC5vblByZXNzKCk7XG4gICAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXtcbiAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdC5hY2Nlc3NpYmlsaXR5TGFiZWwgIT09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICAgICAgICAgID8gaXQuYWNjZXNzaWJpbGl0eUxhYmVsXG4gICAgICAgICAgICAgICAgICAgIDogaXQubGFiZWxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBXZSBrZWVwIG9sZCBhMTF5IHByb3BzIGZvciBiYWNrd2FyZHMgY29tcGF0IHdpdGggb2xkIFJOIHZlcnNpb25zXG4gICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVRyYWl0cz1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICB0ZXN0SUQ9e2l0LnRlc3RJRH1cbiAgICAgICAgICAgICAgICB2aXNpYmxlPXtvcGVufVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgICkpfVxuICAgICAgICA8L1ZpZXc+XG4gICAgICAgIDxGQUJcbiAgICAgICAgICBvblByZXNzPXsoKSA9PiB7XG4gICAgICAgICAgICBvblByZXNzPy4oKTtcbiAgICAgICAgICAgIHRvZ2dsZSgpO1xuICAgICAgICAgIH19XG4gICAgICAgICAgaWNvbj17aWNvbn1cbiAgICAgICAgICBjb2xvcj17Y29sb3JQcm9wfVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17YWNjZXNzaWJpbGl0eUxhYmVsfVxuICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgV2Uga2VlcCBvbGQgYTExeSBwcm9wcyBmb3IgYmFja3dhcmRzIGNvbXBhdCB3aXRoIG9sZCBSTiB2ZXJzaW9uc1xuICAgICAgICAgIGFjY2Vzc2liaWxpdHlUcmFpdHM9XCJidXR0b25cIlxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgYWNjZXNzaWJpbGl0eVN0YXRlPXt7IGV4cGFuZGVkOiBvcGVuIH19XG4gICAgICAgICAgc3R5bGU9e1tzdHlsZXMuZmFiLCBmYWJTdHlsZV19XG4gICAgICAgICAgdmlzaWJsZT17dmlzaWJsZX1cbiAgICAgICAgICB0ZXN0SUQ9e3Rlc3RJRH1cbiAgICAgICAgLz5cbiAgICAgIDwvU2FmZUFyZWFWaWV3PlxuICAgIDwvVmlldz5cbiAgKTtcbn07XG5cbkZBQkdyb3VwLmRpc3BsYXlOYW1lID0gJ0ZBQi5Hcm91cCc7XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhUaGVtZShGQUJHcm91cCk7XG5cbi8vIEBjb21wb25lbnQtZG9jcyBpZ25vcmUtbmV4dC1saW5lXG5jb25zdCBGQUJHcm91cFdpdGhUaGVtZSA9IHdpdGhUaGVtZShGQUJHcm91cCk7XG4vLyBAY29tcG9uZW50LWRvY3MgaWdub3JlLW5leHQtbGluZVxuZXhwb3J0IHsgRkFCR3JvdXBXaXRoVGhlbWUgYXMgRkFCR3JvdXAgfTtcblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBzYWZlQXJlYToge1xuICAgIGFsaWduSXRlbXM6ICdmbGV4LWVuZCcsXG4gIH0sXG4gIGNvbnRhaW5lcjoge1xuICAgIC4uLlN0eWxlU2hlZXQuYWJzb2x1dGVGaWxsT2JqZWN0LFxuICAgIGp1c3RpZnlDb250ZW50OiAnZmxleC1lbmQnLFxuICB9LFxuICBmYWI6IHtcbiAgICBtYXJnaW5Ib3Jpem9udGFsOiAxNixcbiAgICBtYXJnaW5Cb3R0b206IDE2LFxuICAgIG1hcmdpblRvcDogMCxcbiAgfSxcbiAgYmFja2Ryb3A6IHtcbiAgICAuLi5TdHlsZVNoZWV0LmFic29sdXRlRmlsbE9iamVjdCxcbiAgfSxcbiAgbGFiZWw6IHtcbiAgICBib3JkZXJSYWRpdXM6IDUsXG4gICAgcGFkZGluZ0hvcml6b250YWw6IDEyLFxuICAgIHBhZGRpbmdWZXJ0aWNhbDogNixcbiAgICBtYXJnaW5WZXJ0aWNhbDogOCxcbiAgICBtYXJnaW5Ib3Jpem9udGFsOiAxNixcbiAgICBlbGV2YXRpb246IDIsXG4gIH0sXG4gIGl0ZW06IHtcbiAgICBtYXJnaW5Cb3R0b206IDE2LFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGp1c3RpZnlDb250ZW50OiAnZmxleC1lbmQnLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICB9LFxufSk7XG4iXX0=