285118597680a126076c19ea241a6e4b
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _excluded = ["state"];
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CHILD_STATE = void 0;
exports.default = useRouteCache;

var React = _interopRequireWildcard(require("react"));

function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}

function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache(nodeInterop);

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

var CHILD_STATE = Symbol('CHILD_STATE');
exports.CHILD_STATE = CHILD_STATE;

function useRouteCache(routes) {
  var cache = React.useMemo(function () {
    return {
      current: new Map()
    };
  }, []);

  if (process.env.NODE_ENV === 'production') {
    return routes;
  }

  cache.current = routes.reduce(function (acc, route) {
    var previous = cache.current.get(route);

    if (previous) {
      acc.set(route, previous);
    } else {
      var state = route.state,
          proxy = (0, _objectWithoutProperties2.default)(route, _excluded);
      Object.defineProperty(proxy, CHILD_STATE, {
        enumerable: false,
        value: state
      });
      acc.set(route, proxy);
    }

    return acc;
  }, new Map());
  return Array.from(cache.current.values());
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUtBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBV08sSUFBTUEsV0FBVyxHQUFHQyxNQUFNLENBQUMsYUFBRCxDQUExQjs7O0FBTVEsU0FBU0MsYUFBVCxDQUNiQyxNQURhLEVBRWI7QUFFQSxNQUFNQyxLQUFLLEdBQUdDLEtBQUssQ0FBQ0MsT0FBTkQsQ0FBYztBQUFBLFdBQU87QUFBRUUsYUFBTyxFQUFFLElBQUlDLEdBQUo7QUFBWCxLQUFQO0FBQUEsR0FBZEgsRUFBNEQsRUFBNURBLENBQWQ7O0FBRUEsTUFBSUksT0FBTyxDQUFDQyxHQUFSRCxDQUFZRSxRQUFaRixLQUF5QixZQUE3QixFQUEyQztBQUV6QyxXQUFPTixNQUFQO0FBQ0Q7O0FBRURDLE9BQUssQ0FBQ0csT0FBTkgsR0FBZ0JELE1BQU0sQ0FBQ1MsTUFBUFQsQ0FBYyxVQUFDVSxHQUFELEVBQU1DLEtBQU4sRUFBZ0I7QUFDNUMsUUFBTUMsUUFBUSxHQUFHWCxLQUFLLENBQUNHLE9BQU5ILENBQWNZLEdBQWRaLENBQWtCVSxLQUFsQlYsQ0FBakI7O0FBRUEsUUFBSVcsUUFBSixFQUFjO0FBRVpGLFNBQUcsQ0FBQ0ksR0FBSkosQ0FBUUMsS0FBUkQsRUFBZUUsUUFBZkY7QUFGRixXQUdPO0FBQ0wsVUFBUUssS0FBUixHQUE0QkosS0FBNUIsQ0FBUUksS0FBUjtBQUFBLFVBQWtCQyxLQUFsQiwwQ0FBNEJMLEtBQTVCO0FBRUFNLFlBQU0sQ0FBQ0MsY0FBUEQsQ0FBc0JELEtBQXRCQyxFQUE2QnBCLFdBQTdCb0IsRUFBMEM7QUFDeENFLGtCQUFVLEVBQUUsS0FENEI7QUFFeENDLGFBQUssRUFBRUw7QUFGaUMsT0FBMUNFO0FBS0FQLFNBQUcsQ0FBQ0ksR0FBSkosQ0FBUUMsS0FBUkQsRUFBZU0sS0FBZk47QUFDRDs7QUFFRCxXQUFPQSxHQUFQO0FBakJjLEtBa0JiLElBQUlMLEdBQUosRUFsQmFMLENBQWhCQztBQW9CQSxTQUFPb0IsS0FBSyxDQUFDQyxJQUFORCxDQUFXcEIsS0FBSyxDQUFDRyxPQUFOSCxDQUFjc0IsTUFBZHRCLEVBQVhvQixDQUFQO0FBQ0QiLCJuYW1lcyI6WyJDSElMRF9TVEFURSIsIlN5bWJvbCIsInVzZVJvdXRlQ2FjaGUiLCJyb3V0ZXMiLCJjYWNoZSIsIlJlYWN0IiwidXNlTWVtbyIsImN1cnJlbnQiLCJNYXAiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJyZWR1Y2UiLCJhY2MiLCJyb3V0ZSIsInByZXZpb3VzIiwiZ2V0Iiwic2V0Iiwic3RhdGUiLCJwcm94eSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsInZhbHVlIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIl0sInNvdXJjZXMiOlsidXNlUm91dGVDYWNoZS50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge1xuICBOYXZpZ2F0aW9uU3RhdGUsXG4gIFBhcmFtTGlzdEJhc2UsXG4gIFJvdXRlLFxufSBmcm9tICdAcmVhY3QtbmF2aWdhdGlvbi9yb3V0ZXJzJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHR5cGUgeyBSb3V0ZVByb3AgfSBmcm9tICcuL3R5cGVzJztcblxudHlwZSBSb3V0ZUNhY2hlID0gTWFwPFJvdXRlPHN0cmluZz4sIFJvdXRlUHJvcDxQYXJhbUxpc3RCYXNlPj47XG5cbi8qKlxuICogVXRpbGl0ZXMgc3VjaCBhcyBgZ2V0Rm9jdXNlZFJvdXRlTmFtZUZyb21Sb3V0ZWAgbmVlZCB0byBhY2Nlc3Mgc3RhdGUuXG4gKiBTbyB3ZSBuZWVkIGEgd2F5IHRvIHN1cHByZXNzIHRoZSB3YXJuaW5nIGZvciB0aG9zZSB1c2UgY2FzZXMuXG4gKiBUaGlzIGlzIGZpbmUgc2luY2UgdGhleSBhcmUgaW50ZXJuYWwgdXRpbGl0aWVzIGFuZCB0aGlzIGlzIG5vdCBwdWJsaWMgQVBJLlxuICovXG5leHBvcnQgY29uc3QgQ0hJTERfU1RBVEUgPSBTeW1ib2woJ0NISUxEX1NUQVRFJyk7XG5cbi8qKlxuICogSG9vayB0byBjYWNoZSByb3V0ZSBwcm9wcyBmb3IgZWFjaCBzY3JlZW4gaW4gdGhlIG5hdmlnYXRvci5cbiAqIFRoaXMgbGV0cyBhZGQgd2FybmluZ3MgYW5kIG1vZGlmaWNhdGlvbnMgdG8gdGhlIHJvdXRlIG9iamVjdCBidXQga2VlcCByZWZlcmVuY2VzIGJldHdlZW4gcmVuZGVycy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlUm91dGVDYWNoZTxTdGF0ZSBleHRlbmRzIE5hdmlnYXRpb25TdGF0ZT4oXG4gIHJvdXRlczogU3RhdGVbJ3JvdXRlcyddXG4pIHtcbiAgLy8gQ2FjaGUgb2JqZWN0IHdoaWNoIGhvbGRzIHJvdXRlIG9iamVjdHMgZm9yIGVhY2ggc2NyZWVuXG4gIGNvbnN0IGNhY2hlID0gUmVhY3QudXNlTWVtbygoKSA9PiAoeyBjdXJyZW50OiBuZXcgTWFwKCkgYXMgUm91dGVDYWNoZSB9KSwgW10pO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgLy8gV2UgZG9uJ3Qgd2FudCB0aGUgb3ZlcmhlYWQgb2YgY3JlYXRpbmcgZXh0cmEgbWFwcyBldmVyeSByZW5kZXIgaW4gcHJvZFxuICAgIHJldHVybiByb3V0ZXM7XG4gIH1cblxuICBjYWNoZS5jdXJyZW50ID0gcm91dGVzLnJlZHVjZSgoYWNjLCByb3V0ZSkgPT4ge1xuICAgIGNvbnN0IHByZXZpb3VzID0gY2FjaGUuY3VycmVudC5nZXQocm91dGUpO1xuXG4gICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAvLyBJZiBhIGNhY2hlZCByb3V0ZSBvYmplY3QgYWxyZWFkeSBleGlzdHMsIHJldXNlIGl0XG4gICAgICBhY2Muc2V0KHJvdXRlLCBwcmV2aW91cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgc3RhdGUsIC4uLnByb3h5IH0gPSByb3V0ZTtcblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3h5LCBDSElMRF9TVEFURSwge1xuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IHN0YXRlLFxuICAgICAgfSk7XG5cbiAgICAgIGFjYy5zZXQocm91dGUsIHByb3h5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWNjO1xuICB9LCBuZXcgTWFwKCkgYXMgUm91dGVDYWNoZSk7XG5cbiAgcmV0dXJuIEFycmF5LmZyb20oY2FjaGUuY3VycmVudC52YWx1ZXMoKSk7XG59XG4iXX0=